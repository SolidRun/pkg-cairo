commit 11aaf992fb5d3d86f261ba48306adfaace9f96ea
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Dec 5 01:52:03 2007 -0800

    NEWS: Add notes for 1.5.4

 NEWS |   57 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 57 insertions(+), 0 deletions(-)

commit 150564c7f8792fa2217fc2574e9e1925c9cd500f
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Dec 4 14:05:47 2007 -0800

    [quartz] use rectangle_int_t, not rectangle_int16_t

 src/cairo-quartz-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit e8574022f949559c069da30f11dee8680fc59586
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Dec 4 13:54:32 2007 -0800

    [quartz] cleanup: remove trailing whitespace

 src/cairo-quartz-surface.c |   22 +++++++++++-----------
 1 files changed, 11 insertions(+), 11 deletions(-)

commit ee01a94726b3c0782fa182c9e874b2ed57e71aca
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Dec 4 13:53:03 2007 -0800

    [quartz] Use CGContextDrawTiledImage if available
    
    Use this 10.5-only method if available, as it greatly speeds up
    tiled image rendering (EXTEND_REPEAT).

 src/cairo-quartz-surface.c |   96 +++++++++++++++++++++++++++++---------------
 1 files changed, 64 insertions(+), 32 deletions(-)

commit 2c25033e14d7d9f705c27683dfb093318d67910b
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Dec 4 13:49:59 2007 -0800

    [quartz] Handle creating 0x0 surfaces
    
    Make all 0x0 surfaces be no-ops when used in a rendering operation.

 src/cairo-quartz-surface.c |  109 ++++++++++++++++++++++++++++++++++---------
 test/.gitignore            |    1 +
 test/Makefile.am           |    1 +
 test/clip-zero.c           |   80 ++++++++++++++++++++++++++++++++
 4 files changed, 168 insertions(+), 23 deletions(-)

commit 407ed0a6e7183c4fc6da1e988fada19c82ccef8a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Dec 3 09:59:52 2007 +0000

    [Makefile.am] Add lcov-clean to distclean.
    
    Clean the gcov temporary files when doing a full clean - spotted in a
    patch by Patrick Hulin to adapt cairo's lcov targets to glib.

 Makefile.am |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 9c732594039b164a1e08125c35ec9d04278f0cbf
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Dec 2 17:55:35 2007 +0000

    [Makefile.am] Wrap lcov make targets within an AM_CONDITIONAL.
    
    Hide 'make lcov' and friends unless the user has actually enabled lcov
    supported during configure.

 Makefile.am  |   17 ++++++++++++-----
 configure.in |    4 ++++
 2 files changed, 16 insertions(+), 5 deletions(-)

commit 5f38e215ed4ec930492ee373db37a767d85a6ee8
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Dec 1 22:44:54 2007 -0500

    [README] Remove the Dependencies section as it falls out of date easily

 README |   89 ----------------------------------------------------------------
 1 files changed, 0 insertions(+), 89 deletions(-)

commit b46bb58e11f9d7b7fa68a64ca887c9b996b8f6f2
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Dec 1 20:41:55 2007 -0500

    [configure.in] Bump freetype required version to 2.1.9 (#13482)

 configure.in |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit b701b4263048c3641f77796b9ea7bdc60b9815f7
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Dec 2 01:36:43 2007 +1030

    win32: Implement _cairo_win32_scaled_font_init_glyph_surface()
    
    This is required when using win32 bitmap fonts with PS/PDF surfaces.

 src/cairo-win32-font.c |   63 ++++++++++++++++++++++++++++++++++++++++++++++-
 1 files changed, 61 insertions(+), 2 deletions(-)

commit 1441e165f2338bc6a8e2945baca77611ff417b2f
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Dec 2 00:50:28 2007 +1030

    Fix regression in Type1 Fallback
    
    As a result of the changes to improve the status checking,
    _cairo_type2_charstrings_init() was failing due to the failure
    status returned when the font->output stream is destroyed.
    This is because _cairo_type2_charstrings_init() does not
    create an output stream.
    
    Fix this by initializing font->output to NULL and only
    destroy it if not NULL.

 src/cairo-type1-fallback.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit e6166f7b442ae55128b417559e48250c287e49b6
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Dec 1 04:19:39 2007 -0500

    Convert bash scripts to regular sh ones for greater portability

 perf/cairo-perf-diff |   31 ++++++++++++++++---------------
 src/check-def.sh     |   12 ++++++------
 src/check-plt.sh     |    6 +++---
 3 files changed, 25 insertions(+), 24 deletions(-)

commit 0d932f43fe17b2b65d9e52ff8f9c16122b525223
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Nov 30 16:19:45 2007 -0800

    Explicitly call bash for bash-specific scripts
    
    Thanks to Solaris-using Brian Cameron for pointing out that our
    shell scripts are bash-specific. We'd be glad if someone cared to
    rewrite them to not require bash, but for now let's have truth in
    advertising at least.

 perf/cairo-perf-diff |    2 +-
 src/check-def.sh     |    2 +-
 src/check-plt.sh     |    2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit f4b93cceb7fb83de558ed058915f92d4f75c1a6a
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Nov 29 23:18:45 2007 +1030

    PS: Use correct glyphs widths for Type 3 fonts
    
    Previously the widths were set to 0.

 src/cairo-ps-surface.c |    8 +++++++-
 1 files changed, 7 insertions(+), 1 deletions(-)

commit 2729af6c123983c1599fae9f7a0fac88ad320d7c
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Nov 29 23:07:47 2007 +1030

    PS: Fix the Type 3 FontBBox
    
    This was previously a fixed size. Make it [0 0 0 0] the same as the
    other fonts.

 src/cairo-ps-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 77aab8fdbb62e4e0ec0260651db7255d168cb25e
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Nov 29 23:03:40 2007 +1030

    PS: Don't emit an image for Type 3 .notdef glyph
    
    Make the .notdef procedure an empty procedure instead
    of creating an empty image mask. This reduced the size
    of the PS file.

 src/cairo-ps-surface.c |   18 ++++++++++--------
 1 files changed, 10 insertions(+), 8 deletions(-)

commit 78e8d3d9bd2d4652f636a668a3fa53ef9edfd9ae
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Nov 29 22:54:54 2007 +1030

    PS: Fix the bounding boxes of Type 3 glyphs
    
    When viewing with ghostscript the glyphs were clipped

 src/cairo-ps-surface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 97b0d8b3c376f7848514debbe0697a2159a26eb9
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Nov 29 22:36:07 2007 +1030

    PS: Make Type 3 fonts text selectable
    
    Put the glyph names in the Encoding array the same as is done for
    Type 1 and Type42 fonts.
    
    Acroread and Evince are still unable to correctly extract the text
    after conversion with ps2pdf. However examining the pdf file shows
    the glyph names are correct so this is probably a limitation of
    Acroread and Evince.

 src/cairo-ps-surface.c |   46 ++++++++++++++++++++++++++++++----------------
 1 files changed, 30 insertions(+), 16 deletions(-)

commit 5e8f60531a09f357db38c4b646b1bbd29b97a891
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Nov 29 09:20:01 2007 +1030

    PS: Ensure that xyshow operator has a pair of offsets for each glyph
    
    The last entry should have been "0 0" instead of "0".

 src/cairo-ps-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit ba239a474a5cab36098b8f4a98f36aa6281f7da9
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Nov 18 20:30:49 2007 +0000

    [quartz] zero memory on bitmap creation
    
    7 quartz/argb32/similar tests were showing failures due to
    random bits being set. The problem turned out to be that the
    initial test surface was not cleared before the similar surface
    was created by push_group. The problem behaviour is more obvious
    if you run the tests with MallocScribble=1.
    
    Fix this by calling memset after bitmap allocation; the multiplication
    here cannot overflow since we already checked that in malloc_ab.

 src/cairo-quartz-surface.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 58e828a9a31b91c80336fc4ce323b061226dde2b
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Jul 1 16:11:07 2007 +0100

    [quartz] fill with alpha for EXTEND_NONE
    
    The implementation of EXTEND_NONE was not filling areas outside
    the image with rgba(0,0,0,0). This showed up on the operator-source
    test, the fix makes the quartz and image renderings identical.

 src/cairo-quartz-surface.c |   22 ++++++++++++++++++++++
 1 files changed, 22 insertions(+), 0 deletions(-)

commit 39b8ddf07994747c039ee74c64a0cc97a4c7776a
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Thu Nov 15 11:57:40 2007 -0800

    [win32] Remove double-free in win32 font code in init_glyph_path
    
    Fixes bug #13243.

 src/cairo-win32-font.c |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit 50d5f5a4e6d7424694b0b27fc0c3a00c9eb203bb
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Thu Nov 15 11:56:56 2007 -0800

    [quartz] Fix gradients; the wrong color field was being used
    
    The wrong color field was being used, effectively making gradients always
    have transparent black as their color stops.

 src/cairo-quartz-surface.c |   24 ++++++++++++------------
 1 files changed, 12 insertions(+), 12 deletions(-)

commit bcb0f57e5eca58480e24251777f0b967e1aadefe
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Wed Nov 14 01:50:34 2007 +0000

    [quartz] remove double malloc in dashing code.
    
    fdash is reallocated without being released, and is
    allocated at the wrong size too.

 src/cairo-quartz-surface.c |    5 +----
 1 files changed, 1 insertions(+), 4 deletions(-)

commit e6bc049465730a9640a1038104210d14aad4b3cb
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Tue Nov 13 00:43:59 2007 +0000

    [quartz] typo checking for malloc failure
    
    The check after the malloc of cg_advances looked at the wrong
    variable.

 src/cairo-quartz-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit bb2674207cf01386c6338511d2462694187fff36
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Nov 12 23:56:01 2007 +0000

    [quartz] fix leak in show_glyphs
    
    In cairo_quartz_show_glyphs we may leak the source if
    there is a failure to malloc the glyph arrays. Fix this.

 src/cairo-quartz-surface.c |   30 ++++++++++++++++++------------
 1 files changed, 18 insertions(+), 12 deletions(-)

commit 7ad34c1bdc6417ca0e2e1075b67ca09c5318db75
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Nov 12 23:52:52 2007 +0000

    [quartz] fix for cairo_reset_clip()

 src/cairo-quartz-surface.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 717ccbcf0c12fcfa840396378812919c9e151d57
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Nov 12 23:51:39 2007 +0000

    Revert "[quartz] handle 0x0 surfaces."
    
    This reverts commit 2fd50a7897efaed4dabaf75a6ed8828f16c14d36.
    Spoke too soon, quartz doesn't like creating those 0x0
    images; while the tests pass, its putting warnings in the logs.
    Reverting to make a better fix.

 src/cairo-quartz-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 2fd50a7897efaed4dabaf75a6ed8828f16c14d36
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Nov 11 01:29:00 2007 +0000

    [quartz] handle 0x0 surfaces.
    
    Some tests, like invalid-matrix, generate a 0x0 bitmap; in
    the quartz backend this caused a nil surface to be returned,
    whereas the tests expect a quartz surface. Other surfaces
    return a backend-specific surface with a zero-sized bitmap,
    quartz should do the same.
    
    Fixes the tests ft-font-create-for-ft-face, get-and-set,
    get-clip, invalid-matrix, line-width-zero,
    select-font-no-show-text, solid-pattern-cache-stress,
    surface-finish-twice, and text-cache-crash.

 src/cairo-quartz-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 0359ad6c8da56a44697498bd8b74fbc029cbe930
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sun Nov 11 00:18:19 2007 +0100

    Compilation warning suppression (char as array subscript).
    
    cairo_path_op_t is a char, and can't be directly used as array subscript.

 src/cairo-path-fixed.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 1b71af7e61bd6c55b78e1a9a4c56b93d0b1134ed
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sun Nov 11 00:14:34 2007 +0100

    Fix _cairo_path_fixed_init_copy.
    
    All the copied data buffers except the first one weren't completely
    initialized (num_ops and num_points). That was the cause of the failure
    of some vector surface tests, like random-intersections.

 src/cairo-path-fixed.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 3554c31e3d28ad5aad35c8fe4c6bb8ce7d297dde
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sat Nov 10 10:43:43 2007 +0100

    [SVG] Add missing image to REFERENCE_IMAGES list.

 test/Makefile.am |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 916d82586ec196bfb3124850e68ef66a63464e72
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sat Nov 10 10:24:21 2007 +0100

    [SVG] Indentation fixes.

 src/cairo-svg-surface.c |  130 +++++++++++++++++++++++-----------------------
 1 files changed, 65 insertions(+), 65 deletions(-)

commit 8edc3ed4857795387007e7c4997f30d7ceec57ac
Merge: 3bc8a8d... 77e9b05...
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sat Nov 10 10:10:50 2007 +0100

    Merge branch 'master' of git+ssh://emmanuel@git.cairographics.org/git/cairo

commit 3bc8a8d1d0e07e857b203a7872862437b8333b25
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sat Nov 10 10:10:03 2007 +0100

    [SVG] Remove spurious semicolon when emitting mask url.

 src/cairo-svg-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit b68968ffd1864d591e4fc08fed55c12ece95ec55
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sat Nov 10 10:07:12 2007 +0100

    [SVG] Fix opacity of combined stroke and fill.
    
    When emitting combined stroke and fill, cairo SVG backend was using the opacity
    two times, instead of using fill-opacity and stroke-opacity, leading to
    incorrect output.
    
    I've updated the mask test reference images for the SVG output, since it seems
    there's a bug in librsvg when fill-opacity is used in the mask image.
    I've checked the SVG output with batik, and it looks fine.

 src/cairo-svg-surface.c      |   27 ++++++++++++++-------------
 test/mask-svg-argb32-ref.png |  Bin 8405 -> 8389 bytes
 test/mask-svg-rgb24-ref.png  |  Bin 0 -> 7935 bytes
 3 files changed, 14 insertions(+), 13 deletions(-)

commit 77e9b05b2b011ce964287ff493c2b421977107ee
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Nov 10 01:34:03 2007 +0000

    [test] support using a previous build as a reference
    
    Allow using a previous test output directory as a source of
    reference images. To make use of this, set the environment
    variable 'CAIRO_REF_DIR' to point at an old test directory,
    relative to the current test directory.
    
    This is useful for testing backends when reference images haven't
    been created yet, or which the current reference image structure
    can't accomodate, like multiple font backends.

 test/README       |    8 ++++++++
 test/cairo-test.c |   17 ++++++++++++++++-
 2 files changed, 24 insertions(+), 1 deletions(-)

commit f8ee0cdf186bfb30bdeb487b63d42f274c1073ce
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Nov 10 01:34:01 2007 +0000

    [test] Link to the correct reference image.
    
    The generated test html guesses the names of the reference
    images used in the tests. This is quite often wrong, and
    makes it harder to change policy in cairo-test. Teach
    make-html.pl to parse the log for the path to the reference image.

 test/make-html.pl |  102 +++++++++++++++++++++++-----------------------------
 1 files changed, 45 insertions(+), 57 deletions(-)

commit 15fc1bbefb49fefedca53c47ccfc7edace0acbfe
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Nov 10 01:33:47 2007 +0000

    [test] log tested paths so that they can be parsed.
    
    The test logs currently do not record the paths of
    image output, the reference images tested against, and
    the diffs created. This means that make-html.pl has to
    duplicate the policy in cairo-test.c. Fix this by teaching
    cairo-test.c to log the paths.

 test/cairo-test.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 28412f780ebf52914aa374bb2bdd3d539bd29241
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Nov 6 16:11:06 2007 -0800

    [win32-printing] bail out early if we don't have anything to do in paint_surf

 src/cairo-win32-printing-surface.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

commit d72bb8c12efcffe7c576afe63212b2fe47e8154c
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Nov 6 16:08:59 2007 -0800

    [win32] Fix FIXED_to_fixed when cairo's fixed format isn't 16.16

 src/cairo-win32-font.c |   10 ++++------
 1 files changed, 4 insertions(+), 6 deletions(-)

commit 0901b83ca56e197d5c96d71ab8cfe53f21b4c8bb
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Nov 6 15:49:57 2007 -0800

    [win32] Don't use GetGlyphOutline on non-TrueType fonts
    
    win32-glyph-metrics.patch: GetGlyphOutline only works on Truetype fonts,
    so for non-Truetype fonts, assume no left or right bearing and use the
    font ascent and descent for the glyph extents.

 src/cairo-win32-font.c |   44 +++++++++++++++++++++++++++++++-------------
 1 files changed, 31 insertions(+), 13 deletions(-)

commit f11f7524b62df29aa377382f5ceeda8c3beb2d54
Author: Vladimir Vukicevic <vladimir@h-232.office.mozilla.org>
Date:   Tue Nov 6 15:40:30 2007 -0800

    [quartz] work around Quartz bugs with images bigger than a certain size
    
    Quartz has a bug with images greater than (signed) 16 bits in height; avoid
    creating or working with those.  Also fixes some memory leaks.
    
    Patch from John Daggett.

 src/cairo-quartz-surface.c |   61 ++++++++++++++++++++++++++++++++++++++++++-
 1 files changed, 59 insertions(+), 2 deletions(-)

commit 95ede9ea59eb1e2d7fe10fbc698f3f9fff192e79
Author: Vladimir Vukicevic <vladimir@h-232.office.mozilla.org>
Date:   Tue Nov 6 15:06:06 2007 -0800

    Use correct surface resolution when creating paginated fallback image
    
    If a surface resolution is set via _cairo_surface_set_resolution, it
    needs to be used when the fallback image is created.  The user sets
    the fallback resolution on the paginated surface, so we need
    to divide that by the resolution of the actual (target) surface, not
    the paginated surface.

 src/cairo-paginated-surface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 9b8d9f2859ce66b742c887eb673407a84095f488
Author: Vladimir Vukicevic <vladimir@h-232.office.mozilla.org>
Date:   Tue Nov 6 14:54:59 2007 -0800

    [win32] Skip doing some work if we can't call StretchDIBits

 src/cairo-win32-printing-surface.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit fa7e36669ae24fdbb5bd89a9fc1b6906408a5823
Author: Vladimir Vukicevic <vladimir@h-232.office.mozilla.org>
Date:   Tue Nov 6 14:53:09 2007 -0800

    [quartz] Fix for 10.5 SDK; the FloatToFixed macro started doing strange things

 src/cairo-quartz-surface.c |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

commit 236c52b095661be395021d511d2dca0b532f83e9
Author: Vladimir Vukicevic <vladimir@h-232.office.mozilla.org>
Date:   Tue Nov 6 14:52:24 2007 -0800

    Handle overflow/underflow gracefully when converting to 16.16 fixed

 src/cairo-fixed-private.h |   22 +++++++++++++++++++---
 1 files changed, 19 insertions(+), 3 deletions(-)

commit 5b0a0fe7a230f99a43916a16bfd2d26882bad46b
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Nov 7 11:17:59 2007 -0800

    Mention cairo_new_sub_path in documentation of cairo_arc

 src/cairo.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit 62d64e12aa9264a17c9bb7d6ae154a1778f0c7e1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Nov 6 14:24:52 2007 +0000

    [cairo-pdf-surface] Create a new path for an empty clip.
    
    If the clip path is empty, then we need to start a new path otherwise
    the clip is ineffective.

 src/cairo-pdf-surface.c |   36 ++++++++++++++++++++++--------------
 1 files changed, 22 insertions(+), 14 deletions(-)

commit b4057b8643cf02439b6033d7443d0d4c42220a62
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Nov 6 09:45:54 2007 +0000

    [cairo-clip] Special case using an empty clip path.
    
    Detect when the user calls cairo_clip() with an empty clip path and
    mark the clip as all_clipped.

 src/cairo-clip.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit 2f0867b43fbc9a385a32a2a39895f4c3559f6ddf
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Nov 6 09:44:03 2007 +0000

    [cairo-surface] Handle the all clipped out case.
    
    Explicitly handle a clip which represents that the entire surface is
    clipped out.
    
    Fixes https://bugs.freedesktop.org/show_bug.cgi?id=13084.

 src/cairo-surface.c |   61 +++++++++++++++++++++++++++++++++++++++++++-------
 1 files changed, 52 insertions(+), 9 deletions(-)

commit 641215b2b018e98b298db5042360e2e22ab5a0aa
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Nov 5 22:22:42 2007 +0000

    [test/clip-all] Combine text and everything clipped out.
    
    https://bugs.freedesktop.org/show_bug.cgi?id=13084 demonstrates a
    regression where the clip is ignored by the xlib backend whilst
    rendering text. Therefore we extend the current test cases to combine
    a clip that represents everything clipped out with the rendering of
    text. For completeness, we add a new test case that exactly mimics the
    sequence of cairo operations that lead to the discovery of this bug -
    namely the rendering of text with an empty clip path.

 test/Makefile.am        |    2 +
 test/clip-all.c         |   10 ++++++
 test/clip-empty-ref.png |  Bin 0 -> 118 bytes
 test/clip-empty.c       |   72 +++++++++++++++++++++++++++++++++++++++++++++++
 4 files changed, 84 insertions(+), 0 deletions(-)

commit 55b530ffef2bce96d57919563c6c9b58f02f8fb8
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Nov 5 14:47:27 2007 -0500

    [PS] Fix compiler warnings

 src/cairo-ps-surface.c |   14 +++++++-------
 1 files changed, 7 insertions(+), 7 deletions(-)

commit 570714b2b4e0b7aea58142bcba37a9eb7945cf09
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Aug 14 21:34:40 2006 -0400

    [test/fallback-resolution] set tolerance to a large value to see how it performs
    in different fallback resolutions.

 test/fallback-resolution.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 5acbef20213ad354cc835f6d15811e333ee38e74
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Aug 14 21:34:03 2006 -0400

    [test] fallback-resolution: center text

 test/fallback-resolution.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit 7f21bfb0a8265095d68bb5ff6afae7553683a776
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Aug 14 21:33:13 2006 -0400

    [meta-surface] Adjust tolerance when replaying to surfaces with device scale
    
    such that we get a consistent look with different fallback resolutions.

 src/cairo-meta-surface.c |   11 ++++++-----
 1 files changed, 6 insertions(+), 5 deletions(-)

commit 4270cd3358fabf0d3e6ac4e866099b172082b592
Author: Richard Hult <richard@imendio.com>
Date:   Mon Nov 5 10:05:07 2007 +0000

    [atsui] Use ascent+descent+leading to get the distance between baselines
    
    The height is currently mapped to the atsui metrics property capHeight, which
    is documented as "The height of a capital letter in the font from the baseline
    to the top of the letter".
    
    That doesn't match what height is in cairo, it should be the disctance between
    baselines. This patch that fixes that (and makes webkit on GTK+ OS X
    layout nicely).

 src/cairo-atsui-font.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 3141b21c0c581dabc09a6ec9cdf0a071701b0e42
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Nov 5 10:05:04 2007 +0000

    [configure.in] fix atsui experimental warning
    
    The 'experimental' warning for atsui was appearing
    for --enable-quartz not --enable-atsui as it should.

 configure.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit b3ef306f84944a45b389c1f4bfeae910baf5bcb0
Author: Chris Wilson <ickle@cube.localdomain>
Date:   Mon Nov 5 09:09:14 2007 +0000

    [cairo-atomic] Add a few more cpus that are known to have atomic access.
    
    Add x86_64 and arm to the list of cpus which do not require memory
    barriers for reading and writing integers/pointers atomically.

 configure.in |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit bd5ed9a3988910a41748b7d78a265a2968a48f23
Author: Chris Wilson <ickle@cube.localdomain>
Date:   Mon Nov 5 09:05:25 2007 +0000

    [cairo-atomic] Declare the mutex for NEEDS_MEMORY_BARRIER.
    
    Whilst NEED_MEMORY_BARRIER should be a subset of ! HAS_ATOMIC_OPS,
    until we have accurate configure tests NEED_MEMORY_BARRIER may be
    invoked independently.

 src/cairo-mutex-list-private.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 901b0c97523a2da00ccf91cf4cee3bf55ce989b5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Nov 4 11:55:25 2007 +0000

    [cairo-path-fixed] Exponentially enlarge cairo_path_buf_t.
    
    Allocate subsequent path bufs twice as large as the previous buf,
    whilst still embedding a small initial buf into cairo_path_fixed_t
    that handles the most frequent usage.

 src/cairo-path-fill.c          |    2 +-
 src/cairo-path-fixed-private.h |   20 ++++++---
 src/cairo-path-fixed.c         |   89 ++++++++++++++++++++++++----------------
 3 files changed, 68 insertions(+), 43 deletions(-)

commit 92a18464bae40b19a26402eb2aa4950cac04c3a0
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat Nov 3 10:41:55 2007 +0000

    [cairo-surface] Avoid allocation for common case of 1 box.
    
    _cairo_surface_fill_region(): avoid allocating the array of boxes if we
    know that the region only contains one box and is therefore defined by its
    extents.

 src/cairo-surface.c |   48 ++++++++++++++++++++++++++++--------------------
 1 files changed, 28 insertions(+), 20 deletions(-)

commit e60a7c39cdcdfd474c4f6cc3b4612870726f55dc
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 25 10:24:01 2007 +0100

    [cairo-atomic] Check whether we can access int/pointers atomically.
    
    Add a configure check to determine whether the host cpu can read/write
    cairo_atomic_t without an explicit memory barrier, and update the macros
    within cairo-atomic-private.h to reflect this knowledge.

 configure.in               |   15 +++++++++++++++
 src/cairo-atomic-private.h |   20 +++++++++++++++-----
 2 files changed, 30 insertions(+), 5 deletions(-)

commit 76667b4c2a4243a52ab0dbe372151a9ca7dfe931
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Nov 3 16:53:54 2007 +1030

    ROADMAP: Mark set PS level complete

 ROADMAP |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 6d2615d449a9df6a8a7e3b5e5370b06dc14912f5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Nov 2 09:17:59 2007 +0000

    [test/degenerate-pen] Add missing return value.
    
    Carl - he likes to test us occasionally to make sure we're paying
    attention. Well, that's the excuse I use...

 test/degenerate-pen.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit eb0b16837b7cbf63e4b49fb5c22cd392658033d8
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Nov 1 22:11:01 2007 +0000

    [cairo-spline] Eliminate redundant _cairo_fixed_to_double().
    
    Inline and unroll PointDistanceSquaredToSegment() and eliminate the
    multiple conversions between fixed point and doubles. This simple
    transformation both shrinks the code and wins a few percent in path
    intensive benchmarks such as fuckhergently.swf

 src/cairo-spline.c |  107 +++++++++++++++++++++++++--------------------------
 1 files changed, 52 insertions(+), 55 deletions(-)

commit 2a25e226588404da2970f473bdeb0d2ce106ce58
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Nov 1 19:49:19 2007 +0000

    [cairo-spline] Reduce stack requirements during recursive refinement.
    
    By splitting out the knot vectors into a smaller, separate structure, we
    can dramatically reduce the stack allocation for each level of recursion.
    Secondly we can have the storage requirements by modifying the first set
    of knots in-place, thus we need only allocate stack space for the knots
    covering the deferred half of the spline.

 src/cairo-spline.c |   94 ++++++++++++++++++++++++++--------------------------
 src/cairoint.h     |   13 ++++---
 2 files changed, 55 insertions(+), 52 deletions(-)

commit b311c414a27b7374540671b3ef7153b30def0451
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Nov 1 19:40:25 2007 +0000

    [cairo] Use NULL instead of a bare 0.
    
    Silence a sparse warning.

 src/cairo.c |   10 +++++-----
 1 files changed, 5 insertions(+), 5 deletions(-)

commit fd5c5178189d2035f3e25919c7453fa4e1c5a76a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Nov 1 19:39:02 2007 +0000

    [cairo-scaled-font] Zero extents on early error.
    
    Ensure that the output extents of cairo_scaled_font_glyph_extents(),
    are zeroed if we return early due to being passed by the user a
    cairo_scaled_font_t with an error set.

 src/cairo-scaled-font.c |    9 ++++++++-
 1 files changed, 8 insertions(+), 1 deletions(-)

commit cee6aa016b9d96d3430187d44397df2b311de8bc
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Nov 1 19:30:19 2007 +0000

    [cairo-paginated-surface] Mark the backend static.
    
    Only used within the file, so do not expose outside the library.

 src/cairo-paginated-surface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 6e0151df469b67ea56c36f7b0050b5d5c959c67d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Nov 1 19:29:00 2007 +0000

    [cairo-atomic] Rearrange code under the correct ifdefs.
    
    The atomic get/set depend upon NEED_MEMORY_BARRIER which is separate
    from HAVE_ATOMIC_OPS.

 src/cairo-atomic.c |   24 +++++++++++++-----------
 1 files changed, 13 insertions(+), 11 deletions(-)

commit a26118cf5bf4063a4bdac2bece1bba0be776c801
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 31 16:37:09 2007 +0000

    [cairo-png] Check for feof whilst reading.
    
    We need to check for both ferror() and feof() when handling short reads.

 src/cairo-png.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 61143e5b21ea4c2687c1cef012eb0758a7cb378a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 31 16:34:51 2007 +0000

    [cairo-png] Handle missing PNG_SETJMP_SUPPORTED
    
    If libpng has not been compiled with jmpbuf support, then we cannot
    atempt to use it - in which case we fall back to png's default error
    handler and abort.

 src/cairo-png.c |   16 ++++++++++++----
 1 files changed, 12 insertions(+), 4 deletions(-)

commit c37a8ace818770ce3f07c2a7147088231d559e44
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Nov 1 00:01:16 2007 +1030

    Round floats in output-stream to 6 significant digits after decimal
    
    The previous commit increased the precision of floats from 6 digits
    after the decimal point to 18 digits to correct rounding errors with
    very small numbers. However most of the time this extra precision is
    not required and results in increased PS/PDF output.
    
    This commit makes the precision after the decimal point 6 significant
    digits. For example:
    
       1.234567
       0.123456
       0.00123456
       0.00000000123456

 src/cairo-output-stream.c |   41 +++++++++++++++++++++++++++++++++++++++--
 1 files changed, 39 insertions(+), 2 deletions(-)

commit 8297daff896ca9d803959edb3c1955977594fab9
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Oct 31 02:41:33 2007 -0400

    [cairo-output-stream] Write out floats to 18 digits after decimal point
    
    We write floats using %f as the scientific format used by smarter %g is
    invalid in PS/PDF.  %f however by default rounds to five digits after
    decimal point.  This was causing precision loss and making the newly
    added degenerate-pen test fail for PDF.  We now print up to 18 digits
    which is as many bits doubles can accomodate.  We can be smarter, but
    that's for another commit.

 src/cairo-output-stream.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 04793175ace1312ac88570407ee28db4dde9a93c
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Oct 30 22:49:10 2007 -0700

    Increment cairo version to 1.5.3 after the 1.5.2 snapshot

 configure.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit ee5dc04aaf81d6ce9c496c7966ceebfbd6ab12fb
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Oct 30 22:33:24 2007 -0700

    Add missing images to REFERENCE_IMAGES list
    
    Otherwise, these don't get included in the generated tar file
    and the test suite doesn't pass when run from that tar file,
    (like 'make distcheck' tests).

 test/Makefile.am |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

commit 194029b63afa24eff8264f10a1c5a79d90e7fdd9
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Oct 30 22:15:55 2007 -0700

    Increment cairo version to 1.5.2 and libtool versioning to 14:0:12

 configure.in |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit 06af5c2891b89da28581c30afcde06c5442884db
Author: Keith Packard <keithp@koto.keithp.com>
Date:   Tue Oct 30 22:00:59 2007 -0700

    Force non-AA text when using a bitmap strike with only scaling transform.
    
    When the current font size matches one of the available fixed sizes, and
    the overall transform has only scaling components, FreeType will use the
    fixed size bitmaps by default. For glyphs which do not have bitmaps,
    force them to be rendered in monochrome instead of anti-aliased so
    that they all match nicely.

 src/cairo-ft-font.c |   24 ++++++++++++++++++++++++
 1 files changed, 24 insertions(+), 0 deletions(-)

commit f09f02a6e82df0efb66696fca857a412e7d12672
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Oct 30 21:57:47 2007 -0700

    Add notes for 1.5.2 snapshot

 NEWS |  252 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 252 insertions(+), 0 deletions(-)

commit 448c9314252bba779194d2b01950b8738b26fd13
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Oct 30 17:09:56 2007 -0700

    Fix degenerate-pen test case by removing the triggering assertion
    
    Instead we choose either the first or last pen vertex as
    appropriate.
    
    This makes the degenerate-pen pass stop failing on an
    assertion, and passes for most backends. It's still failing
    for the PDF backend, but that looks like a new, PDF-specific
    bug.

 src/cairo-pen.c |   16 +++++++++++++++-
 1 files changed, 15 insertions(+), 1 deletions(-)

commit 5e76f652842d36086f500735f67cfd1d2f3e3edf
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Oct 30 17:00:33 2007 -0700

    Add degenerate-pen test case.
    
    This demonstrates the assertion failure pointed out by
    Benjamin Otte here:
    
    	[cairo] Assertion 'i < pen->num_vertices' failed in 1.4.10
    	http://lists.cairographics.org/archives/cairo/2007-August/011282.html

 test/.gitignore                       |    1 +
 test/Makefile.am                      |    1 +
 test/degenerate-pen-ps-argb32-ref.png |  Bin 0 -> 390 bytes
 test/degenerate-pen-ref.png           |  Bin 0 -> 278 bytes
 test/degenerate-pen.c                 |  104 +++++++++++++++++++++++++++++++++
 5 files changed, 106 insertions(+), 0 deletions(-)

commit 53378301d42eabc1ebedca983092f522299bd18e
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Oct 30 13:13:29 2007 -0700

    Update URLs for pixman to point to cairographics.org

 README       |    7 ++++---
 configure.in |    2 +-
 2 files changed, 5 insertions(+), 4 deletions(-)

commit 6957aa27e8df55ed3ef1e0cfc62c714ad9b644ee
Merge: 00d701f... 8d8724e...
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Oct 30 09:45:59 2007 -0700

    Merge in fix for get-path-extents test case.
    
    With independent fixes on both branches, the test case now
    passes completely. Hurrah!

commit 8d8724e80462593f6fee434cf972a67cb4ded282
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Oct 30 09:45:45 2007 -0700

    Improve brace readability for multi-line conditional

 src/cairo.c |    7 +++++--
 1 files changed, 5 insertions(+), 2 deletions(-)

commit f43f0c104045a88de87c5ebf28309a5ba728203e
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Oct 30 09:44:42 2007 -0700

    Fix remaining two calls to _cairo_path_fixed_get_current_point
    
    The previous commit failed to fix up two callers to the
    _cairo_path_fixed_get_current_point function, (and since
    C doesn't distinguish between an enum and our integer-as-
    Boolean, the compiler didn't complain).
    
    Fortunately, though, the test suite did complain, as the
    bug introduced a new failure into the get-path-extents
    test, and git-bisect helpfully pointed to the previous
    commit.
    
    With this fix, the new failure of get-path-extents is
    eliminated, (though, in this branch the arc-based failure
    of that test still exists).

 src/cairo-ft-font.c    |    3 +--
 src/cairo-win32-font.c |    3 +--
 2 files changed, 2 insertions(+), 4 deletions(-)

commit 00d701ff7de68609aa8cec7871d93b27a108fd14
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Oct 29 17:55:28 2007 -0700

    Limit miters for small angles
    
    This fixes the current failure get-path-extents, which is a
    demonstration of the following bug:
    
    	cairo_stroke_extents() gives wrong result for arcs in some cases
    	https://bugs.freedesktop.org/show_bug.cgi?id=7245
    
    Many thanks to Michael Urman whose review of early versions of
    this work found a fatal mistake in my algebra.

 src/cairo-path-stroke.c |   76 ++++++++++++++++++++++++++++++++++++++++++++++-
 1 files changed, 75 insertions(+), 1 deletions(-)

commit 9bf0a640d203a880cae5c6a8bf3602344d03cb68
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Oct 29 16:24:13 2007 -0700

    Add figure illustrating derivation of miter limit
    
    And use sin in the first place rather than the more awkward
    secant.

 src/cairo-path-stroke.c |   43 ++++++++++++++++++++++++++++++++++++-------
 1 files changed, 36 insertions(+), 7 deletions(-)

commit abeba1e69be3d4500107f10e50e1f0e7cae8c78f
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Oct 29 16:22:15 2007 -0700

    Annoying churn of sgml templates

 doc/public/tmpl/cairo-ps.sgml          |   53 ++++++++++++++++++++++++++++++++
 doc/public/tmpl/cairo-surface.sgml     |   19 +++++++++++
 doc/public/tmpl/cairo-win32-fonts.sgml |   10 ++++++
 doc/public/tmpl/cairo-win32.sgml       |    9 +++++
 4 files changed, 91 insertions(+), 0 deletions(-)

commit 0d42af2427d1de27845cb8a6b3d290a562c28fc6
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 30 11:13:44 2007 +0000

    [cairo-surface] Fix typo in doc.
    
    s/INVALUE_FORMAT/INVALID_FORMAT/

 src/cairo-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 39664b7cac7244ac901cb361442ca2967d74a542
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 30 11:01:40 2007 +0000

    [cairo-path] Return CAIRO_STATUS_SUCCESS.
    
    If we have already returned the error status, then it is cleaner (and
    the common idiom) to use 'return CAIRO_STATUS_SUCCESS' rather than
    'return status'.

 src/cairo-path.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit e57df319633f8ebd0249096d76c9058f31f9835b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 30 10:58:16 2007 +0000

    [cairo-path] Make _cairo_path_nil static.
    
    _cairo_path_nil is only used within cairo-path.c, so there is no reason
    to expose it to the rest of the libary.

 src/cairo-path-private.h |    2 --
 src/cairo-path.c         |    2 +-
 2 files changed, 1 insertions(+), 3 deletions(-)

commit 6fdb7f129c8154e288ee40765fa63ffaeebaf8fd
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 30 10:42:22 2007 +0000

    Simplify return value from cairo_path_fixed_get_current_point().
    
    The only caller of cairo_path_fixed_get_current_point(), used the status
    return to determine whether or not the path had a current point (and did
    not propagate the error) - for which we had already removed the
    _cairo_error() markup. Now we reduce the boolean status return to a
    cairo_bool_t, with a net reduction in code.

 src/cairo-path-fixed.c |   11 ++++-------
 src/cairo.c            |   13 +++++--------
 src/cairoint.h         |    2 +-
 3 files changed, 10 insertions(+), 16 deletions(-)

commit 4a2ab87e1a19921e2ae496f375c1144d2710d0c4
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Oct 29 12:04:33 2007 +0000

    [cairo-surface] Add the usual guards to _cairo_surface_set_font_options().
    
    Adrian Johnson hit a SEGV after
    _cairo_paginaged_surface_create_image_surface() tried to set the font
    options on an error surface after running out of memory. So add the
    usual checks that the surface is not a snapshot, or in an error state or
    finished before modifying its font options.

 src/cairo-surface.c |   13 +++++++++++++
 1 files changed, 13 insertions(+), 0 deletions(-)

commit bb6d36561c5f50d869236b2bb4d10afd627f9a1d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat Oct 27 17:29:54 2007 +0100

    [test/get-path-extents] Add link to bug report.
    
    Add a link to the original bug report for the broken extents with arcs.
    [http://bugs.freedesktop.org/show_bug.cgi?id=7245]

 test/get-path-extents.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit a69d4731300b430b802222d317698c313c75a31a
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Oct 26 22:58:57 2007 -0700

    Fix typo in _cairo_gstate_fini
    
    Obrigado a Luiz Americo Pereira Camara <luizmed@oi.com.br>

 src/cairo-gstate.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 0c02b998f9e8589a90b2e744392995903b94414f
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 26 18:06:36 2007 +0100

    [cairo-gstate] Allow angle==0 whilst rotating.
    
    Cut'n'paste error whilst copying the NaN check from
    _cairo_gstate_scale() flagged the no rotation case as an error.

 src/cairo-gstate.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit ce44cd65238d38dd6958bf1f7b8ffb9d0e8723c3
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 25 00:01:21 2007 +0100

    [cairo-gstate] Add a missing _cairo_error() markup.
    
    Missed calling _cairo_error() for the CAIRO_STATUS_NULL_POINTER
    returned by _cairo_gstate_init(). Rearrange the code to avoid the
    overly complicated return statement. We note that _cairo_gstate_init()
    is special as _cairo_gstate_fini() will always be called, even if an
    error is thrown, and so do not do the usual cleanup in the case of an
    aborted initialization.

 src/cairo-gstate.c |   26 ++++++++++++++++++--------
 1 files changed, 18 insertions(+), 8 deletions(-)

commit 4ce785e6a9433e7c862efaa6ef9c113412bf51a5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 24 21:58:08 2007 +0100

    [cairo-gstate] Add NaN check to rotate.
    
    Check the user input to _cairo_gstate_rotate() for invalid numbers.

 src/cairo-gstate.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 6295a296b0064f0959ca7f39e1d8d00fa51b6251
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 24 21:29:54 2007 +0100

    [cairo-gstate] Check scale sx * sy != 0.
    
    Bill Spitzak said
        "If you really want to match when the determinant is non-zero in the
        resulting matrix, use sx*sy != 0. This appears the same as sx&&sy but
        may also catch when underflow makes the determinant zero."
    
    Return CAIRO_STATUS_INVALID_MATRIX if we know the user input will
    generate a degenerate matrix. For additional paranoia we could recompute
    and validate the inverse each time as well.

 src/cairo-gstate.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 483ebe866df539460861a05f5d5e8e56ab2f5430
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 24 19:32:00 2007 +0100

    [cairo-test] Remove executable flag from source files.
    
    chmod a-x test/cairo-test.[ch]

 0 files changed, 0 insertions(+), 0 deletions(-)

commit 1651359ffbda4c14eaf4e79b6deced4f2c247686
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 24 18:35:41 2007 +0100

    [cairo-perf-diff-files] Only use a valid initializer for min_test.
    
    Do not assume that the tests[0] is a valid test, but instead scan for
    the first test that has a name (i.e. is not a terminator).

 perf/cairo-perf-diff-files.c |    9 +++++++--
 1 files changed, 7 insertions(+), 2 deletions(-)

commit 38c779e7d672151d25cd596149485fcc9f21c298
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 23 12:57:26 2007 +0100

    [cairo-perf-diff-files] Check for terminator before comparing tests.
    
    Only the name of the terminating test is set so check that the current
    test is not the terminator before comparing.

 perf/cairo-perf-diff-files.c |   23 ++++++++++++++++-------
 1 files changed, 16 insertions(+), 7 deletions(-)

commit e3248a21841cfcbc285d76e2299485f9822857f1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Oct 22 09:34:55 2007 +0100

    [cairo-matrix] Check user input for invalid numbers.
    
    Supplement the guards for scale==0 with checks that the user does not
    attempt to translate or scale by invalid numbers.

 src/cairo-gstate.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

commit 8888afe9a4269e2d740d309186159fe946e57eaf
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Mon Oct 22 23:05:25 2007 +0930

    PDF: Fix meta surface patterns with EXTEND_REFLECT

 src/cairo-pdf-surface.c |   34 +++++++++++++++++++++++++++++-----
 1 files changed, 29 insertions(+), 5 deletions(-)

commit f073a83251e56f641a522764c5cab1d71a786a60
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Mon Oct 22 00:02:23 2007 +0930

    win32-printing: fix error in comment

 boilerplate/cairo-boilerplate-win32-printing.c |   21 +++++++++++----------
 1 files changed, 11 insertions(+), 10 deletions(-)

commit fb2bf3e250b39078476d3df4bdbb81201ef00a96
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:50:57 2007 +0930

    win32-printing: remove unused code

 src/cairo-win32-printing-surface.c |   17 -----------------
 1 files changed, 0 insertions(+), 17 deletions(-)

commit b854d1e1b57680f244939b90b03911a5300f34d6
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:50:28 2007 +0930

    win32-printing: fix typo in comment

 src/cairo-win32-printing-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 2d68c46b779909b5cc493a62db1228ea504ff52a
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:49:58 2007 +0930

    win32-printing: fix dash-caps-joins test failure

 src/cairo-win32-printing-surface.c |   11 ++++++-----
 1 files changed, 6 insertions(+), 5 deletions(-)

commit 5fa62250456745907dd97fdb9030481bdc91a8dd
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:49:33 2007 +0930

    win32-printing: Add test boilerplate
    
    Testing win32-printing requires setting the default printer to
    a PostScript level 3 color printer. The PostScript output is
    saved to a file and converted to png using ghostscript.

 boilerplate/Makefile.am                        |    2 +
 boilerplate/cairo-boilerplate-win32-printing.c |  308 ++++++++++++++++++++++++
 boilerplate/cairo-boilerplate-win32-private.h  |   15 ++
 boilerplate/cairo-boilerplate.c                |   11 +
 4 files changed, 336 insertions(+), 0 deletions(-)

commit e63b5e5201a79a8af4bd1d5acb524f067b5f2794
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:47:35 2007 +0930

    win32-printing: Use the surface ctm in show_glyphs
    
    show_glyphs needs to scale the font by the current CTM.

 src/cairo-win32-printing-surface.c |   14 ++++++++++++++
 1 files changed, 14 insertions(+), 0 deletions(-)

commit ac9831ea55bd62f0ed427230ad80348768415852
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:46:52 2007 +0930

    win32-printing: fix stroke rounding problems
    
    The win32 CTM is changed to user space to set the stroke parameters.
    As win32 uses integers for stroke parameters this will cause rounding
    problems depending on the CTM used.
    
    This is fixed by factoring out a scale from the user space CTM so that
    xx, xy, yx, and yy in the CTM are all < 1. This preserves the shape
    of the transformation while ensuring that the CTM does not cause
    rounding problems. The stroke parameters are multiplied by the scale
    value.

 src/cairo-win32-printing-surface.c |   35 +++++++++++++++++++++++++++++------
 1 files changed, 29 insertions(+), 6 deletions(-)

commit 89fe7b2ff09d19d3bdc84a8ee871e15716ff3539
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:45:40 2007 +0930

    win32-printing: fix rounding problems when using pattern matrix
    
    When using meta surface patterns, the win32 CTM is changed to the
    inverted pattern matrix then the meta surface is replayed to the
    surface. The problem with this is that win32 uses integer coordinates
    for GDI functions. A pattern matrix that scale the CTM up will cause
    rounding errors in the position of each path in the pattern.
    
    This is fixed by always keeping the win32 CTM set to the identity
    matrix. The CTM is stored in the surface and all coordinates are
    transformed by the CTM before calling GDI functions.

 src/cairo-win32-printing-surface.c |  167 +++++++++++++++++++++++++++++-------
 src/cairo-win32-private.h          |    2 +
 2 files changed, 138 insertions(+), 31 deletions(-)

commit af01d9b8fabc2422eb7db144171d52fab95c4387
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:43:27 2007 +0930

    win32-printing: add meta surface pattern support

 src/cairo-win32-printing-surface.c |  251 ++++++++++++++++++++++++++++--------
 src/cairo-win32-private.h          |    1 +
 2 files changed, 200 insertions(+), 52 deletions(-)

commit dae1b352c60e6a63ec2131f788fec230fd583d3d
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:42:54 2007 +0930

    update cairo-sections.txt

 doc/public/cairo-sections.txt |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit c8da2a7dedb8352bb623954c3ac40244b86eeb24
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:42:22 2007 +0930

    win32-printing: check if images are opaque
    
    Don't use fallback for argb32 images with all alpha == 255.

 src/cairo-win32-printing-surface.c |   57 ++++++++++++++++++++++++++++++++++++
 1 files changed, 57 insertions(+), 0 deletions(-)

commit 9eb5747755f8c57bd6ba04925e193503fe194462
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 21 23:41:31 2007 +0930

    win32-printing: Add missing struct initializers

 src/cairo-win32-printing-surface.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 8f6abdbc26ee15451b5a386610f7d5a7a9114d63
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Oct 20 23:41:46 2007 +0100

    [quartz] return status instead of CGPatternRef
    
    Returning status improves error handling, since
    returning NULL doesn't let us distinguish different
    types of error.

 src/cairo-quartz-surface.c |   20 +++++++++++---------
 1 files changed, 11 insertions(+), 9 deletions(-)

commit cfb26fdf0f490b4902106b50d02628cffd53a0eb
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Oct 20 23:41:32 2007 +0100

    [quartz] return status instead of cairo_quartz_surface_t
    
    Returning status improves error handling, since
    returning NULL doesn't let us distinguish different
    types of error.

 src/cairo-quartz-surface.c |   32 ++++++++++++++++++--------------
 1 files changed, 18 insertions(+), 14 deletions(-)

commit dec3099585eeb184ed51b5c720eb891314d7ea51
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Oct 20 22:45:30 2007 +0100

    [quartz] return status instead of CGShadingRef
    
    Returning status improves error handling, since
    returning NULL doesn't let us distinguish different
    types of error. Suggested by Chris Wilson.

 src/cairo-quartz-surface.c |   30 ++++++++++++++++--------------
 1 files changed, 16 insertions(+), 14 deletions(-)

commit 481ce2b8cb2dc376419e7d6cbdd73bd4ebcd5b5b
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Jul 1 14:37:57 2007 +0100

    implement clipping with surface masks.
    
    This implements clipping using CGContextClipToMask, which
    means that it will only have an effect on OS X 10.4+.
    No additional tests pass with this fix - mainly due to
    text effects and problems with the IN, OUT, DEST_IN, DEST_ATOP
    operators.

 src/cairo-quartz-surface.c |   43 +++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 43 insertions(+), 0 deletions(-)

commit b9c065df74027b06e15e105fee5e4a4d350e0abf
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Jun 24 23:53:47 2007 +0100

    fix dash-zero-length test
    
    Quartz was failing the dash-zero-length test for odd numbers
    of dashes; it seems cairo wants 3 dashes to be on-off-on,
    off-on-off, wheras quartz uses on-off-on, on-off-on. Fixed
    by doubling the number of dashes used.

 src/cairo-quartz-surface.c |   16 +++++++++++-----
 1 files changed, 11 insertions(+), 5 deletions(-)

commit f334ee0397963e12c9efcb2690792aac83734661
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Jun 24 01:17:58 2007 +0100

    Implement EXTEND_NONE for gradients.
    
    Fixes linear and radial gradients, which were displaying with
    extend_pad when extend_none was requested. Makes the
    radial-gradient test pass.

 src/cairo-quartz-surface.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit 0eeec372c0e7849d81bde8c8c5bf491919f51a6e
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Jun 23 23:36:32 2007 +0100

    call _cairo_error on failure
    
    Call _cairo_error to enable setting a breakpoint on quartz errors.

 src/cairo-quartz-surface.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 8c8ec63903f8ad67a88394eff1359607bb93cf88
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Jun 23 12:34:24 2007 +0100

    do not return a cairo_status_t of UNSUPPORTED
    
    We had a bug which converted cairo_int_status_t to cairo_status_t,
    causing an assertion; reported at http://developer.imendio.com/node/128.
    Return the generic out of memory error instead.

 src/cairo-quartz-surface.c |    9 +++++++--
 1 files changed, 7 insertions(+), 2 deletions(-)

commit 6fec51990e90901ebafbb872a9e618cb70d17911
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Jun 18 00:07:33 2007 +0100

    do not ignore errors, return NULL instead (moz#874315)
    
    In the quartz backend there are occasional errors where returning NULL
    can be used to signal that an error has occured.
    
    Mozilla bug #874315.

 src/cairo-quartz-surface.c |   37 ++++++++++++++++++++++++++++---------
 1 files changed, 28 insertions(+), 9 deletions(-)

commit 07fd091e3e6b925c588b9a16f6f10efcd46615c2
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Jun 18 00:07:33 2007 +0100

    do not ignore errors in setup_source
    
    In setup_source we were ignoring a return value, but we can't relay
    it to the caller. This patch treats the error as an unsupported
    operation.

 src/cairo-quartz-surface.c |    6 +++++-
 1 files changed, 5 insertions(+), 1 deletions(-)

commit b6b9cef7136453f97543173bcb2ade46b1c46b77
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Tue Jun 19 21:13:39 2007 +0100

    do not ignore errors when creating styles.
    
    This fixes statuses being ignored when calling
    CreateSizedCopyOfStyle. As a side effect, it cleans up
    two other bugs - the font object was sometimes not
    freed, and a the scaled font mutex was aquired recursively,
    causing a hang in the invalid-matrix test.

 src/cairo-atsui-font.c |   37 ++++++++++++++++++++++++++-----------
 1 files changed, 26 insertions(+), 11 deletions(-)

commit 4885a12c6863321a566e7103bf6dccdd5d13a986
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Jun 18 00:07:33 2007 +0100

    do not ignore ATSUI errors.
    
    This fixes multiple instances where the return value of an ATSUI
    call was ignored and converts them into CAIRO_STATUS_NO_MEMORY.
    As a side effect it fixes a utf8 array not being freed.

 src/cairo-atsui-font.c |   74 ++++++++++++++++++++++++++++++++++++++++++------
 1 files changed, 65 insertions(+), 9 deletions(-)

commit b498c928be73635614596243d17a922e9d5ff008
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Jun 18 00:07:33 2007 +0100

    do not ignore errors in glyph paths
    
    When interpreting glyph paths in ATSUI callbacks we were ignoring
    the cairo status. We need to return this to the caller. In order
    to do this we introduce a custom OSStatus code in the range that
    Apple reccommend.

 src/cairo-atsui-font.c |   30 ++++++++++++++++++++++++------
 1 files changed, 24 insertions(+), 6 deletions(-)

commit 95c708c717a367205845cefc81ae0afd9bd3d18f
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Jun 18 00:07:33 2007 +0100

    propagate cairo_status_t return values
    
    There are several places in the quartz surface where we ignored
    the returned status. This fixes the simple cases where the error
    can just be returned to the caller.

 src/cairo-quartz-surface.c |   16 +++++++++++++---
 1 files changed, 13 insertions(+), 3 deletions(-)

commit 7072959e3da0e8814cfd5193f8915aeb1341cc37
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Oct 20 11:46:54 2007 +0100

    Fix to support new similar tests.
    
    The patch to repeat tests for similar surfaces changed the
    format of the test log files, which were parsed to produce
    index.html. This fixes the parser to understand those changes.

 test/make-html.pl |  136 +++++++++++++++++++++++++++++------------------------
 1 files changed, 75 insertions(+), 61 deletions(-)

commit ae2535e4cb7c09eda1be13079d7a23b262aaef7b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 19 23:25:57 2007 +0100

    [cairo-perf] Run performance tests over similar surfaces as well.
    
    Immediately repeat the performance test against a similar surface to
    ensure that they introduce no regressions. Primarily introduced to
    sanity check the change to use XShmPixmaps instead of XPixmaps in the
    xlib backend, but it should be generally useful.

 perf/cairo-perf.c |  121 +++++++++++++++++++++++++++++++++--------------------
 1 files changed, 75 insertions(+), 46 deletions(-)

commit 081507a09e61e1e4a048e40f8ba67a76aa76bbef
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 19 22:26:28 2007 +0100

    [cairo-test] Repeat tests for similar surfaces.
    
    Having noticed strange discrepancies creeping into similar surfaces
    whilst working on the xlib backend, I thought it wise to also run
    the test harness against similar targets. For consistency, only
    targets whose similar surface use the same backend are included.
    
    This can be disabled by exporting CAIRO_TEST_IGNORE_SIMILAR=1.

 test/cairo-test.c |  173 ++++++++++++++++++++++++++++++++++------------------
 1 files changed, 113 insertions(+), 60 deletions(-)

commit 3211d810d31a6607c8d78a50f577a8ca8eb705e6
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 19 22:45:15 2007 +0100

    [cairo-xlib] Check source for XRender support.
    
    Do not rely on the assumption that if the destination has render support
    then the source has it as well - breaks when the boilerplate disables
    render support for a surface.
    
    Similarly do not set the XRender attributes on the source surface
    unless it actually has a xrender_format.

 src/cairo-xlib-surface.c |   17 +++++++++--------
 1 files changed, 9 insertions(+), 8 deletions(-)

commit 5c08226a0f7bc373a96fe75d15ad854910eb3265
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 19 16:04:33 2007 +0100

    [cairo-clip] Avoid work when all clipped out.
    
    When the clip mask is empty we perform actions like composite 0x0
    surfaces, which results in a lot of unnecessary work and allocations.
    Avoid doing work when we know everything is clip out and take the
    liberty of freeing any memory associated with the clop state.

 src/cairo-clip-private.h |    2 +
 src/cairo-clip.c         |   86 +++++++++++++++++++++++++++++++++++++++++-----
 2 files changed, 79 insertions(+), 9 deletions(-)

commit c70c2cf6d6a71df54515175af0cb1651b67bdb86
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 19 23:31:36 2007 +0100

    [Makefile.am] Fix ${top_srcdir}/libtool
    
    libtool exists in the top level build directory, but in a couple of
    places we refer to the top level source directory.

 perf/Makefile.am |    4 ++--
 test/Makefile.am |    2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

commit 76e3b3cdc3dda986d420637cfc2445aca481a863
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Oct 19 15:02:03 2007 -0400

    [cairo-xlib] Release glyph surfaces if we made them to be generated
    
    The reasoning is that right now, applications render glyphs to images,
    upload it to the X server, and keep a local copy in the cache.  The X
    server works hard to reuse glyph renderings, by hashing glyph images and
    reusing them.  So we are wasting memory in cairo apps that don't use the
    glyph surface after uploading to the server, which is the case if you
    don't use the glyph in an image surface.  The patch does not release the
    glyph surface if it already existed in the cache, so, worst case
    scenario is that we render the glyph twice, if you first use it with
    xlib, then with image surface.  That effect should be negligible.

 src/cairo-xlib-surface.c |   83 +++++++++++++++++++++++++++++++++++-----------
 1 files changed, 63 insertions(+), 20 deletions(-)

commit 8ae778273799ee9f6d3c13e9c41730daeda2c743
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 18 20:07:12 2007 +0100

    [cairo-xlib-surface] Match content to xrender_format using the channel masks.
    
    _xrender_format_to_content() was using the channel offset to determine
    whether the format supported a content type.
    For example, the XRenderPictFormat for the A8 format looks like:
        direct.alpha = 0; direct.alphaMask = 0xff;
        direct.red   = 0; direct.redMask   = 0x00;
        direct.green = 0; direct.greenMask = 0x00;
        direct.blue  = 0; direct.blueMask  = 0x00;
    which _xrender_format_to_content() matched as CAIRO_CONTENT_COLOR.
    
    Switch to using the channel masks for deducing content type.

 src/cairo-xlib-surface.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit b7d8763c58165817f3238def4d1771ce8575139e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 18 19:42:21 2007 +0100

    [check-plt] Use -W flag to readelf.
    
    Pass -W to readelf so that the output (in particular the function name)
    is not clipped to fit within 80 characters.

 src/check-plt.sh |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 01eb16977359c7953dbabb52e1f6a132d93839f3
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 18 19:28:00 2007 +0100

    [test/.gitignore] Add *.exe.so
    
    Ignore these winegcc output files.

 test/.gitignore |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit c64335a9a846ba18411a720f6e69e511b15e2c6b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 17 23:12:49 2007 +0100

    [cairo-scaled-font-subsets] Simplify boolean return code.
    
    _cairo_sub_font_lookup_glyph() was returning either a NULL_POINTER
    error or success whereas its only caller was using it as a simple
    predicate and handled the 'error' rather than propagate it upwards.

 src/cairo-scaled-font-subsets.c |   20 +++++++++-----------
 1 files changed, 9 insertions(+), 11 deletions(-)

commit 379b9b79fa77be1bf9b5e0581b2363e80b0a8c88
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 17 20:41:57 2007 +0100

    [cairo-xlib] Move the buggy_repeat discovery to the display_t.
    
    The VendorString parsing (to detect broken Xserver versions) was being
    performed for each surface creation, but as it is a display invariant
    we can save a small amount of work by storing the result on the
    cairo_xlib_display_t.

 src/cairo-xlib-display.c |    9 +++++++++
 src/cairo-xlib-private.h |    1 +
 src/cairo-xlib-surface.c |    9 +--------
 3 files changed, 11 insertions(+), 8 deletions(-)

commit 5e09653e5dca60902423938737195e38ccde1b95
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 16 15:30:50 2007 +0100

    [test/rgb24-ignore-alpha] Destroy the surface after use.
    
    Destroy the surface so that valgrind doesn't complain about the memory
    leak.

 test/rgb24-ignore-alpha.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit bd3dd72262772f1b2dfd8335630163f2e3bfacac
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 16 15:29:59 2007 +0100

    [pdiff] Reorganise the inner loops of the convolution.
    
    Reorder the indices and introduce a couple of temporary accumulators to
    improve cache access.

 test/pdiff/lpyramid.c |   27 +++++++++++++++------------
 1 files changed, 15 insertions(+), 12 deletions(-)

commit fa9201b9c98b18ea18fbee1e5608f20335a02131
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 16 15:27:33 2007 +0100

    [pdiff] Check for too small images.
    
    The Laplacian pyramid can only work on images larger than 3x3 due to the
    size of its convolution kernel. So if the image is too small return an
    error (-1) before attempting to construction the pyramid.

 test/pdiff/pdiff.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 3b1cc128dc4223ac88f7824dca223ed0f84df5d9
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 16 10:55:04 2007 +0100

    [cairo-ft-font] Add paranoid error checking to Fc* operations.
    
    Check the return status when using Fc*() functions to modify the pattern
    and propagate the failure (if necessary).

 src/cairo-ft-font.c    |  178 +++++++++++++++++++++++++++++-------------------
 src/cairo-ft-private.h |    1 -
 2 files changed, 108 insertions(+), 71 deletions(-)

commit a55f1abf7cdc0276fe1eb85db969f33d0df4fe75
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 16 10:29:45 2007 +0100

    [cairo-clip] Pass the local pattern to create_similar_solid().
    
    Avoid the short-lived pattern allocation within
    _cairo_surface_create_similar_solid() by providing the local solid
    pattern to use as the source.

 src/cairo-clip.c |   12 +++++++-----
 1 files changed, 7 insertions(+), 5 deletions(-)

commit 7ff80234e3823547395819f96d7f7673df9ce9df
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 16 10:37:45 2007 +0100

    [cairo-path-fixed] Drop the _cairo_error() markup.
    
    Do not use _cairo_error(CAIRO_STATUS_NO_CURRENT_POINT) within
    _cairo_path_fixed_get_current_point() as the only caller,
    cairo_get_current_point(), expects and handles that status.

 src/cairo-path-fixed.c |    7 +++++--
 1 files changed, 5 insertions(+), 2 deletions(-)

commit 189feaf352f59b0a049202552024578715ef8cc7
Author: Chris Heath <chris@heathens.co.nz>
Date:   Mon Oct 15 17:31:50 2007 -0400

    [autogen.sh] Tolerate tput failure (#12757)

 autogen.sh |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 4660561cb548ab8d1eca724fda4d3658c95d4c04
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 14 19:05:06 2007 +0930

    PDF: Add support for CAIRO_FORMAT_A1 images

 src/cairo-pdf-surface.c |   43 ++++++++++++++++++++++++++++++++++++-------
 1 files changed, 36 insertions(+), 7 deletions(-)

commit 39044157da03d598b816a459979f3d0e6285e023
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 14 19:04:33 2007 +0930

    PDF: Add support for linear gradients with REPEAT and REFLECT

 src/cairo-pdf-surface.c |  228 +++++++++++++++++++++++++++++++++++++++--------
 1 files changed, 189 insertions(+), 39 deletions(-)

commit 5af1b2280b2cf952624d587496158a98df0ee504
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Oct 14 00:04:21 2007 +0930

    Make PostScript output text selectable
    
    The glyph names used in the Type42 and Type1 fallback fonts are now of
    the form "/uniXXXX" where XXXX is the unicode character for each
    glyph. When converted to pdf (eg using ps2pdf), pdf viewers are now
    able to correctly extract the text.

 src/cairo-ps-surface.c                  |   36 ++++++--
 src/cairo-scaled-font-subsets-private.h |   15 +++
 src/cairo-scaled-font-subsets.c         |  159 +++++++++++++++++++++++++++++++
 src/cairo-type1-fallback.c              |   18 +++-
 src/cairoint.h                          |    1 +
 5 files changed, 219 insertions(+), 10 deletions(-)

commit e347a7a7c394fc2638faa2ff52e4b96545ac1ee3
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Oct 13 22:59:20 2007 +0930

    PS: Add support for images with bilevel alpha
    
    This patch eliminates two sources of fallback images. The alpha value
    of each pixel in argb32 images are checked. If all alpha values are
    255 the image is treated the same as rgb24 images. If all alpha values
    are either 0 or 255 and the PS level is 3, a Type 3 image (image +
    mask) is emitted.

 src/cairo-ps-surface.c |  519 ++++++++++++++++++++++++++++++++++++------------
 1 files changed, 388 insertions(+), 131 deletions(-)

commit af5cdde34d003b7d5943b169c160b91b8f7d10f3
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Oct 13 22:15:48 2007 +0930

    PS/Win32-printing: remove redundant checks from _analyze_operation
    
    The check for supported operators is performed earlier in this
    functions so these two checks in not required.

 src/cairo-ps-surface.c             |    6 ------
 src/cairo-win32-printing-surface.c |    6 ------
 2 files changed, 0 insertions(+), 12 deletions(-)

commit ff35ffd2a7baa775e2ef73b844e783434c149057
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Oct 13 22:09:04 2007 +0930

    Add meta-surface-pattern test

 test/.gitignore                         |    1 +
 test/Makefile.am                        |    1 +
 test/meta-surface-pattern-ref.png       |  Bin 0 -> 3072 bytes
 test/meta-surface-pattern-rgb24-ref.png |  Bin 0 -> 3162 bytes
 test/meta-surface-pattern.c             |  131 +++++++++++++++++++++++++++++++
 5 files changed, 133 insertions(+), 0 deletions(-)

commit 0b3f530973049737f942219452d991d76b65b724
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Oct 13 21:49:50 2007 +0930

    Add PS reference images for tests using gradients

 test/clip-operator-ps-argb32-ref.png   |  Bin 0 -> 8594 bytes
 test/gradient-alpha-ps-argb32-ref.png  |  Bin 0 -> 187 bytes
 test/gradient-alpha-ps-rgb24-ref.png   |  Bin 0 -> 184 bytes
 test/linear-gradient-ps-argb32-ref.png |  Bin 0 -> 613 bytes
 test/linear-gradient-ps-rgb24-ref.png  |  Bin 0 -> 613 bytes
 test/operator-source-ps-argb32-ref.png |  Bin 0 -> 3885 bytes
 test/operator-source-ps-rgb24-ref.png  |  Bin 0 -> 3548 bytes
 test/text-pattern-ps-argb32-ref.png    |  Bin 0 -> 997 bytes
 test/text-pattern-ps-rgb24-ref.png     |  Bin 0 -> 969 bytes
 test/trap-clip-ps-argb32-ref.png       |  Bin 5810 -> 5700 bytes
 test/trap-clip-ps-rgb24-ref.png        |  Bin 0 -> 5616 bytes
 11 files changed, 0 insertions(+), 0 deletions(-)

commit e66ce8cbc6e53b4b07a9af6bb7d2294ada0782c0
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Oct 13 21:28:19 2007 +0930

    PS: Add linear and radial gradient support

 src/cairo-ps-surface.c |  321 +++++++++++++++++++++++++++++++++++++++++++-----
 1 files changed, 291 insertions(+), 30 deletions(-)

commit 583059e4a3e86c937de13c07a50486f7ca77b335
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Oct 13 21:16:49 2007 +0930

    Fix bug in _gradient_is_opaque()

 src/cairo-pattern.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit b5c36010edc92ca129a0498cf04592f8f692f800
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Oct 13 21:14:28 2007 +0930

    Add cairo_ps_surface_restrict_to_level() API

 doc/public/cairo-sections.txt  |    4 ++
 src/cairo-ps-surface-private.h |    2 +
 src/cairo-ps-surface.c         |   99 +++++++++++++++++++++++++++++++++++++++-
 src/cairo-ps.h                 |   25 ++++++++++
 4 files changed, 129 insertions(+), 1 deletions(-)

commit b5fa273c9a4f730882c6edade785236e72b2b4db
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Oct 13 21:04:51 2007 +0930

    Add PS reference images for tests using create_similar
    
    before the PS meta surface pattern patch these tests
    had image fallacks in the PS output and did not require
    a PS reference image.

 test/clip-fill-rule-ps-rgb24-ref.png             |  Bin 0 -> 309 bytes
 test/clip-nesting-ps-rgb24-ref.png               |  Bin 0 -> 636 bytes
 test/clip-push-group-ps-argb32-ref.png           |  Bin 0 -> 179 bytes
 test/clip-push-group-ps-rgb24-ref.png            |  Bin 0 -> 179 bytes
 test/clip-twice-ps-rgb24-ref.png                 |  Bin 0 -> 541 bytes
 test/copy-path-ps-rgb24-ref.png                  |  Bin 0 -> 440 bytes
 test/dash-caps-joins-ps-rgb24-ref.png            |  Bin 0 -> 3852 bytes
 test/dash-scale-ps-rgb24-ref.png                 |  Bin 0 -> 6316 bytes
 test/dash-state-ps-rgb24-ref.png                 |  Bin 0 -> 8650 bytes
 test/degenerate-path-ps-rgb24-ref.png            |  Bin 0 -> 358 bytes
 test/fill-and-stroke-ps-rgb24-ref.png            |  Bin 0 -> 319 bytes
 test/fill-missed-stop-ps-rgb24-ref.png           |  Bin 0 -> 531 bytes
 test/fill-rule-ps-rgb24-ref.png                  |  Bin 0 -> 2031 bytes
 test/font-matrix-translation-ps-rgb24-ref.png    |  Bin 0 -> 783 bytes
 test/leaky-dash-ps-rgb24-ref.png                 |  Bin 0 -> 284 bytes
 test/line-width-scale-ps-rgb24-ref.png           |  Bin 0 -> 3901 bytes
 test/new-sub-path-ps-rgb24-ref.png               |  Bin 0 -> 423 bytes
 test/pixman-rotate-ps-argb32-ref.png             |  Bin 0 -> 411 bytes
 test/pixman-rotate-ps-rgb24-ref.png              |  Bin 0 -> 392 bytes
 test/random-intersections-ps-rgb24-ref.png       |  Bin 0 -> 89414 bytes
 test/rel-path-ps-rgb24-ref.png                   |  Bin 0 -> 243 bytes
 test/rotate-image-surface-paint-ps-rgb24-ref.png |  Bin 0 -> 274 bytes
 test/source-clip-scale-ps-argb32-ref.png         |  Bin 0 -> 183 bytes
 test/source-clip-scale-ps-rgb24-ref.png          |  Bin 0 -> 183 bytes
 test/text-rotate-ps-rgb24-ref.png                |  Bin 0 -> 7196 bytes
 25 files changed, 0 insertions(+), 0 deletions(-)

commit 8520ce31be13bc939357cd45bd1b4c1967d7ff53
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Oct 13 20:17:43 2007 +0930

    PS: Add meta surface pattern support

 boilerplate/cairo-boilerplate.c |   11 +--
 src/cairo-ps-surface-private.h  |    2 +-
 src/cairo-ps-surface.c          |  257 ++++++++++++++++++++++++++-------------
 3 files changed, 177 insertions(+), 93 deletions(-)

commit e5b01e67975578797b4f7875a9ba02121ff935b5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 11 17:54:55 2007 +0100

    [Makefile.am] Add missing headers and reference images.
    
    Andrew Jorgensen spotted that make dist was missing a few headers needed
    for compilation and running make distcheck had spurious failures. Add
    the missing files to the distribution and a silly one-liner to check for
    missing reference images.

 src/Makefile.am  |    2 ++
 test/Makefile.am |   25 ++++++++++++++++++++++++-
 2 files changed, 26 insertions(+), 1 deletions(-)

commit b7adcf67f8c640c146bada1fbeaa1cda1cfa825a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 11 14:11:06 2007 +0100

    [cairo-path-stroke] Jump to cleanup after error.
    
    Incorrect early return in _cairo_stroker_curve_to() after
    _cairo_stroker_join() resulted in leaking the local spline and pen.

 src/cairo-path-stroke.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 0222c02d9525dc8ff1ad5a2bea46e623d9db1e43
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 11 14:01:20 2007 +0100

    [cairo-pdf-surface] Return UNSUPPORTED from _to_unicode_stream().
    
    Distinguish the UNSUPPORTED case where the font backend does not
    support conversion to unicode from other fatal errors by returning a
    status value rather than using stream.id == 0 to indicate any error.

 src/cairo-pdf-surface.c |   71 +++++++++++++++++++++++++---------------------
 1 files changed, 39 insertions(+), 32 deletions(-)

commit 981bc12e5b9b91ce1c5abe343ace837561059658
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 10 23:58:43 2007 +0100

    [cairo-ps-surface] Close a couple of memory leaks.
    
    Adjust error paths to free local resources.

 src/cairo-ps-surface.c |   18 +++++++++++-------
 1 files changed, 11 insertions(+), 7 deletions(-)

commit c1db44b26501cd905fb9ca858f41632c148b6b07
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 10 15:15:55 2007 +0100

    [cairo-png] Clean up volatile warning.
    
    gcc warns that 'rows' is missing a volatile qualifier - so add it.

 src/cairo-png.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 05702b8b6ea73fecd04dc5cc4b26ad1d46fa8850
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 23:37:34 2007 +0100

    [cairo-pdf-surface] Free the clip path on error.
    
    If we fail to add the clip path to the current group, destroy it.

 src/cairo-pdf-surface.c |   14 +++++++++++---
 1 files changed, 11 insertions(+), 3 deletions(-)

commit 8fa5f638a5f8eee4f9efe267ede20344fc7bd4e2
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 23:36:52 2007 +0100

    [cairo-pdf-surface] Restore old_group for failed emit_meta_surface().
    
    Ensure we restore the surface->current_group if we encounter an error
    during _cairo_pdf_surface_emit_meta_surface() lest we leak the
    current_group array.

 src/cairo-pdf-surface.c |   27 ++++++++++++++++-----------
 1 files changed, 16 insertions(+), 11 deletions(-)

commit 8eb9fcf67336a8e4f95366956ae6f1880af4a93e
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Wed Oct 10 14:05:22 2007 -0700

    [win32] mask win32 printing vertex colors with 0xff00 per docs
    
    The range for the vertex color structures is 0x0000 .. 0xff00; I
    think that this is an error in the docs, but strip out the low bits
    just in case.

 src/cairo-win32-printing-surface.c |   11 +++++++----
 1 files changed, 7 insertions(+), 4 deletions(-)

commit 3545ebc1357969616e2f4fa6b36565f211ea36b3
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Wed Oct 10 14:01:30 2007 -0700

    Fix win32 printing surface copyright notice
    
    Bad copy-and-paste of license.

 src/cairo-win32-printing-surface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 0b65c301a72836f46cdcda8b8fa1e995100c7727
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 23:17:42 2007 +0100

    [Makefile.am] Change lcov-clean to use more portable constructs.
    
    Replace xargs and rm with the binaries found by configure and drop the
    passing of NUL-terminated strings as that is a GNU extension.

 Makefile.am |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit b8d7d62b08576364c8c402490b6f5e4a1472d5d8
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 23:12:52 2007 +0100

    Fix some trivial syntax warnings for -ansi.
    
    gcc -ansi -pedantic gives a few syntax warnings, principally for use of
    '//' comments and a comma at the end of enumerators. Apply these
    corrections as they are trivial.

 configure.in                     |    2 +-
 src/cairo-directfb-surface.c     |   16 ++++++++--------
 src/cairo-meta-surface-private.h |    2 +-
 src/cairo-type1-fallback.c       |    2 +-
 src/cairo-types-private.h        |    7 +++----
 src/cairoint.h                   |    5 +++++
 6 files changed, 19 insertions(+), 15 deletions(-)

commit 7e6ac74de17cf82f224d9f5fad3ad60e92d7690b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 10 14:00:56 2007 +0100

    [win32] Clean up compiler warnings.
    
    Fix up a few instances of unused status returns.

 src/cairo-win32-font.c             |   89 ++++++++++++++++++++----------------
 src/cairo-win32-printing-surface.c |   26 +++++++----
 src/cairo-win32-surface.c          |   24 ++++------
 3 files changed, 76 insertions(+), 63 deletions(-)

commit bee05467a5f398eaaaa8d79b3ff0a8b119856143
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 10 12:32:16 2007 +0100

    [configure.in] Initialise test_svg.
    
    Set test_svg to no prior for checking for SVG availability so that the
    printed summary is correct if the user explicitly disables the SVG
    surface on the configure command line.

 configure.in |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 785cb5b7e11a2786b60a995c43e9ee411ec5ec2d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 16:58:46 2007 +0100

    [cairo-image-surface] Dead code elimination.
    
    Remove an unreachable return and unused variable - tidy up after
    a bad merge.

 src/cairo-image-surface.c |    3 ---
 1 files changed, 0 insertions(+), 3 deletions(-)

commit 2268c5907ce80fe40d54ccfac8435ee5e22d36de
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 13:23:34 2007 +0100

    [cairo-glitz-surface] Propagate errors from set_image().
    
    Propagate errors from _cairo_glitz_surface_set_image().

 src/cairo-glitz-surface.c |   28 ++++++++++++++++++++--------
 1 files changed, 20 insertions(+), 8 deletions(-)

commit 4958789b9e8bf531259b3d1ea27887a8319f7696
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 12:49:08 2007 +0100

    [cairo-xlib-surface] Propagate error from _draw_image_surface() to surface.
    
    Instead of simply ignoring the error that may occur when we upload the
    destination image to the xlib surface (via XPutImage) record the error
    on the xlib surface.

 src/cairo-xlib-surface.c |    8 +++++---
 1 files changed, 5 insertions(+), 3 deletions(-)

commit 9c65efeeb108c39e6f55c9247e7d11bfea35cb66
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 11:51:48 2007 +0100

    [boilerplate-test-surfaces] Check show page for errors.
    
    Check that cairo_surface_show_page() did not generate any errors before
    reading back the image buffer and saving it as a png.

 boilerplate/cairo-boilerplate-test-surfaces.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit caf04b1bb89c1a7668e36d5f334765a2323bd564
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 11:22:46 2007 +0100

    [cairo-cff-subset] Propagate error status from failed append_copy().
    
    Add a couple of missing status checks for the result of
    cff_index_append_copy().

 src/cairo-cff-subset.c |   16 ++++++++++------
 1 files changed, 10 insertions(+), 6 deletions(-)

commit ef275cd65a9f20a8a3b1fb3883aff0cc8a3bf401
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 11:19:45 2007 +0100

    [test-meta-surface] Propagate error from show_page().
    
    Add a missing error propagation for _test_meta_surface_show_page().

 src/test-meta-surface.c |    8 ++++++--
 1 files changed, 6 insertions(+), 2 deletions(-)

commit 7758e56d0c96fd113a12b2adc92c783e962feebf
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 11:16:40 2007 +0100

    [cairo-hull] Remove a couple of redundant status returns.
    
    Those two functions unconditionally returned success, so change the
    return to void.

 src/cairo-hull.c |   10 +++-------
 1 files changed, 3 insertions(+), 7 deletions(-)

commit 1dabfc2b271a57b4eaa13922a031ccd38a586dd1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 11:15:27 2007 +0100

    [cairo-clip] Propagate error status from clip_intersect_path().
    
    Propagate the error status (filtering out UNSUPPORTED) from
    intersect_path() when reapplying the clip path during a deep copy.

 src/cairo-clip.c |   51 +++++++++++++++++++++++++++++++--------------------
 1 files changed, 31 insertions(+), 20 deletions(-)

commit 32b78fffc3b8441029ee6b48762a7d0c06bb44a8
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 11:08:58 2007 +0100

    [cairo-traps] Simplify the status interaction of traps_grow().
    
    Simply return the error status from the traps_grow() function rather
    than having an assignment in the return function and then immediately
    another assignment of the error to the status member at its callsite.

 src/cairo-traps.c |   11 +++--------
 1 files changed, 3 insertions(+), 8 deletions(-)

commit 66563eddd8ba2610fa59341b9337a30533e70d56
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Oct 9 09:28:35 2007 +0100

    [cairo-pdf-surface] Check status return after emit_meta_pattern().
    
    Add the missing status propagation.

 src/cairo-pdf-surface.c |    8 ++++++--
 1 files changed, 6 insertions(+), 2 deletions(-)

commit be7d1f0f8f84ddac9e8c7dda4aa39f88806a5e39
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Oct 9 14:27:53 2007 -0700

    Simplify CAIRO_REFERENCE_COUNT_INVALID macro
    
    MSVC doesn't like the previous anonymous structure/cast, so simplify
    to just a bare {} structure for use as an initializer.

 src/cairo-reference-count-private.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 712c3cda44d7023316b93a1241e66aabde15d668
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Oct 9 13:56:51 2007 -0700

    [win32] reduce GDI object usage
    
    Only create region objects if they're necessary; this significantly reduces
    the number of GDI objects in use by cairo surfaces.

 src/cairo-win32-surface.c |  159 +++++++++++++++++++++++++--------------------
 1 files changed, 89 insertions(+), 70 deletions(-)

commit c99d33b10e84883ade1402c3c1d1efdb4b46f66e
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Oct 2 10:54:44 2007 -0700

    [win32] return a nil surface, not NULL
    
    Missed an error return

 src/cairo-win32-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 4dbf495515d6de933de7f567b935c5fdceed5f6f
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Oct 2 10:48:59 2007 -0700

    [win32] report error correctly if CreateCompatibleBitmap fails
    
    These errors were being dropped on the floor, leading to
    rendering errors in out of video memory conditions.

 src/cairo-win32-surface.c |   20 +++++++++++++++++++-
 1 files changed, 19 insertions(+), 1 deletions(-)

commit 61ba63f3a0947bc89310f04e9bc1694fb6451c11
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Fri Sep 21 11:18:17 2007 -0700

    [win32] remove ignore_operators flag from win32 printing surface
    
    Remove the ignore_operators fallback-avoiding workaround; if apps
    want that same behaviour, they'll have to implement it themselves
    by taking care when calling cairo_set_operator().

 src/cairo-win32-printing-surface.c |   16 ++++------------
 src/cairo-win32-private.h          |    5 -----
 src/cairo-win32.h                  |    3 ++-
 3 files changed, 6 insertions(+), 18 deletions(-)

commit b12ed375cf7ad02a30324616e121a1e9ab8998cb
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Oct 9 15:54:58 2007 -0400

    [ChangeLog.mk] Fix changelog generation rules
    
    Previously it was trying to get logs of 1.2.0..1.4 while I really meant
    was 1.2.0..1.4.0.  It was a simple typo.

 ChangeLog.mk |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit cbc4087a40aa7c6039ddadfca2a9876cb14e1bc6
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Oct 6 19:18:31 2007 +0930

    Type1 subset: Add check for CFF fonts

 src/cairo-type1-subset.c |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

commit a1633df6eebd9b1252d832c7a70cea6150c818d3
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 17:21:00 2007 +0100

    [cairo-scaled-font-subsets] Increment the sub_font counter after insertion.
    
    Do not modify the parent subsets->num_sub_font until after we have
    successfully created the sub_font and inserted it into the hash table.

 src/cairo-scaled-font-subsets.c |   24 +++++++++++++++---------
 1 files changed, 15 insertions(+), 9 deletions(-)

commit cf2f994a319da1230c5d53f3dd81e7715e44a162
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 17:15:29 2007 +0100

    [cairo-paginated-surface] Propagate backend errors to the surface.
    
    If we call a srface backend function directly, then it our
    responsibility to propagate any fatal errors to the surface.

 src/cairo-paginated-surface.c |   57 ++++++++++++++++++++++++----------------
 1 files changed, 34 insertions(+), 23 deletions(-)

commit 3da62fdd2848bd9d06b83534adfee2afa17828ba
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 13:41:39 2007 +0100

    [cairo-xlib-display] Rescan the displays list during shutdown.
    
    As we drop the list mutex whilst calling the hooks during the
    XCloseDisplay callback, we must rescan the list when we reacquire the
    mutex in order to remove the display from the list.

 src/cairo-xlib-display.c |   48 +++++++++++++++++++++++++--------------------
 1 files changed, 27 insertions(+), 21 deletions(-)

commit 737cbd25a6cb0bec87563926ad644da019fc9800
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 13:03:47 2007 +0100

    [cairo-ps-surface] Cleanup ps surface after creation failure.
    
    If we fail to create the paginated wrapper for the ps surface, cleanup
    the resources allocated for the surface.

 src/cairo-ps-surface.c |   17 +++++++++++------
 1 files changed, 11 insertions(+), 6 deletions(-)

commit 31b52779bad4122d101cdffdb03153baf6cd011e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 12:55:13 2007 +0100

    [cairo-boilerplate-xlib] Cleanup fallback after creation failure.
    
    Cleanup the local resource if we fail to create the X window and
    surface for the xlib fallback test target.

 boilerplate/cairo-boilerplate-xlib.c |    9 +++++++--
 1 files changed, 7 insertions(+), 2 deletions(-)

commit b210bea6c1867ef9d5c344747d17ca216f6071bd
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 12:45:36 2007 +0100

    [cairo-pdf-surface] Check for pdf_resource_t allocation failure.
    
    Check that the resources are actually allocated or propagate the error.

 src/cairo-pdf-surface.c |   12 ++++++++++++
 1 files changed, 12 insertions(+), 0 deletions(-)

commit 5ac7ba9821cba076d7f53f6b8836a8619661018c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 12:16:23 2007 +0100

    [cairo-pdf-surface] Destroy local resources on failed surface creation.
    
    During _cairo_pdf_surface_create_for_stream_internal() destroy all
    locally allocated resources and the output stream if we fail to create
    the pdf surface or its paginated wrapper.

 src/cairo-pdf-surface.c |   27 +++++++++++++++++++--------
 1 files changed, 19 insertions(+), 8 deletions(-)

commit 63ddfa077c498780d46f752ec7f255b143c9f692
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 12:08:40 2007 +0100

    [cairo-pdf-surface] Propagate error status.
    
    Add a few missing propagations of error status.

 src/cairo-pdf-surface.c |   45 ++++++++++++++++++++++++++++++++++-----------
 1 files changed, 34 insertions(+), 11 deletions(-)

commit f1b6e2735c48d5a54190068c038047942f40f1d1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 11:59:13 2007 +0100

    [cairo-ps-surface] Propagate errors from emit_pattern().
    
    Do not discard the error status from _cairo_ps_surface_emit_pattern(),
    but propagate it back to the caller.

 src/cairo-ps-surface.c |   21 ++++++++++++++++-----
 1 files changed, 16 insertions(+), 5 deletions(-)

commit 709f3160368417d9a9a78974b16d93ec3e5e3c14
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 17:37:05 2007 +0100

    Cleanup a couple of warnings for use of uninitialized statuses.
    
    The compiler spotted a couple of potential uses of an uninitialized
    status variable - apply the obvious fixes.

 src/cairo-svg-surface.c  |    2 +-
 src/cairo-type1-subset.c |    4 +++-
 2 files changed, 4 insertions(+), 2 deletions(-)

commit 2f22510e22237283869fb2e23585504077566adf
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 16:23:12 2007 +0100

    [cairo-xlib] Initialize the global mutexes.
    
    The xlib surface creation routines will eventually attempt to lock the
    global _cairo_xlib_display_mutex. Under the default environment this is
    a non-issue as the CAIRO_MUTEX_INITIALIZE/FINALIZE become no-ops under
    pthreads. However, for the sake of correctness (i.e. to silence the
    lockdep debugger!) insert a call to initialize the global mutexes at the
    start of the public entry points.

 src/cairo-xlib-surface.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit d2557cd5eec7e51496d6b1b57899b2a028898a7c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 00:57:38 2007 +0100

    [test-paginated] Free resources if fail to create the test surface.
    
    Ensure that all the locally allocated resources are freed if we fail
    to allocate the paginated test surface.

 src/test-paginated-surface.c |   12 ++++++++++--
 1 files changed, 10 insertions(+), 2 deletions(-)

commit 60ffeecd4888fdf824b4095c945e1b27e05c0e1d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 00:56:11 2007 +0100

    [test-surfaces] Mark the test backend as static.
    
    There is no need to export the test surface backends, so mark them
    static.

 src/test-fallback-surface.c |    4 ++--
 src/test-meta-surface.c     |    4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 6598973661490ce90b9f42155d8397af491b90c9
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 10:23:13 2007 +0100

    [cairo-scaled-font-subset] Propagate errors during collection.
    
    Propagate the errors encountered whilst iterating over the scaled font
    subsets ie _cairo_scaled_font_subsets_foreach_scaled() and co.

 src/cairo-pdf-surface.c                 |   20 ++++++++++++--------
 src/cairo-ps-surface.c                  |   27 +++++++++++++++++++--------
 src/cairo-scaled-font-subsets-private.h |    2 +-
 src/cairo-scaled-font-subsets.c         |   20 ++++++++++++++++----
 src/cairo-svg-surface.c                 |    4 +++-
 5 files changed, 51 insertions(+), 22 deletions(-)

commit 3a2dd9d33686d6a6d1549965cacf48a7f401c086
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 10:10:16 2007 +0100

    [cairo-png] Markup a couple of original error sites with _cairo_error().
    
    Add the _cairo_error() markup to the original error sites within the png
    read/write functions.

 src/cairo-png.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 81243ee7ef1c3fdf3d571778c414adb64e05fa9d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 09:57:56 2007 +0100

    [cairo-scaled-font] Mask cannot be NULL so remove redundant check.
    
    We either generate a mask for the glyphs or throw an error and bypass
    the check, so at that point mask can never be NULL and we do not need
    the test.

 src/cairo-scaled-font.c |   21 +++++++++------------
 1 files changed, 9 insertions(+), 12 deletions(-)

commit f3d921baca02af4db5f8f1743f32e800d2f492bc
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 09:53:36 2007 +0100

    [cairo-scaled-font] Destroy the zombie font.
    
    If we do not transfer the font to the holdovers array (because it has
    been removed from the cache and left in a zombie state), destroy it.

 src/cairo-scaled-font.c |   46 ++++++++++++++++++++++++----------------------
 1 files changed, 24 insertions(+), 22 deletions(-)

commit 41aab58f3ae044f1baf668363376532381270ff4
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 09:44:29 2007 +0100

    [cairo-surface] Add the usual guards to the API entry point.
    
    Add the checks for unmodifiable surfaces (snapshots, finished and error) to
    cairo_surface_set_fallback_resolution.

 src/cairo-surface.c |   12 ++++++++++++
 1 files changed, 12 insertions(+), 0 deletions(-)

commit f3ae783c9c81106bdb3aa2d15b848d131c39cd93
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 09:42:23 2007 +0100

    [cairo-surface-fallback] Release the acquired image on error.
    
    Add _cairo_surface_release_source_image() to the error paths.

 src/cairo-surface-fallback.c |   11 +++++++----
 1 files changed, 7 insertions(+), 4 deletions(-)

commit 29a5aae958fd9c6a8ec71326c7dad679c0bf5938
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 09:39:20 2007 +0100

    [cairo-type1-fallback] Propagate error from closing the stream.
    
    Propagate the error from destroying the font and closing the output stream.

 src/cairo-type1-fallback.c |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

commit dd0f2d851cd4c4b2bab05668800e5379712f8ac6
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 15:22:13 2007 +0100

    [cairo-atomic] Hide compiler warnings for _cairo_status_set_error().
    
    gcc treats cairo_status_t as an unsigned integer and so generates a
    warning when passing it address as signed integer pointer to
    _cairo_atomic_int_cmpxchg(). Use an ugly cast to hide the warning and
    similarly to hide the warning about the unused result.

 src/cairo-atomic-private.h |    8 ++++++--
 1 files changed, 6 insertions(+), 2 deletions(-)

commit 91d18eefe7be6ad3d1fa951c7424d5843e4718f9
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 15:16:28 2007 +0100

    [cairo-type1-subset] Propagate error status (correctly!)
    
    Adrian Johnson pointed out a couple of mistakes in my previous attempt,
    535e7c161b907292eac098b6b4305373558948df, to ensure propagation of errors
    throughout the generation of the type1 subset.
    
    This time the status member of the cairo_type1_font_subset_t is removed
    in favour of simply return the error status from each function. This
    completely avoids the issue of whether we overwrite a pre-existing error
    status and confustion of status returns and the status member. The
    removal of the status from the structure is possible due to its
    short-lived nature - it is not exposed outside of the
    _cairo_type1_subset_init() function, and is not shared by any other
    piece of code.

 src/cairo-type1-subset.c |  293 +++++++++++++++++++++++-----------------------
 1 files changed, 146 insertions(+), 147 deletions(-)

commit bd2245f8b87d85f5ea61200838c10de70e776cf5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Oct 5 00:45:00 2007 +0100

    [cairo-svg-surface] Review error propagation.
    
    Ensure that the error status is propagated and all local resources
    are freed on the error path.

 src/cairo-svg-surface.c |  374 ++++++++++++++++++++++++++++++++++-------------
 1 files changed, 271 insertions(+), 103 deletions(-)

commit 853b29c56fdb50c627b27fc3a767300c7551dba0
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 23:30:21 2007 +0100

    [cairo-pdf-surface] Add some missing error propagation.
    
    Add a couple of returns where the status was being assigned but not
    checked.

 src/cairo-pdf-surface.c |   18 ++++++++++++++----
 1 files changed, 14 insertions(+), 4 deletions(-)

commit 323511088d0c9057c1b0fa5e7aacda5e44e2e139
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 23:22:49 2007 +0100

    [cairo-pdf-surface] Propagate errors from close_stream.
    
    Propagate the status return from _cairo_pdf_surface_close_stream().

 src/cairo-pdf-surface.c |   13 +++++++++----
 1 files changed, 9 insertions(+), 4 deletions(-)

commit 0e3f5caf9f0bbdb5acf34ae1b92eab32bf08acbf
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 23:18:33 2007 +0100

    [cairo-pdf-surface] Propagate errors during pattern selection.
    
    Propagate error from _cairo_pdf_surface_select_pattern ().

 src/cairo-pdf-surface.c |   34 ++++++++++++++++++++++++++--------
 1 files changed, 26 insertions(+), 8 deletions(-)

commit 7940e39c1820b87c5b96dec6bc59eab97be4a793
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 23:15:21 2007 +0100

    [cairo-pdf-surface] Propagate errors from opening/closing groups.
    
    Propagate the any error encountered during _cairo_pdf_surface_open_group
    and friends.

 src/cairo-pdf-surface.c |  193 +++++++++++++++++++++++++++++++++++++----------
 1 files changed, 152 insertions(+), 41 deletions(-)

commit 7601939a6524ad97a333fef910f3b5e69c46776c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 23:07:36 2007 +0100

    [cairo-deflate-stream] Return the nil stream if creating from an error stream.
    
    If _cairo_deflate_stream_create() is passed a stream in the error state,
    return a stream also in the error state, namely the _cairo_output_stream_nil.

 src/cairo-deflate-stream.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit dbbcb5c26fba77d2a828b253c97e4770b81cf90b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 21:18:47 2007 +0100

    [Makefile] Correct parameters to lcov reset.
    
    lcov uses -z to zero its counters, not --reset.

 Makefile.am |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 717dcd1a2c109f48f0a419a5178fc58d5d4f9a2d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 21:17:31 2007 +0100

    [cairo-pdf-surface] Propagate resource allocation failure.
    
    Propagate failure of _cairo_pdf_surface_new_object().

 src/cairo-pdf-surface.c |  163 +++++++++++++++++++++++++++++++++++++++++++++-
 1 files changed, 159 insertions(+), 4 deletions(-)

commit 8fb40aee97fdb3ae2cbbfa5c6a350c7b8b030005
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 19:20:35 2007 +0100

    [cairo-image-surface] Check for errors whilst cloning.
    
    After attempting to clone an image, check the context status and return
    the nil surface if there was an error.

 src/cairo-image-surface.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

commit b61931640d384707a6fc48f9ba4a4f2ddf675c32
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 19:12:10 2007 +0100

    [cairo-ps-surface] Check the creation of output streams.
    
    Check for allocation errors during the creation of the output streams.

 src/cairo-ps-surface.c |   18 ++++++++++++++++--
 1 files changed, 16 insertions(+), 2 deletions(-)

commit 353c2ab5c0e10f267a1adf3957b5d6af4e6a2e29
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 19:10:42 2007 +0100

    [cairo-output-stream] Guard against destroying the nil streams.
    
    Add a guard to return early if we attempt to call
    _cairo_output_stream_destroy() on the nil cairo_output_stream_t streams.

 src/cairo-output-stream.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit 7cc7bf09c1a61f407fdb054640ebf24039f985db
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 18:52:50 2007 +0100

    [cairo-meta-surface] Propagate errors during replay to the surface.
    
    Store any fatal errors raised during the replay on the surface object.

 src/cairo-meta-surface.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit 042821b566daf4aa17d662e7422d1b98858954d7
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 20:05:58 2007 +0100

    [cairo-surface] Propagate fatal errors to the surface.
    
    Store errors raised by the backend on the surface.

 src/cairo-surface.c |  131 ++++++++++++++++++++++++++++-----------------------
 1 files changed, 72 insertions(+), 59 deletions(-)

commit 535e7c161b907292eac098b6b4305373558948df
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 18:45:17 2007 +0100

    [cairo-type1-subset] Do not mask error returns.
    
    When propagating errors, check that we do not overwrite a pre-existing
    error.

 src/cairo-type1-subset.c |  123 ++++++++++++++++++++++++++++++----------------
 1 files changed, 81 insertions(+), 42 deletions(-)

commit bb8d4c0b14ec175637f57a3b51c4997c0be12a0f
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 18:33:24 2007 +0100

    [cairo-truetype-subset] Do mask error status returns.
    
    Be careful not to overwrite existing the error status when propagating
    errors and to not blindly return INT_STATUS_UNSUPPORTED from
    load_truetype_table() as this will mask fatal errors.

 src/cairo-truetype-subset.c |  363 ++++++++++++++++++++++++++-----------------
 1 files changed, 219 insertions(+), 144 deletions(-)

commit 37fd0d8967df21695d6536af1d7aedbeef2d2449
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 17:12:26 2007 +0100

    [cairo-cff-subset] Propagate errors and review error paths.
    
    Ensure that errors get duly propagated back to the caller and all
    locally allocated resources are freed along error paths.

 src/cairo-cff-subset.c |  291 ++++++++++++++++++++++++++++++++++--------------
 1 files changed, 209 insertions(+), 82 deletions(-)

commit add0959328117e2023db0ba2432ed29ecb93275e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 17:00:26 2007 +0100

    [cairo-debug] Finalize mutexes along with other static data.
    
    Initialize (so repeated calls of cairo_debug_reset_static_data() is
    safe) and finalize the mutexes with the reset of the static data.

 src/cairo-debug.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

commit a4f20610afd18d58a964dbe84cc90c5723b2996d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 16:37:44 2007 +0100

    [cairo] Protect the getters when operating on the nil object.
    
    Put a guard that checks the context's status at the start of each
    getter that prevents the function from trying to dereference NULL state.
    Use the status, as opposed to the invalid reference count, for
    consistency with the existing guards on some of the getters.

 src/cairo.c |   51 +++++++++++++++++++++++++++++++++++++++++++++++++--
 1 files changed, 49 insertions(+), 2 deletions(-)

commit 80c06f4539962231df771b38e64834a238f410dd
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 16:16:41 2007 +0100

    [cairo-scaled-font] Don't hold onto to a dropped font.
    
    Mark fonts that have been removed from the cache due to an error on a
    shared object and do not put them into the holdovers array.

 src/cairo-scaled-font.c |    8 ++++++--
 1 files changed, 6 insertions(+), 2 deletions(-)

commit 6e93941a7605a3958269de195dc16f255dda7bfd
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 16:04:49 2007 +0100

    [cairo-scaled-font] Acquire mutex around _cairo_scaled_font_glyph_path().
    
    All calls that manipulate the scaled_font->cache must hold its mutex.

 src/cairo-gstate.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 261971a3fb9c10c267cced53a440161f1acb4b5d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 16:03:12 2007 +0100

    [cairo-gstate] Fix resource leaks on error paths.
    
    Ensure that all locally allocated (or referenced) resources are freed
    if we later encounter an error.

 src/cairo-gstate.c |   22 ++++++++++++++--------
 1 files changed, 14 insertions(+), 8 deletions(-)

commit 4e44d54f3e99b65f5e80485b22d31890ea3d6561
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 15:58:21 2007 +0100

    [cairo-matrix] Check whether a matrix is invertible before use.
    
    Provide an early check as to whether the font matrix is invertible.

 src/cairo-gstate.c      |    3 +++
 src/cairo-matrix.c      |   10 ++++++++++
 src/cairo-scaled-font.c |    3 +++
 src/cairoint.h          |    3 +++
 4 files changed, 19 insertions(+), 0 deletions(-)

commit 528da4e5e131fe385a60431eb6656a542b27c70f
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 15:50:40 2007 +0100

    [cairo-scaled-font] Freeze the font cache whilst iterating over glyphs.
    
    Prevent glyph cache removal whilst iterating over a glyph string.

 src/cairo-scaled-font.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit 4b81eeb20ebe070692ef8099c00de3829da8bf69
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 15:46:13 2007 +0100

    [cairo-scaled-font] Destroy the mask on the error path.
    
    Do not leak the mask if we encounter an error whilst tracing.

 src/cairo-scaled-font.c |   17 ++++++++++-------
 1 files changed, 10 insertions(+), 7 deletions(-)

commit d0b1308cd73a6b3602e5414abf03a3bdf8d2d001
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 15:43:09 2007 +0100

    [cairo-scaled-font] Store fatal errors on the cairo_scaled_font_t.
    
    Ensure that all fatal errors raised whilst using the font are stored on
    the font.

 src/cairo-scaled-font.c |   35 +++++++++++++++++++++++------------
 1 files changed, 23 insertions(+), 12 deletions(-)

commit 4c32e6bfde5d613e0eeef407b9b50c557b1878e3
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 15:31:25 2007 +0100

    [cairo-scaled-font] Return the error status from _cairo_scaled_font_set_error()
    
    Similar to the other _cairo_*_set_error() return the error status.

 src/cairo-ft-font.c     |    4 ++--
 src/cairo-scaled-font.c |   18 +++++++++---------
 src/cairoint.h          |    2 +-
 3 files changed, 12 insertions(+), 12 deletions(-)

commit 06ae5f1ba3bb679c145d2f7e9ed8c244abf7ff17
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 15:26:09 2007 +0100

    [cairo-font-face] Set the error on the font.
    
    Similar to the other shared objects, store fatal errors on the shared
    font_face. And do not return a cached reference to an object in an
    error state.

 src/cairo-font-face.c   |   46 +++++++++++++++++++++++++++++++++++++---------
 src/cairo-scaled-font.c |    1 +
 src/cairoint.h          |    4 ++++
 3 files changed, 42 insertions(+), 9 deletions(-)

commit 4cffdf2681ba254587bd774ea49718e71535b067
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 14:59:55 2007 +0100

    [cairo-ft-font] Always call _cairo_ft_unscaled_font_fini ().
    
    The _cairo_ft_unscaled_font_fini() was skipped during the destroy for
    fonts generated by cairo_ft_font_face_create_for_ft_face(). However
    this causes a mutex to be 'leaked' for each font.

 src/cairo-ft-font.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit de1f92ae14bfc4d74d8df88ae81d7b90dd6739f0
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 14:51:16 2007 +0100

    [cairo-output-stream] Propagate error status when copying streams.
    
    During _cairo_memory_stream_copy(), if set, copy the incoming error over
    to the destination stream and return early.

 src/cairo-output-stream.c |   12 ++++++++++--
 1 files changed, 10 insertions(+), 2 deletions(-)

commit 2c256f292fc4a9fd8414e29c4df32d347e360900
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 14:35:08 2007 +0100

    [cairo-error] Another _cairo_error (CAIRO_STATUS_SUCCESS)!
    
    Despite double checking, I still ended up converting one too many
    status values.

 src/cairo-truetype-subset.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit bed8239f03773ad1584c8ba48ceb0b34bbe69453
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 13:15:46 2007 +0100

    [cairo-error] Clean up all the warnings and missing _cairo_error() calls.
    
    Every time we assign or return a hard-coded error status wrap that value
    with a call to _cairo_error(). So the idiom becomes:
        status = _cairo_error (CAIRO_STATUS_NO_MEMORY);
    or
        return _cairo_error (CAIRO_STATUS_INVALID_DASH);
    
    This ensures that a breakpoint placed on _cairo_error() will trigger
    immediately cairo detects the error.

 src/cairo-analysis-surface.c    |    4 +-
 src/cairo-array.c               |    9 +--
 src/cairo-atsui-font.c          |   18 +++---
 src/cairo-base85-stream.c       |    2 +-
 src/cairo-bentley-ottmann.c     |   22 +++-----
 src/cairo-cache.c               |    4 +-
 src/cairo-cff-subset.c          |  122 +++++++++++++++------------------------
 src/cairo-clip.c                |   18 +++---
 src/cairo-deflate-stream.c      |    2 +-
 src/cairo-directfb-surface.c    |   49 +++++++---------
 src/cairo-font-face.c           |    6 +-
 src/cairo-font-options.c        |    4 +-
 src/cairo-ft-font.c             |  111 ++++++++++++++---------------------
 src/cairo-glitz-surface.c       |   89 ++++++++++++----------------
 src/cairo-gstate.c              |   37 +++++-------
 src/cairo-hash.c                |   10 +--
 src/cairo-hull.c                |    2 +-
 src/cairo-image-surface.c       |   47 ++++++---------
 src/cairo-lzw.c                 |    6 +-
 src/cairo-matrix.c              |    4 +-
 src/cairo-meta-surface.c        |   48 ++++++----------
 src/cairo-os2-surface.c         |   24 ++++----
 src/cairo-output-stream.c       |   18 +++---
 src/cairo-paginated-surface.c   |    8 +--
 src/cairo-path-fixed.c          |   14 ++--
 src/cairo-path-stroke.c         |    6 +-
 src/cairo-path.c                |   16 +++---
 src/cairo-pattern.c             |   65 +++++++++-----------
 src/cairo-pdf-surface.c         |   62 ++++++++-----------
 src/cairo-pen.c                 |   19 ++----
 src/cairo-png.c                 |   24 ++++----
 src/cairo-polygon.c             |    6 +-
 src/cairo-ps-surface.c          |   63 +++++++++-----------
 src/cairo-quartz-surface.c      |   15 ++---
 src/cairo-region.c              |   22 +++----
 src/cairo-scaled-font-subsets.c |   20 +++----
 src/cairo-scaled-font.c         |   16 ++---
 src/cairo-skiplist.c            |    2 +-
 src/cairo-spline.c              |    6 +-
 src/cairo-stroke-style.c        |    6 +-
 src/cairo-surface-fallback.c    |   10 +--
 src/cairo-surface.c             |   82 ++++++++++++++------------
 src/cairo-svg-surface.c         |   24 +++-----
 src/cairo-traps.c               |    9 +--
 src/cairo-truetype-subset.c     |   43 ++++++--------
 src/cairo-type1-fallback.c      |   27 ++++-----
 src/cairo-type1-subset.c        |   30 +++++-----
 src/cairo-unicode.c             |   20 +++----
 src/cairo-win32-font.c          |   40 ++++++------
 src/cairo-win32-surface.c       |   23 ++++----
 src/cairo-xcb-surface.c         |   50 +++++++---------
 src/cairo-xlib-display.c        |    2 +-
 src/cairo-xlib-surface.c        |   88 +++++++++++++---------------
 src/cairo.c                     |    8 +-
 src/cairoint.h                  |    8 ++-
 src/test-fallback-surface.c     |    2 +-
 src/test-meta-surface.c         |    6 +-
 src/test-paginated-surface.c    |    6 +-
 58 files changed, 648 insertions(+), 856 deletions(-)

commit d90d4bb6b99e0a912650234e28d097ea76c1cecc
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 11:30:13 2007 +0100

    [cairo-error] Make _cairo_error() return the error status.
    
    As pointed out by Jeff Muizelaar, this allows for more concise code, as
        _cairo_error(CAIRO_STATUS_NO_MEMORY)
        return CAIRO_STATUS_NO_MEMORY
    can become
        return _cairo_error(CAIRO_STATUS_NO_MEMORY);

 src/cairo.c    |    6 +++++-
 src/cairoint.h |    2 +-
 2 files changed, 6 insertions(+), 2 deletions(-)

commit 71120727e190dfaf3ccbe63b3d91d90e36cff6f6
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 11:13:33 2007 +0100

    [cairo-atomic] Use an atomic operation to set the status on a shared resource.
    
    Since the objects can be shared and may be in use simultaneously across
    multiple threads, setting the status needs to be atomic. We use a
    locked compare and exchange in order to avoid overwriting an existing
    error - that is we use an atomic operation that only sets the new status
    value if the current value is CAIRO_STATUS_SUCCESS.

 src/cairo-atomic-private.h |    8 ++++++++
 src/cairo-atomic.c         |   15 +++++++++++++++
 src/cairo-pattern.c        |   17 ++++++++---------
 src/cairo-scaled-font.c    |   13 ++++++-------
 src/cairo-surface.c        |   13 ++++++-------
 src/cairo.c                |   12 +++++-------
 6 files changed, 48 insertions(+), 30 deletions(-)

commit f4356efb64a043e7a459fe77616f3b7c92b25c49
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 09:30:32 2007 +0100

    [malloc/error] Fixup _cairo_error (CAIRO_STATUS_SUCCESS)!
    
    At some point during the blitz, I accidentally wrote
    _cairo_error (CAIRO_STATUS_SUCCESS) and then proceeded to paste it into
    the next 30 error sites! s/CAIRO_STATUS_SUCCESS/CAIRO_STATUS_NO_MEMORY/

 src/cairo-glitz-surface.c |   24 ++++++++++++------------
 src/cairo-gstate.c        |    8 ++++----
 src/cairo-hash.c          |    6 +++---
 src/cairo-hull.c          |    2 +-
 src/cairo-image-surface.c |   12 +++++++-----
 src/cairo-lzw.c           |    4 ++--
 src/cairo-meta-surface.c  |   10 +++++-----
 7 files changed, 34 insertions(+), 32 deletions(-)

commit ef5f460eb1f86a73e016c1150723ae1e70b3b037
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 09:08:46 2007 +0100

    [cairo-path] Check for an empty path in cairo_append_path().
    
    As we now generate empty paths, we must be able to handle empty paths
    in the user facing API. cairo_append_path() has an explicit check, and
    raises an error, for a NULL path->data, so we need to check the
    path->num_data first for empty paths.

 src/cairo.c      |    3 +++
 test/copy-path.c |   15 +++++++++++++++
 2 files changed, 18 insertions(+), 0 deletions(-)

commit 8ad56b308ae8bbecfe9873c21551a6d4b2302420
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Oct 4 00:38:12 2007 +0100

    [malloc/error] Add call to _cairo_error() after a failed malloc.
    
    Blitz all allocations to ensure that they raise a
    _cairo_error(CAIRO_STATUS_NO_MEMORY) on failure.

 src/cairo-array.c               |    6 +++-
 src/cairo-atsui-font.c          |    1 +
 src/cairo-base85-stream.c       |    4 ++-
 src/cairo-bentley-ottmann.c     |   12 +++++--
 src/cairo-cache.c               |    4 ++-
 src/cairo-cff-subset.c          |   72 +++++++++++++++++++++++++++++---------
 src/cairo-clip.c                |    4 ++-
 src/cairo-deflate-stream.c      |    4 ++-
 src/cairo-directfb-surface.c    |   32 ++++++++++++-----
 src/cairo-font-face.c           |    4 ++-
 src/cairo-font-options.c        |   11 ++++--
 src/cairo-ft-font.c             |   13 +++++--
 src/cairo-glitz-surface.c       |   33 ++++++++++++++----
 src/cairo-gstate.c              |   13 +++++--
 src/cairo-hash.c                |    9 ++++-
 src/cairo-hull.c                |    4 ++-
 src/cairo-image-surface.c       |   10 ++++-
 src/cairo-lzw.c                 |    2 +
 src/cairo-meta-surface.c        |   26 +++++++++++---
 src/cairo-output-stream.c       |   21 +++++++++---
 src/cairo-paginated-surface.c   |    4 ++-
 src/cairo-path-fixed.c          |    8 +++-
 src/cairo-path-stroke.c         |    5 ++-
 src/cairo-pattern.c             |    5 ++-
 src/cairo-pdf-surface.c         |   10 ++++-
 src/cairo-ps-surface.c          |   19 +++++++---
 src/cairo-quartz-surface.c      |   14 +++++++
 src/cairo-region.c              |    4 ++-
 src/cairo-scaled-font-subsets.c |   18 +++++++---
 src/cairo-scaled-font.c         |    3 ++
 src/cairo-skiplist.c            |    5 ++-
 src/cairo-spline.c              |    1 +
 src/cairo-stroke-style.c        |    4 ++-
 src/cairo-surface-fallback.c    |    2 +
 src/cairo-surface.c             |    1 +
 src/cairo-traps.c               |    5 ++-
 src/cairo-truetype-subset.c     |   13 ++++++-
 src/cairo-type1-fallback.c      |    7 +++-
 src/cairo-type1-subset.c        |   26 +++++++++++---
 src/cairo-unicode.c             |    8 +++-
 src/cairo-win32-font.c          |    9 ++++-
 src/cairo-win32-surface.c       |    5 ++-
 src/cairo-xcb-surface.c         |   23 ++++++++++---
 src/cairo-xlib-display.c        |    4 ++-
 src/cairo-xlib-surface.c        |   19 ++++++++--
 src/cairo.c                     |    9 ++++-
 src/test-meta-surface.c         |    4 ++-
 47 files changed, 404 insertions(+), 116 deletions(-)

commit 66664596559c55913fb0b9c8784fe8ab862c217b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 3 23:25:10 2007 +0100

    [malloc] Take advantage of calloc() argument checking.
    
    calloc() will check its arguments for integer overflows so it is safer
    not to pre-multiply them.

 src/cairo-ft-font.c       |    4 ++--
 src/cairo-glitz-surface.c |    2 +-
 src/cairo-image-surface.c |    2 +-
 3 files changed, 4 insertions(+), 4 deletions(-)

commit e49bcde27f88e21d5b8037a0089a226096f6514b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 3 23:19:10 2007 +0100

    [malloc] Check for integer overflow when realloc'ing.
    
    Perform similar sanity checks to Vlad's _cairo_malloc_ab() but on the
    arguments to realloc instead.

 src/cairo-array.c          |    4 ++--
 src/cairo-lzw.c            |    6 +++++-
 src/cairo-malloc-private.h |   30 ++++++++++++++++++++++++++----
 src/cairo-path-stroke.c    |    3 ++-
 src/cairo-pattern.c        |    4 +++-
 src/cairo-pen.c            |    3 ++-
 src/cairo-polygon.c        |    3 ++-
 src/cairo-spline.c         |    3 ++-
 src/cairo-traps.c          |    3 ++-
 9 files changed, 46 insertions(+), 13 deletions(-)

commit 8cba73a36c4ec42601388bb9374f3182651bfe60
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 3 22:27:09 2007 +0100

    [cairo-polygon] Add a _cairo_error().
    
    Add a _cairo_error() to an originating error site.

 src/cairo-polygon.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit e767c8b50af578209f1dac3b8f2ae22835e1fee7
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Oct 3 22:26:03 2007 +0100

    [cairo-pen] Add _cairo_error().
    
    Markup a couple of originating error sites with _cairo_error().

 src/cairo-pen.c |   12 +++++++++---
 1 files changed, 9 insertions(+), 3 deletions(-)

commit 7047a091748577754845a6ed7f35837e41e7d5fb
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Wed Oct 3 23:10:15 2007 +0930

    TODO: Remove PDF encoding issues
    
    All PDF font encoding issues are fixed now that TrueType fonts are
    embedded in PDF as CIDFontType2.

 TODO |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

commit 3e70b0a388c04c61816078de058c323774edeb96
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Wed Oct 3 23:01:59 2007 +0930

    ROADMAP: Mark EPS support done

 ROADMAP |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit a4627177663beacd3d15699fee072f7ad2eff4a9
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Wed Oct 3 19:55:05 2007 +0930

    PDF: Fix bug in font resources

 src/cairo-pdf-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit c9a9f1299c2bd5b6a8e53fdb264c233a43e0c44a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Oct 1 17:00:38 2007 +0100

    [cairo-image-surface] Avoid trying to create surfaces with invalid strides.
    
    pixman does not (yet?) support arbitrary strides and will fail to
    generate an image for the data. We misinterpret that failure as a
    CAIRO_STATUS_NO_MEMORY, so instead return CAIRO_STATUS_INVALID_FORMAT
    before attempting to create the pixman image.

 src/cairo-image-surface.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit e241205f0c6d823150cf018c0deb6652dd8b8d02
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Oct 1 16:54:16 2007 +0100

    [cairo-image-surface] Return correct error surfaces.
    
    Avoid returning the "generic" _cairo_surface_nil (which corresponds to
    CAIRO_STATUS_NO_MEMORY) when the user asks us to create a surface with
    an invalid format or content.

 src/cairo-image-surface.c |   65 ++++++++++++++++++++++++++++++++++++++++----
 1 files changed, 59 insertions(+), 6 deletions(-)

commit b4f86638cc4b87bfaf10568ae9beb89626e26613
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Oct 1 17:59:57 2007 +0100

    [cairo-path] Don't raise an error when attempting to create an empty path.
    
    Generate a real empty path structure instead of returning
    _cairo_path_nil, if we have been asked to create an empty path.
    
    (Also add a couple of missing _cairo_error()s and an appropriate test
    case.)
    
    Spotted by Fred Kiefer.

 src/cairo-path.c |   36 ++++++++++++++++++++++++------------
 test/copy-path.c |   17 +++++++++++++++++
 2 files changed, 41 insertions(+), 12 deletions(-)

commit 042c382c094d1ea6f9a5a162d4d1d9ac83413233
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Sep 29 07:55:48 2007 +0930

    CFF Subetting: Fix for #10849
    
    This fixes the problem Apple Preview has with viewing PDFs with CFF
    font subsets.

 src/cairo-cff-subset.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit d837a458b95c0e1866eecaf3688dfa36e7dafe8e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Sep 27 17:45:51 2007 +0100

    [configure] Work-around bad interaction of libtool and lcov
    
    libtool causes the .gcda files to be generated in the .libs/ directory,
    separate from the .c source file. lcov expects them to be in the same
    directory - so massage the lcov.info file to remove the reference to the
    .libs/.
    
    Also separate the target for generating the lcov output, so that it can
    be run independently from triggering the tests. And improve convenience
    of using the other lcov targets.

 Makefile.am |   29 ++++++++++++++++++++---------
 1 files changed, 20 insertions(+), 9 deletions(-)

commit abe1b89da4a2aa255a218103c7a05711d0f73b1c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Sep 27 14:49:30 2007 +0100

    [test/get-path-extents] Test extents of cairo_text_path().
    
    Check that the text path extents match the computed metrics.

 test/get-path-extents.c |   38 ++++++++++++++++++++++++++++----------
 1 files changed, 28 insertions(+), 10 deletions(-)

commit 0618818f7a4a323d2c2d0dd122e08aeaa025b3f3
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Sep 26 14:40:36 2007 +0100

    [test/get-path-extents] Test extents of an arc.
    
    Add the test case from bug 7245,
    https://bugs.freedesktop.org/show_bug.cgi?id=7245.

 test/get-path-extents.c |   24 +++++++++++++++++++-----
 1 files changed, 19 insertions(+), 5 deletions(-)

commit 54d5dccffa402835db57231f7a6cd98d71688359
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Wed Sep 26 22:21:26 2007 +0930

    PDF: Compress pattern and group streams

 src/cairo-pdf-surface.c |   16 +++++++++++-----
 1 files changed, 11 insertions(+), 5 deletions(-)

commit a0a51977f48cc14c442357f472ed20e43c42829c
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Wed Sep 26 22:21:07 2007 +0930

    PDF: Fix bug in font resources when same font is in multiple groups

 src/cairo-pdf-surface.c |   16 +++++++++++-----
 1 files changed, 11 insertions(+), 5 deletions(-)

commit 76b9b1819251c8f3df0a5ada92a501ad83baa5a1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Sep 26 00:41:31 2007 +0100

    [test/create-for-stream] Add the missing cairo_surface_finish().
    
    Moments after pushing the new test case did I realise the issue...
    We do not attempt to write out the surface to the user stream until
    we perform the cairo_surface_destroy() by which point we have lost
    the ability to interrogate the error status. We can avoid this by
    explicitly calling cairo_surface_finish() and then checking the
    error status - and we see that the error is indeed reported
    correctly.
    
    No bug. Nothing to see here. Please move along. (Apart from the
    request for the status to be return from cairo_surface_destroy!)

 test/create-for-stream.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 1e7f0bd4d5148940fe963eb20782bffe5ee735bd
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Sep 26 00:28:47 2007 +0100

    [test/create-for-stream] Add test case for user error propagation.
    
    From bug https://bugs.freedesktop.org/show_bug.cgi?id=7049, we find
    that the error status from the user supplied write function to
    cairo_*_surface_create_for_stream is ignored and not propagated back
    to the surface/context - leading to silent data loss. Incorporate
    the suggested test case, a write function that simply returns
    CAIRO_STATUS_WRITE_ERROR, into create-for-stream.c.

 test/create-for-stream.c |   57 +++++++++++++++++++++++++++++++++++----------
 1 files changed, 44 insertions(+), 13 deletions(-)

commit 1469de5211e84e40490fa612538986768748bd55
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Sep 25 23:35:25 2007 +0100

    [cairo-png] Propagate error from read and write funcs.
    
    Use the png_struct->error_ptr to propagate the error status from the
    user/stdio read and write functions through the png_error() to the
    cairo_surface_write_to_png*() and cairo_surface_read_from_png*()
    functions. From there the error is returned back to the user either
    directly or as the most appropriate error surface.
    
    (Fixes https://bugs.freedesktop.org/show_bug.cgi?id=6909)

 src/cairo-png.c        |   57 +++++++++++++++++++++-----------
 test/create-from-png.c |   84 ++++++++++++++++++++++++++++++++++++++++++-----
 2 files changed, 113 insertions(+), 28 deletions(-)

commit f1d84271d363cc80cdef92ec9cac2cf29783bfe0
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Sep 25 21:58:24 2007 +0100

    [cairo-atomic]  Do not use Intel atomic primitives on i386.
    
    When limiting the target instruction set for compatibility with older
    processors, e.g. -march=i386, the Intel atomic primitives generate a
    call to a non-existent function, __sync_fetch_and_add_4(). To detect
    this scenario change the configure test from AC_TRY_COMPILE to
    AC_TRY_LINK which will then cause Cairo to fall back to using mutexes
    for its atomic operations.

 configure.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 03be41151d06d48d55bc1e172535829ec45a10cf
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Sep 23 21:08:09 2007 +0100

    [cairo-atomic] Rewrite reference counting using atomic ops.
    
    Introduce an opaque cairo_reference_count_t and define operations on it
    in terms of atomic ops. Update all users of reference counters to use
    the new opaque type.

 src/Makefile.am                     |    1 +
 src/cairo-clip-private.h            |   12 +++---
 src/cairo-clip.c                    |   11 +++--
 src/cairo-font-face.c               |   49 ++++++++++------------
 src/cairo-ft-font.c                 |    2 +-
 src/cairo-image-surface.c           |    2 +-
 src/cairo-pattern.c                 |   50 ++++++++++++-----------
 src/cairo-private.h                 |    3 +-
 src/cairo-reference-count-private.h |   66 ++++++++++++++++++++++++++++++
 src/cairo-scaled-font-private.h     |    3 +-
 src/cairo-scaled-font.c             |   77 +++++++++++++++++------------------
 src/cairo-surface-private.h         |    3 +-
 src/cairo-surface.c                 |   33 ++++++++-------
 src/cairo-xlib-display.c            |   42 ++++++++-----------
 src/cairo-xlib-private.h            |    5 +-
 src/cairo-xlib-screen.c             |   12 +++--
 src/cairo.c                         |   23 +++++-----
 src/cairoint.h                      |   27 ++++++------
 18 files changed, 244 insertions(+), 177 deletions(-)

commit 8b6c871c9084739460f1320cd36560a09477a83e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Sep 21 10:45:55 2007 +0100

    [cairo-atomic] Introduce atomic ops.
    
    Test for the availability of the Intel __sync_* atomic primitives and
    use them to define a few operations useful for reference counting -
    providing a generic interface that may be targeted at more architectures
    in the future. If no atomic primitives are available, use a mutex based
    variant. If the contention on that mutex is too high, we can consider
    using an array of mutexes using the address of the atomic variable as
    the hash.

 configure.in                   |   16 ++++++++
 src/Makefile.am                |    2 +
 src/cairo-atomic-private.h     |   81 ++++++++++++++++++++++++++++++++++++++++
 src/cairo-atomic.c             |   79 +++++++++++++++++++++++++++++++++++++++
 src/cairo-mutex-list-private.h |    3 +
 5 files changed, 181 insertions(+), 0 deletions(-)

commit 42de1a0a7f5cc10c2bad98ef69da302ed2a1ca84
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Sep 23 21:00:23 2007 +0100

    Move GCC attributes wrapping into a separate header.
    
    The wrapping of GCC attributes (such as cairo_private) needs to be
    visible to any header file, including those that avoid cairoint.h such
    as cairo-boilerplate. To achieve this we move the pre-processor magic to
    its own header file and include it as required.

 src/Makefile.am                   |    1 +
 src/cairo-cache-private.h         |    1 +
 src/cairo-clip-private.h          |    1 +
 src/cairo-compiler-private.h      |  115 +++++++++++++++++++++++++++++++++++++
 src/cairo-hash-private.h          |    1 +
 src/cairo-mutex-private.h         |    1 +
 src/cairo-output-stream-private.h |    1 +
 src/cairo-region-private.h        |    2 +
 src/cairo-wideint-private.h       |    2 +
 src/cairo-xlib-private.h          |    5 +-
 src/cairoint.h                    |   71 +----------------------
 11 files changed, 131 insertions(+), 70 deletions(-)

commit be327a7b49a62c684e133aad5d5d6adec30b60e6
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Tue Sep 25 23:04:03 2007 +0930

    PDF: Compress the content stream
    
    The content stream compression that was previously implemented was
    inadvertently bypassed when the new stream handling for meta surface
    patterns was implemented.

 src/cairo-pdf-surface-private.h |    4 ++
 src/cairo-pdf-surface.c         |   65 ++++++++++++++++++++++++++++++++------
 2 files changed, 58 insertions(+), 11 deletions(-)

commit 99fd9449c24055fd7b3623157397fe61282e2de0
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Tue Sep 25 21:57:46 2007 +0930

    PDF: Remove duplication from the resource dictionary
    
    The same font identifer was being added the resources every time it
    was referenced.

 src/cairo-pdf-surface.c |    4 +---
 1 files changed, 1 insertions(+), 3 deletions(-)

commit dc23ecb6198f1e28b6096cbef931e15407cc20a8
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Sep 23 21:02:31 2007 +0100

    [cairo-boilerplate] Do not throw an error if an exclude target is not found.
    
    If we fail to exclude a target because it was not in the list of
    targets - job done and no need to throw a tantrum.

 boilerplate/cairo-boilerplate.c |    5 -----
 1 files changed, 0 insertions(+), 5 deletions(-)

commit 4f7c5a5033f41de94a7ea284a64f4afa0900fff1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Sep 23 21:04:36 2007 +0100

    [cairo-region] Call _cairo_error() at original error site.
    
    Before returning a fresh CAIRO_STATUS_NO_MEMORY, remember to call
    cairo_error().

 src/cairo-region.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 45feb13c2689a8f5813e60fb0c2d17e9e02fd4b5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Sep 23 21:34:50 2007 +0100

    [cairo-clip] Avoid a malloc(0).
    
    Avoid a potential allocation of 0 bytes, and a potential NULL leading to an
    incorrect CAIRO_STATUS_NO_MEMORY, when copying an empty clip region.

 src/cairo-clip.c |   36 +++++++++++++++++++++---------------
 1 files changed, 21 insertions(+), 15 deletions(-)

commit 77f1aa78872aa108199afd41247cf21827f7e33a
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 23 17:43:44 2007 +0930

    Add Encapsulated PostScript support
    
    The analysis surface will calculated the tight bounding box for each
    page. A new paginated-surface backend function set_bounding_box() has
    been added for passing the page bounding box to the target surface at
    the end of the analysis phase.
    
    The changes to the PS file when EPS is enabled are:
        - Add EPS header
        - Use tight bounding box instead of page size
        - Use save/restore to ensure PS interpreter is left in the same state

 src/cairo-analysis-surface-private.h |   10 ++-
 src/cairo-analysis-surface.c         |   32 +++++++
 src/cairo-paginated-private.h        |   19 ++++-
 src/cairo-paginated-surface.c        |   15 +++-
 src/cairo-ps-surface-private.h       |    3 +-
 src/cairo-ps-surface.c               |  151 +++++++++++++++++++++++-----------
 6 files changed, 171 insertions(+), 59 deletions(-)

commit beefbdd63864d10924360f41b244de7edf7b5f5b
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 23 14:23:33 2007 +0930

    Add Encapsulated PostScript API

 doc/public/cairo-sections.txt  |    2 +
 src/cairo-ps-surface-private.h |    2 +
 src/cairo-ps-surface.c         |   57 ++++++++++++++++++++++++++++++++++++++++
 src/cairo-ps.h                 |    7 +++++
 4 files changed, 68 insertions(+), 0 deletions(-)

commit b20e08999e2f6e7a72ee75a7c3fd865bf0368794
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 23 11:37:02 2007 +0930

    Truetype Subsetting: Avoid failing when fonts are missing optional tables
    
    Previously, the TrueType subsetting would fail if any of the "cvt",
    "fpgm", or "prep" tables were missing from the source font. However
    these tables are optional and not required in the subsetted font if
    they do not appear in the source font.
    
    The "name" table has been removed from the subsetted font as the
    Type42 specification does not require this table.

 src/cairo-truetype-subset.c |  153 +++++++++++++++++++++++++++++++------------
 1 files changed, 110 insertions(+), 43 deletions(-)

commit 8132b8b417c75388ce4c4671fffddaa44a5d1be0
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Sep 23 02:52:01 2007 +0100

    [type1-subset] only subset ft fonts
    
    If atsui and ft were both enabled, the code crashed trying to subset
    type-1 fonts; fixed by checking if fonts really are ft before using
    them as ft fonts. This is a temporary fix until we support subsetting
    across all font backends.

 src/cairo-type1-subset.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 6020f67f1a49cfe3844c4938d4af24c63c8424cc
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Fri Sep 21 11:02:42 2007 -0700

    Avoid divide-by-zero when trying to allocate a 0-sized array
    
    Fix up the _cairo_malloc_* wrappers to avoid blindly dividing by zero;
    any attempt to allocate a zero-sized chunk of memory will result in
    NULL.

 src/cairo-malloc-private.h |   35 +++++++++++++++++++++++++----------
 1 files changed, 25 insertions(+), 10 deletions(-)

commit c79fc9af334fd6f2d1078071d64178125561b187
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Sep 20 16:01:43 2007 -0700

    Add rgb24-specific reference imag for mask-alpha test

 test/mask-alpha-rgb24-ref.png |  Bin 0 -> 599 bytes
 1 files changed, 0 insertions(+), 0 deletions(-)

commit 59dd59ce8d4c2a35788f3f0baf3409d3a8555744
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 9 22:32:36 2007 +0930

    Add mask-alpha test

 test/.gitignore         |    1 +
 test/Makefile.am        |    1 +
 test/mask-alpha-ref.png |  Bin 0 -> 640 bytes
 test/mask-alpha.c       |   90 +++++++++++++++++++++++++++++++++++++++++++++++
 4 files changed, 92 insertions(+), 0 deletions(-)

commit 12b2ab630c2343c7bd7d885cc0e773023e3d8fa8
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Sep 20 22:51:39 2007 +0930

    PDF: Add support for CAIRO_FORMAT_A8 images

 src/cairo-pdf-surface.c |   44 ++++++++++++++++++++++++++++++++------------
 1 files changed, 32 insertions(+), 12 deletions(-)

commit 8a4adcf5f3c893505a53882a0532a220f79f4409
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Sep 20 08:57:19 2007 +0930

    ROADMAP: Add metadata API

 ROADMAP |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

commit 6e78c6589d4af6291158b7cd9d94e3a80139e279
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Sep 18 19:50:16 2007 -0400

    [ROADMAP] Mark xlib IncludeInferior support done

 ROADMAP |    5 ++---
 1 files changed, 2 insertions(+), 3 deletions(-)

commit d8b0de01d67cdf73d8266a73f54ba1ac42fee3c9
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Sep 18 09:26:05 2007 -0700

    fix trailing whitespace

 src/cairo-surface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 4fd9acc1b321d75623a66d37c0ff299ae06fb98b
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Sep 4 10:30:08 2007 -0700

    [win32] add new win32 printing surface

 src/Makefile.win32 |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit e3c16e15e39d98f96e2ce20e397d88214f5a821e
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Wed Aug 29 16:30:49 2007 -0700

    Make NO_MUTEX really mean no mutexes

 src/cairo-mutex-type-private.h |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit ffc16c4be2fb5a0d214cb186dee52e74dbd584cf
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Wed Aug 29 16:25:58 2007 -0700

    [win32] Add win32 printing surface
    
    Add win32 surface intended for use with printer DCs; GDI will be used
    as much as possible, and the surface will be a paginated surface
    that supports fine-grained fallback.
    
    (Original work from Adrian Johnson; additional fixes by me.)

 src/Makefile.am                    |    2 +-
 src/cairo-paginated-surface.c      |   37 +-
 src/cairo-win32-font.c             |    7 +-
 src/cairo-win32-printing-surface.c | 1220 ++++++++++++++++++++++++++++++++++++
 src/cairo-win32-private.h          |   66 ++-
 src/cairo-win32-surface.c          |   78 ++-
 src/cairo-win32.h                  |    3 +
 src/cairo.h                        |    4 +-
 8 files changed, 1376 insertions(+), 41 deletions(-)

commit 284ed91ee4418baf6dd1a437a904980a2156fa48
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Wed Aug 29 15:34:04 2007 -0700

    Let surfaces specify their native resolution, for fallback purposes

 src/cairo-image-surface.c     |    2 ++
 src/cairo-paginated-surface.c |    4 ++--
 src/cairo-surface-private.h   |    8 ++++++++
 src/cairo-surface.c           |   24 ++++++++++++++++++++++++
 src/cairoint.h                |    6 ++++++
 5 files changed, 42 insertions(+), 2 deletions(-)

commit 79d975f84bcc32e91db517d71a7312e2e1d653d4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Sep 12 17:45:11 2007 -0400

    [cairo-ft-font] Ignore FT_Load_Glyph errors other than out-of-memory
    Same for FT_Render_Glyph.
    
    When the user asks us to render a glyph that is not available in the font,
    it's mostly an unavoidable kind of error for them, as in, they can't
    avoid such a call.  So it's not nice to put cairo_t in an error state and
    refuse any further drawying.
    
    Many PDF files are created using buggy software and cause such glpyh-not-found
    errors for CID 0 for example.
    
    Eventually we should propagate these kind of errors up and return it from
    the function call causing it, but that needs API change to add return value
    to all text functions, so for now we just ignore these errors.

 src/cairo-ft-font.c |   14 +++++++++-----
 1 files changed, 9 insertions(+), 5 deletions(-)

commit 21ab44f11d3d20eead5d988c7a6cf48eebff08c7
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Sep 17 16:41:52 2007 -0400

    [ChangeLog.mk] Make make rule depend on .git/HEAD, not .git
    That is exactly what we want.  Kristian Høgsberg suggested it.

 ChangeLog.mk |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 3f4875dbe20e1d093d70f49c32f7ddf6a6e6ef61
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 16 20:26:33 2007 +0930

    Analysis-surface: Use pattern extents to limit show_glyphs extents

 src/cairo-analysis-surface.c |   12 +++++++++++-
 1 files changed, 11 insertions(+), 1 deletions(-)

commit 14786385b40aa0ae83e3b077a82e3f34aba63f22
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 16 19:43:28 2007 +0930

    Change paginated surface size when PS/PDF _set_size() called
    
    The finer-grained fallbacks would not work correctly if the page
    was set to a larger size.
    
    Add _cairo_paginated_surface_set_size() function that is called
    from cairo_ps_surface_set_size() and cairo_pdf_surface_set_size().

 src/cairo-paginated-private.h   |    5 +++++
 src/cairo-paginated-surface.c   |   23 +++++++++++++++++++++++
 src/cairo-pdf-surface-private.h |    2 ++
 src/cairo-pdf-surface.c         |   14 ++++++++++----
 src/cairo-ps-surface-private.h  |    2 ++
 src/cairo-ps-surface.c          |   14 ++++++++++----
 6 files changed, 52 insertions(+), 8 deletions(-)

commit 46cb7e69526e8b5663077e7409dc232a0f56800b
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 16 16:32:54 2007 +0930

    PS: Remove initclip operator
    
    The DSC and EPS specifications do not allow the use of initclip.
    Instead each page is wrapped in a gsave/restore pair and a
    "grestore gsave" is emitted when the clip path is reset.

 src/cairo-ps-surface.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit e9d85235f9cceed92af428e0ab43503fe0850636
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 16 16:21:10 2007 +0930

    PDF: Fix copy_page() bug

 src/cairo-pdf-surface.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit a5cb48fcf269c16dd138c0ee31b138b1f13e623d
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 16 16:15:10 2007 +0930

    PS: Remove copy_page()
    
    The DSC specification recommends not using the copypage operator as it
    breaks page independence.

 src/cairo-paginated-surface.c |    3 +--
 src/cairo-ps-surface.c        |   14 +-------------
 2 files changed, 2 insertions(+), 15 deletions(-)

commit 03f7a51f47717af45afbc439ce2178789449ab32
Author: Ken Herron <kherron+cairo@fmailbox.com>
Date:   Sun Sep 16 15:56:16 2007 +0930

    PS output optimizations (#11442)
    
    This patches cairo-ps-surface.c to use the aliases for moveto, lineto, curveto,
    and closepath. It also uses selectfont to select fonts.

 src/cairo-ps-surface.c |   13 ++++++-------
 1 files changed, 6 insertions(+), 7 deletions(-)

commit 1274147ce3ec855488fe4e437838b1134c494413
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Sep 15 04:03:08 2007 -0400

    [cairo-gstate] Fix comment about font_matrix having zero translation

 src/cairo-gstate.c |    9 +++++----
 1 files changed, 5 insertions(+), 4 deletions(-)

commit 6fbe2432c6072522b9003a1e46180392010a7aad
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Sep 15 04:02:39 2007 -0400

    [PDF] Fix typo in comments

 src/cairo-pdf-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit dca93eb76d64194f1325d7b941fa523da7801634
Author: Jeff Muizelaar <jeff@freiheit.infidigm.net>
Date:   Wed Sep 12 23:12:59 2007 -0400

    Fix theoretical NULL return from cairo_pop_group()
    
    This also makes the code more consistent as group_pattern always holds a valid
    pattern.

 src/cairo.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 5eae45c55b3cd240945cd225631c9c782f69b50f
Author: Jonathan Gramain <jonathan.gramain@gmail.com>
Date:   Wed Sep 12 17:43:55 2007 -0400

    [cairo-gstate] Fix order of matrices in _cairo_gstate_backend_to_user_rectangle()
    
    The cairo_matrix_multiply(out,a,b) docs say that it is equivalent to applying
    matrix a first, followed by b.  Looking at _cairo_gstate_backend_to_user() we should
    apply device_transform_inverse followed by ctm_inverse.  That's what we do now.

 src/cairo-gstate.c |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

commit f2910ad3e9bfd279af7f9f43013489a32b5c1747
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Sep 11 13:32:26 2007 -0700

    Update cairo-sections.txt

 doc/public/cairo-sections.txt |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 9e975757a2820303d67e8497ab6cef9368237eb5
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Sep 11 13:30:35 2007 -0700

    Export cairo_surface_{copy,show}_page
    
    This patch adds cairo_surface_copy_page and cairo_surface_show_page
    as public methods, leaving the previous cairo_show_page variants as
    shorthands.  copy_page/show_page are specific to the surface, not
    to the context, so they need to be surface methods.

 TODO                                          |    5 ----
 boilerplate/Makefile.win32                    |    4 +++
 boilerplate/cairo-boilerplate-test-surfaces.c |    5 +---
 src/cairo-gstate.c                            |    4 +-
 src/cairo-paginated-surface.c                 |    6 ++--
 src/cairo-surface.c                           |   27 +++++++++++++++++++++++-
 src/cairo-svg-surface.c                       |    2 +-
 src/cairo.c                                   |    6 +++++
 src/cairo.h                                   |    6 +++++
 src/cairoint.h                                |    8 +-----
 10 files changed, 50 insertions(+), 23 deletions(-)

commit 7dd05b7f86da6a465bb979c2ba955655ddcf66ed
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Sep 11 11:27:35 2007 -0700

    [mlk] Free boxes in copy_rectangle_list on success
    
    Fix memory leak when copy_rectangle_list is used.

 src/cairo-clip.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 897350c6c5cba29b8bd7890a33ecc4d7fa9b7795
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 9 19:11:12 2007 +0930

    PDF: Remove BC entry from Smask dictionary
    
    The BC (background color) in the smask of the recently added
    cairo_mask() support was causing Ghostscript to crash due to the wrong
    number of BC values. The BC entry has been removed as BC default color
    is already what we want.

 src/cairo-pdf-surface.c |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

commit 909e0be2416aa6833639439279583d1ae61777fc
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Sep 9 11:20:02 2007 +0930

    Add PDF support for cairo_mask()

 src/cairo-pdf-surface.c |  129 +++++++++++++++++++++++++++++++++++++++++++++--
 1 files changed, 125 insertions(+), 4 deletions(-)

commit d62f8861689d8b9a9a837043fb78813f0407abd4
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Sep 5 08:07:41 2007 +0100

    [cairo-ft-font] Early detection of a zero sized bitmap.
    
    Under rare circumstances we may need to extract a surface that
    represents a bitmap with width==0 and rows==0. Detect this case at the
    start and simply return a zero-sized surface.
    
    Fixes https://bugs.freedesktop.org/show_bug.cgi?id=12284.

 src/cairo-ft-font.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit d635e0103346f22e578d17c59153d292820e00d2
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Thu Sep 6 12:56:59 2007 -0700

    Add b8g8r8 formats to cairo-image-surface
    
    Add recognition code for x8b8g8r8 and a8b8g8r8 to cairo-image-surface.
    (Used as the default for 24bpp by some older VNC servers.)

 src/cairo-image-surface.c |   22 ++++++++++++++++++++++
 1 files changed, 22 insertions(+), 0 deletions(-)

commit 3c01efb0ee0c8911fba7627d056ec3b53dfab6e3
Merge: 0682b9a... 1e21220...
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Sep 5 14:38:40 2007 -0700

    Merge branch adrianj/pdf-meta-surface-pattern into cairo
    
    This does introduce some reported failures from the cairo-pdf backend
    into the test suite. However, in all cases the output PDF files look
    fine when viewed with acroread. It looks like all of the problems
    could be fixed by using cairo_rectangle;cairo_fill along with
    CAIRO_EXTEND_PAD when drawing images with cairo inside poppler.
    
    However, I'm not yet filing a bug against poppler and disabling these
    tests because we need to _implement_ CAIRO_EXTEND_PAD before we can
    tell poppler to start using it.

commit 0682b9a9c18640c284c7cc8ba8792a329414998e
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Sep 4 16:47:49 2007 -0700

    Add rgb24-ignore-alpha test
    
    This test demonstrates a bug when compositing an rgb24 image over an argb32
    image, (the implementation appears to be examining the alpha channel
    rather than ignoring it).

 test/.gitignore                 |    1 +
 test/Makefile.am                |    1 +
 test/rgb24-ignore-alpha-ref.png |  Bin 0 -> 116 bytes
 test/rgb24-ignore-alpha.c       |   65 +++++++++++++++++++++++++++++++++++++++
 4 files changed, 67 insertions(+), 0 deletions(-)

commit 84a2c8968a57ed7593db1515718115218072bc0d
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Sep 5 12:38:27 2007 -0400

    [test,perf] Support TARGETS_EXCLUDE make variable

 perf/Makefile.am |    6 ++++--
 test/Makefile.am |    5 +++--
 2 files changed, 7 insertions(+), 4 deletions(-)

commit 1e21220f0e2540e3befa66e4764f75589d0eef82
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Wed Sep 5 22:53:43 2007 +0930

    Create meta-surface source image with same content type as the
    meta-surface

 src/cairo-meta-surface.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 875e32178e5d990a09f3c41262d890888035f04f
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Wed Sep 5 22:51:13 2007 +0930

    Eliminate unclipped CLEAR from meta-surface playback
    
    The optimization that avoids replaying commands prior to an unclipped
    CLEAR operation now starts playback from the first command after the
    CLEAR. This avoids the need to handle the unclipped CLEAR in the PDF
    surface.

 src/cairo-meta-surface.c |   12 ++++++------
 1 files changed, 6 insertions(+), 6 deletions(-)

commit d24f019101dd014983aeb0bf186fe2011694e2ed
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Wed Sep 5 22:26:16 2007 +0930

    Add support for PDF meta-surface patterns

 boilerplate/cairo-boilerplate.c  |   11 +--
 src/cairo-analysis-surface.c     |   66 +++++++++
 src/cairo-meta-surface-private.h |    4 +
 src/cairo-meta-surface.c         |   43 +++++-
 src/cairo-pdf-surface.c          |  282 ++++++++++++++++++++++++++++----------
 src/cairo-types-private.h        |    3 +-
 6 files changed, 317 insertions(+), 92 deletions(-)

commit b85032584b32af968dc8d8a0fcfc9f3e1d2770a0
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Sep 5 00:26:56 2007 -0400

    [configure.in] Fix non-pkgconfig Xrender detection path (#4724)

 configure.in |    6 +++++-
 1 files changed, 5 insertions(+), 1 deletions(-)

commit 1d788da5175dac34ed0298204753bf1b40dfc2b0
Merge: 49ae376... e1819a2...
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Sep 4 19:12:48 2007 -0400

    Merge branch 'no-xrender.h' into cairo

commit e1819a24fb0196218c4045616c2ba458819b7d31
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Sep 4 19:12:14 2007 -0400

    [cairo-xlib-xrender-private] Remove some protocol-specific macros

 src/cairo-xlib-xrender-private.h |   48 --------------------------------------
 1 files changed, 0 insertions(+), 48 deletions(-)

commit 5e09126ce13c72222719b73ed3a8f504cf352583
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Sep 4 18:40:54 2007 -0400

    [cairo-xlib-xrender-private] Add copyright/license info for copied files

 src/cairo-xlib-xrender-private.h |  163 ++++++++++++++++++++++----------------
 1 files changed, 95 insertions(+), 68 deletions(-)

commit 49ae376840a5851bf4cc281a0562acdfe03337df
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Sep 4 11:35:40 2007 -0700

    Fix error in description of cairo version numbers
    
    And eliminate a bit of redundant text.

 configure.in |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit b60c0a672f1711c20f898ac76c15b6b65a63d46e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Sep 3 14:33:11 2007 +0100

    [cairo-boilerplate] Introduce CAIRO_TEST_TARGET_EXCLUDE.
    
    As opposed to the CAIRO_TEST_TARGET env var which lists the exact
    targets to test, CAIRO_TEST_TARGET_EXCLUDE instead supplies a list of
    targets to filter from the testing set. This is useful under
    circumstances where the build environment prevents testing of a target,
    for example no DirectFB support or the glitz library is broken, but where
    you still want to perform the minimal check that the code compiles.

 boilerplate/cairo-boilerplate.c |   39 ++++++++++++++++++++++++++++++++++++++-
 1 files changed, 38 insertions(+), 1 deletions(-)

commit 740fed62d236224fdfbfccf8c49a199851189107
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Aug 31 20:52:43 2007 -0400

    [xlib] Make it compile without Xrender available at compile time (#12210)

 src/Makefile.am                  |    3 +-
 src/cairo-xlib-display.c         |    1 -
 src/cairo-xlib-private.h         |   10 +-
 src/cairo-xlib-screen.c          |    2 -
 src/cairo-xlib-surface.c         |    7 +-
 src/cairo-xlib-xrender-private.h | 1102 ++++++++++++++++++++++++++++++++++++++
 6 files changed, 1110 insertions(+), 15 deletions(-)

commit c8ed3e1827dd1e6e85f2a40de67c4013432ba3bf
Author: Jody Goldberg <jody@gnome.org>
Date:   Fri Aug 31 17:00:36 2007 -0400

    [PDF] The symbol 'GROUP' is already used on some win32 systems; add a prefix

 src/cairo-pdf-surface.c |   14 +++++++-------
 1 files changed, 7 insertions(+), 7 deletions(-)

commit c14cf02f61105b755b380bd0a5d5b9e83a97d2c9
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Aug 31 17:20:54 2007 +0100

    [cairo-surface] Add a comment about why the glyph array is not const.
    
    As penance for attempting to make the glyph array constant, add a
    comment block to explain that the backends rely on being able to modify
    the array.

 src/cairo-surface.c |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

commit e8e3bfc1308aa30ea08ec530b6a5ddf532fd3088
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Aug 31 16:53:21 2007 +0100

    Revert "[cairo-gstate] Avoid copying untransformed glyphs."
    
    This reverts commit 919bea6dbb32746f11781cd3a94eb44f5c4a32e6.
    
    Sadly as Behdad points out some backends do modify the glyph array and,
    for example cairo-xlib-surface, hide this from the compiler with some
    evil casts.

 src/cairo-analysis-surface.c         |    2 +-
 src/cairo-directfb-surface.c         |    2 +-
 src/cairo-glitz-surface.c            |    2 +-
 src/cairo-gstate.c                   |   41 ++++++++-------------------------
 src/cairo-meta-surface.c             |    2 +-
 src/cairo-paginated-surface.c        |    2 +-
 src/cairo-pdf-surface.c              |    2 +-
 src/cairo-ps-surface.c               |    2 +-
 src/cairo-quartz-surface.c           |    2 +-
 src/cairo-scaled-font.c              |    2 +-
 src/cairo-surface-fallback-private.h |    2 +-
 src/cairo-surface-fallback.c         |    4 +-
 src/cairo-surface.c                  |    4 +-
 src/cairo-svg-surface.c              |    2 +-
 src/cairo-win32-font.c               |    2 +-
 src/cairo-win32-surface.c            |    2 +-
 src/cairo-xcb-surface.c              |   20 ++++++++--------
 src/cairo-xlib-surface.c             |    4 +-
 src/cairoint.h                       |   12 +++++-----
 src/test-meta-surface.c              |    2 +-
 src/test-paginated-surface.c         |    2 +-
 21 files changed, 47 insertions(+), 68 deletions(-)

commit 919bea6dbb32746f11781cd3a94eb44f5c4a32e6
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Aug 31 11:24:06 2007 +0100

    [cairo-gstate] Avoid copying untransformed glyphs.
    
    Skip the memory duplication of the incoming glyphs if we do not need
    to transform them into the backend coordinate system.
    
    As a consequence we need to constify the glyphs passed to the backend
    functions.

 src/cairo-analysis-surface.c         |    2 +-
 src/cairo-directfb-surface.c         |    2 +-
 src/cairo-glitz-surface.c            |    2 +-
 src/cairo-gstate.c                   |   41 +++++++++++++++++++++++++--------
 src/cairo-meta-surface.c             |    2 +-
 src/cairo-paginated-surface.c        |    2 +-
 src/cairo-pdf-surface.c              |    2 +-
 src/cairo-ps-surface.c               |    2 +-
 src/cairo-quartz-surface.c           |    2 +-
 src/cairo-scaled-font.c              |    2 +-
 src/cairo-surface-fallback-private.h |    2 +-
 src/cairo-surface-fallback.c         |    4 +-
 src/cairo-surface.c                  |    4 +-
 src/cairo-svg-surface.c              |    2 +-
 src/cairo-win32-font.c               |    2 +-
 src/cairo-win32-surface.c            |    2 +-
 src/cairo-xcb-surface.c              |   20 ++++++++--------
 src/cairo-xlib-surface.c             |    4 +-
 src/cairoint.h                       |   12 +++++-----
 src/test-meta-surface.c              |    2 +-
 src/test-paginated-surface.c         |    2 +-
 21 files changed, 68 insertions(+), 47 deletions(-)

commit 62377cbac17779fd51ec108e9704be8d3eed4935
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Aug 30 19:45:44 2007 -0400

    [cairo-path-fixed] Remove leftover typedef keyword
    
    Oops!

 src/cairo-path-fixed-private.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit dd406b1ffa411b100950c0156d842e3022e4029d
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Aug 30 18:45:26 2007 -0400

    [cairo-path-fixed] typedef char cairo_path_fixed_op_t
    
    So it consumes one byte only, instead of the previous enum with
    the __attribute__((packed)) that didn't do anything on non-gcc systems.

 src/cairo-path-fixed-private.h |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

commit e7324454a06e1f090d4e654c9cdcb774f9fb39ab
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Aug 29 15:26:41 2007 -0700

    Disable radial-gradient and unbounded-operator tests for pdf
    
    These are failing due to (already reported) poppler bugs.
    
    There were also problems with the gradients in the PDF
    files previously, but these have recently been fixed.

 boilerplate/cairo-boilerplate-pdf.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit f72078fb7660b3c8a369e7bca19628416176a55e
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Wed Aug 29 20:18:09 2007 +0930

    Fix unbounded operator bug in analysis surface

 src/cairo-analysis-surface.c |  117 +++++++++++++++++++++++-------------------
 1 files changed, 65 insertions(+), 52 deletions(-)

commit 3216275fd9a9cd8d51b1c3a8671393912d50d899
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Tue Aug 28 23:40:18 2007 +0930

    Fix PDF gradients bug
    
    The PDF surface was adding extra stops at the 0.0 and 1.0 offset when
    there was not already stops at these offsets. This has been replaced
    with code to move the coordinates of the linear gradient line in to
    the position of the first and last offset.

 src/cairo-pdf-surface.c |   63 ++++++++++++++++++++++++++++++----------------
 1 files changed, 41 insertions(+), 22 deletions(-)

commit bdc70d1fc2a31aa829571244c54f98210e97a2cf
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Wed Aug 29 12:52:00 2007 -0700

    [win32] call scaled_font_fini in create before returning NULL

 src/cairo-win32-font.c |   13 +++++++++----
 1 files changed, 9 insertions(+), 4 deletions(-)

commit 114b07881e8b09f97394dd4fe8f2900ee9f4c348
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Aug 29 12:18:16 2007 -0400

    [configure.in] Make PS backend require zlib too (#12210)
    
    The PS backend uses zlib these days.  Make it depend on zlib being available
    like PDF has been doing.

 configure.in |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)

commit 7f726e57546dba4cdd96086515a372d18c1ee2a9
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Aug 29 12:15:36 2007 -0400

    [configure.in] Document version scheme

 configure.in |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 93aee43690c329f43be9e7b840851267ceb17956
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Aug 28 16:47:24 2007 -0700

    Fix previous create_similar fallback patch
    
    We can't use composite, as some backends don't implement it.
    Use paint() instead.

 src/cairo-pattern.c          |   32 ------------------------
 src/cairo-surface-fallback.c |   28 ++++++++++++---------
 src/cairo-surface.c          |   55 ++++++++++++++++++++++-------------------
 3 files changed, 45 insertions(+), 70 deletions(-)

commit 6525d4debb6df67126b04609bb04d23d9c9bd7a6
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Aug 28 10:47:52 2007 -0700

    [win32] call free() and not scaled_font_destroy() if scaled init fails
    
    If scaled_font_destroy() is called, a deadlock can result; there's no
    reason to call destroy since the initialization failed (and, indeed,
    it might not be valid to do so anyway).

 src/cairo-win32-font.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit ae19b1c9911f95f64657f6ddaa0c924ca7a34b88
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Aug 28 10:40:33 2007 -0700

    [win32] Add cairo_win32_font_face_create_for_logfontw_hfont
    
    Patch from: Robert O'Callahan <roc@ocallahans.org>
    
    Add cairo_win32_font_face_create_for_logfontw_hfont, allow win32
    scaled_fonts to rescale themselves properly to the required CTM and
    only use the font_face's hfont if we're sure it's appropriate.

 src/cairo-win32-font.c |  107 ++++++++++++++++++++++++++++++++++++++----------
 src/cairo-win32.h      |    3 +
 2 files changed, 88 insertions(+), 22 deletions(-)

commit 69dae7ee4ace8a92226140ce5ccb690e7f62e35c
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Aug 27 16:30:52 2007 -0700

    Implement fallback for clone_similar

 src/cairo-surface-fallback-private.h |   10 ++++++++
 src/cairo-surface-fallback.c         |   41 ++++++++++++++++++++++++++++++++++
 src/cairo-surface.c                  |    6 ++++-
 3 files changed, 56 insertions(+), 1 deletions(-)

commit 19fa097f515e72c195d10ddd64920ec71fa903ec
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Aug 27 15:29:24 2007 -0700

    [win32] Update win32 Makefiles
    
    Happy building with msys, one location for CFLAGS/etc changes (toplevel),
    new pdiff makefile.

 Makefile.win32             |   45 ++++++++++++++++++++++++++++++++++++++-----
 boilerplate/Makefile.win32 |   13 ++++++-----
 src/Makefile.win32         |   18 +++++-----------
 test/Makefile.win32        |   18 ++++++++++++----
 test/pdiff/Makefile.win32  |   18 +++++++++++++++++
 5 files changed, 83 insertions(+), 29 deletions(-)

commit f4a8633fce5262c09b323eef212fd6efe57d8f10
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Aug 27 14:26:19 2007 -0700

    [win32] check correct surface for BitBlt support in get_subimage

 src/cairo-win32-surface.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit 9aad6efd2b2ee14b0a8960a8e4de91b330ad0c4c
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Aug 27 14:17:50 2007 -0700

    Fix image_extra arg in call to _cairo_release_source_image

 src/cairo-surface-fallback.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 7ccae2de6d859fcac93cedbd3ecd1121e0d0a72b
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Aug 28 13:45:02 2007 -0400

    [perf] Make cairo-perf-diff build cairo-perf-diff-files

 perf/cairo-perf-diff |   10 ++++++++--
 1 files changed, 8 insertions(+), 2 deletions(-)

commit 766346aa5cffb699206cc17114221ba7a0323565
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Tue Aug 28 20:35:49 2007 +0930

    PDF: Remove unused code

 src/cairo-pdf-surface-private.h |    1 -
 src/cairo-pdf-surface.c         |   18 ------------------
 2 files changed, 0 insertions(+), 19 deletions(-)

commit ad43b7fe6bba3ba597b28b6f6668ee98cdc04a88
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Tue Aug 28 20:35:23 2007 +0930

    PDF: Clean up comments

 src/cairo-pdf-surface.c |   20 ++++++++++----------
 1 files changed, 10 insertions(+), 10 deletions(-)

commit a60beb2eef46b03bcb81f5204dcde49cbc090928
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Tue Aug 28 20:34:55 2007 +0930

    Fix PDF regression with multipage documents

 src/cairo-pdf-surface.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

commit 1a6b62e5995aac27527c37fd5cb6ec5e36a3f890
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Aug 27 14:45:51 2007 -0700

    Disable 7 cairo-pdf tests due to poppler knockout-group bug
    
    The following 7 tests currently fail with poppler due to:
    
    	Poppler does not correctly handle knockout groups
    	https://bugs.freedesktop.org/show_bug.cgi?id=12185
    
    and we've verified with acroread that the cairo-pdf output
    does render as intended there. The disabled tests are
    clip-operator, operator-clear, operator-source, over-above-source,
    over-around-source, over-below-source, and over-between-source.

 boilerplate/cairo-boilerplate-pdf.c |   25 ++++++++++++++++++-------
 1 files changed, 18 insertions(+), 7 deletions(-)

commit 1cdd11873b18ec55521ffd744ad12c619cf9b227
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Aug 25 06:44:08 2007 +0930

    Add finer-grained fallback support to the PDF surface
    
    The stream handling has been changed to support writing the content to
    one or more group objects. Each page has a top level knockout
    group. The first operation in the knockout group paints another group
    containing the content. Fallback images are painted from the knockout
    group. This ensures that fallback images do not composite with any
    content under the image.

 src/cairo-paginated-surface.c   |    6 +-
 src/cairo-pdf-surface-private.h |   55 ++-
 src/cairo-pdf-surface.c         | 1402 ++++++++++++++++++++++++++-------------
 3 files changed, 980 insertions(+), 483 deletions(-)

commit 1e8446609b01a3a60c3cc5b69d95d26cc9df460b
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Aug 27 14:02:55 2007 -0700

    Add explanation of pdf_ignored_tests with links to upstream poppler bug reports

 boilerplate/cairo-boilerplate-pdf.c |   29 +++++++++++++++++++++++++++++
 1 files changed, 29 insertions(+), 0 deletions(-)

commit 463493af73a644c7031df0e396c722cf2cb227b1
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Aug 27 10:39:14 2007 -0700

    Remove svg2pdf and pdf2svg programs from test directory
    
    These are useful programs, but they don't belong in test/.
    They are never used in the test suite at all. Instead, these
    should exist in some demo package, or as applications in their
    own right.
    
    (The motivation for the removal is that someone just encountered
    a build error with one of these. And I'm not interested in debugging
    build errors for unused components.)

 test/.gitignore  |    1 -
 test/Makefile.am |   12 ------
 test/pdf2svg.c   |  101 ------------------------------------------------------
 test/svg2pdf.c   |   85 ---------------------------------------------
 4 files changed, 0 insertions(+), 199 deletions(-)

commit 495c9d19bf27150783b563ed8a7a9b2e6e8c2115
Author: Carl Worth <cworth@cworth.org>
Date:   Sat Aug 25 23:39:28 2007 -0700

    One more PS-specific reference image (for over-between-source)
    
    A pixman bug had kept this from being correct earlier. It
    works now as long as pixman includes the following fix:
    
    	8ff7213f39edc1b2b8b60d6b0cc5d5f14ca1928d
    	rasterize traps that extend outside of the image bounds correctly

 test/over-between-source-ps-argb32-ref.png |  Bin 0 -> 678 bytes
 1 files changed, 0 insertions(+), 0 deletions(-)

commit a3c3fe2296a7e8f1fdffc9f922fb647237504818
Author: Carl Worth <cworth@cworth.org>
Date:   Sat Aug 25 19:23:13 2007 -0700

    Modify ps-specific reference images for ft-text-vertical tests
    
    I've been seeing failures with the PS backend for these tests
    for a while. This is in spite of the face that we've had a PS-
    specific reference image for each of these tests. I'm not sure
    what the difference is between my current system and the
    system used to generate the original ps-specific reference
    images.
    
    One thing we definitely need to do is to bundle fonts with the
    test suite to avoid problems like this. Another is to start
    documenting the systems used to generate reference images.
    I get very confused with ghostscript versioning, but I can
    at least say that "gs --version" reports 8.15.3 here, (though
    the package appears to have an 8.56 version).

 ...ft-text-vertical-layout-type1-ps-argb32-ref.png |  Bin 1877 -> 1879 bytes
 ...ft-text-vertical-layout-type3-ps-argb32-ref.png |  Bin 1879 -> 1882 bytes
 2 files changed, 0 insertions(+), 0 deletions(-)

commit 71cc245d5a99eb6593e104b5e6727a7db13a4503
Author: Carl Worth <cworth@cworth.org>
Date:   Sat Aug 25 19:18:44 2007 -0700

    Add PS-specific reference images for 4 tests
    
    The following 4 tests recently started drawing with native operations
    in the place of image fallbacks, so we need ps-specific reference images
    to account for minor rasterization differences: over-above-source,
    over-around-source, over-below-source, and trap-clip.

 test/over-above-source-ps-argb32-ref.png  |  Bin 0 -> 636 bytes
 test/over-around-source-ps-argb32-ref.png |  Bin 0 -> 637 bytes
 test/over-below-source-ps-argb32-ref.png  |  Bin 0 -> 503 bytes
 test/trap-clip-ps-argb32-ref.png          |  Bin 0 -> 5810 bytes
 4 files changed, 0 insertions(+), 0 deletions(-)

commit ae185f803a95248bcb6a8232cabedbc992b66502
Author: Carl Worth <cworth@cworth.org>
Date:   Sat Aug 25 18:57:46 2007 -0700

    Add four new test to exercise interactions of native and fallback objects
    
    The new tests are: over-above-source, over-around-source, over-below-source,
    and over-between-source

 test/.gitignore                        |    4 ++
 test/Makefile.am                       |    4 ++
 test/over-above-source-ref.png         |  Bin 0 -> 538 bytes
 test/over-above-source-rgb24-ref.png   |  Bin 0 -> 461 bytes
 test/over-above-source.c               |   80 ++++++++++++++++++++++++++++
 test/over-around-source-ref.png        |  Bin 0 -> 614 bytes
 test/over-around-source-rgb24-ref.png  |  Bin 0 -> 503 bytes
 test/over-around-source.c              |   91 ++++++++++++++++++++++++++++++++
 test/over-below-source-ref.png         |  Bin 0 -> 434 bytes
 test/over-below-source-rgb24-ref.png   |  Bin 0 -> 392 bytes
 test/over-below-source.c               |   80 ++++++++++++++++++++++++++++
 test/over-between-source-ref.png       |  Bin 0 -> 575 bytes
 test/over-between-source-rgb24-ref.png |  Bin 0 -> 473 bytes
 test/over-between-source.c             |   91 ++++++++++++++++++++++++++++++++
 14 files changed, 350 insertions(+), 0 deletions(-)

commit 5929a1defbc9816a6faa6dca94ae6dc3a2dbf3df
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sat Aug 25 21:28:33 2007 +0200

    [SVG] Suppress code duplication by using _cairo_svg_surface_emit_stroke_style
    from _cairo_svg_surface_stroke.

 src/cairo-svg-surface.c |   65 ++--------------------------------------------
 1 files changed, 3 insertions(+), 62 deletions(-)

commit 726ed304018915815d232822cd9efb83ee1339bc
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sun Jul 29 16:46:21 2007 +0200

    [SVG] Don't emit transform property when matrix is identity.

 src/cairo-svg-surface.c |   44 +++++++++++++++++++++++++-------------------
 1 files changed, 25 insertions(+), 19 deletions(-)

commit 89881187f22b40b4afd15eed0b2c19edcba2ca09
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sun Jul 29 13:33:50 2007 +0200

    [SVG] Implement fill_stroke method.

 src/cairo-svg-surface.c |  132 ++++++++++++++++++++++++++++++++++++++++++++---
 1 files changed, 124 insertions(+), 8 deletions(-)

commit ac51fff0db73c5917a38af3f610d4751b8fec626
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sat Aug 25 20:49:50 2007 +0200

    Add a new fill_stroke surface backend method.
    
    This method is for use in vector backends, where fill immediatly followed by
    stroke command with the same path can be emited in the same backend command.
    This commit also factorize the detection of such cases in the meta surface
    backend and automatically call the fill_stroke method on replay.

 src/cairo-meta-surface.c |   54 ++++++++++++++++++++++++++++++++++++-----
 src/cairo-path-fixed.c   |   27 +++++++++++++++++++++
 src/cairo-surface.c      |   59 ++++++++++++++++++++++++++++++++++++++++++++++
 src/cairoint.h           |   36 ++++++++++++++++++++++++++++
 4 files changed, 169 insertions(+), 7 deletions(-)

commit 43d35e01106659ac689846a8d5875d235b0d3c9f
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Sat Jul 28 17:37:24 2007 +0200

    [SVG] fix modeline for vim.

 src/cairo-svg-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 3ceaa6e74e4bd3f5935016c3639411b26d7f576f
Merge: e3b5a65... 24075f1...
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Aug 24 08:03:44 2007 -0700

    Merge branch 'cairo-origin' into cairo

commit e3b5a650213b98c3514a850cdb86f1178fe06833
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Aug 24 08:03:03 2007 -0700

    Remove build-breaking debugging helper.
    
    Sorry! Totally my fault on this one.

 src/cairoint.h |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

commit 24075f1bddbda1d90dfd6f041b8d6bdaf9c786dc
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Aug 24 14:16:43 2007 +0100

    [cairo-perf] Blacklist xlib-fallback.
    
    Do not try and create non-Render xlib surfaces as they explicitly do
    not support performance testing.

 perf/cairo-perf.c |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

commit 8894894d9d34d169efa39d6d86ebefcb2ba69fe1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Aug 24 13:40:26 2007 +0100

    [cairo-boilerplate-xlib] Check that the surface will fit in the screen.
    
    Whilst testing the fallback surface, the resultant image was being
    clipped to the screen size. Be conservative and refuse to create
    windows (for CAIRO_CONTENT_COLOR surfaces) that are larger than the
     screen.

 boilerplate/cairo-boilerplate-xlib.c |   25 +++++++++++++++++++++++++
 1 files changed, 25 insertions(+), 0 deletions(-)

commit a29544a0b6f150384fd652aad950d1cae9809c42
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Aug 24 12:24:20 2007 +0100

    [cairo-boilerplate-xlib] Clear Render data for the non-Render fallback.
    
    As well as marking the XRender extension unavailable in
    _cairo_boiler_player_xlib_disable_render(), we need to clear any
    XRender derived information stored during the surface creation.

 boilerplate/cairo-boilerplate-xlib.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

commit 177a3b8a32f13ce92d45899367fb7758600f7b93
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Aug 23 16:13:04 2007 -0700

    Remove include of cairoint.h from *-private.h header files.
    
    These were recently added, (as part of sparse integration?), but they
    break boilerplate which reaches into at least cairo-types-private.h
    and cairo-scaled-font-private.h. But boilerplate cannot see cairoint.h
    or else it gets the internal sybol renaming, (with the INT_ prefix),
    and then all the test suite tests refuse to link.
    
    If this change reverts some recently-added functionality, (or
    cleanliness), then we'll just need to find some other way to add that
    back again without the breakage.

 src/cairo-cache-private.h             |    1 -
 src/cairo-clip-private.h              |    1 -
 src/cairo-fixed-private.h             |    1 -
 src/cairo-ft-private.h                |    1 -
 src/cairo-gstate-private.h            |    1 -
 src/cairo-hash-private.h              |    1 -
 src/cairo-malloc-private.h            |    1 -
 src/cairo-mutex-private.h             |    4 +++-
 src/cairo-mutex-type-private.h        |    4 +++-
 src/cairo-os2-private.h               |    3 +--
 src/cairo-output-stream-private.h     |    1 -
 src/cairo-paginated-surface-private.h |    2 +-
 src/cairo-path-fixed-private.h        |    2 --
 src/cairo-pdf-surface-private.h       |    2 --
 src/cairo-private.h                   |    1 -
 src/cairo-ps-surface-private.h        |    2 --
 src/cairo-region-private.h            |    2 --
 src/cairo-scaled-font-private.h       |    2 +-
 src/cairo-surface-private.h           |    2 +-
 src/cairo-svg-surface-private.h       |    2 --
 src/cairo-type1-private.h             |    2 --
 src/cairo-wideint-private.h           |    2 --
 src/cairo-xlib-surface-private.h      |    2 --
 src/cairoint.h                        |    2 ++
 24 files changed, 12 insertions(+), 32 deletions(-)

commit fa41ebfb7c074a6ffa6a8fe7c43207e594c6534c
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Aug 23 13:55:19 2007 -0400

    Fix header inclusion order
    
    Enough for now, until I figure out the right way to break cairoint.h.

 src/cairo-types-private.h |  105 +++++++++++++++++++++++++++------------------
 src/cairoint.h            |   23 +---------
 2 files changed, 64 insertions(+), 64 deletions(-)

commit d66f1ee82a10de325ee4e7579bbbaa1d301292e4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Aug 23 13:54:37 2007 -0400

    [boilerplate] Build libcairoboilerplate.la in make check and make test

 boilerplate/Makefile.am         |    2 ++
 boilerplate/cairo-boilerplate.c |   15 ---------------
 2 files changed, 2 insertions(+), 15 deletions(-)

commit 5594f8b0356fc209749d01e2043559fccd3966d0
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Aug 23 00:38:00 2007 -0400

    [Makefile.am] Run sparse and splint once per source file
    
    Also skip .h files for splint as it causes lots of unused-function warnings.

 src/Makefile.am |   13 +++++++++++--
 1 files changed, 11 insertions(+), 2 deletions(-)

commit 503ab85e44bfa02ef8391f7849826cbe07ff15d2
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Aug 23 15:01:02 2007 +0100

    Fix inadvertent executable mode flip.
    
    Clear the executable bit for cairo-scaled-font.c

 0 files changed, 0 insertions(+), 0 deletions(-)

commit 735757a17a7c72f8598c8958b600daad941a0431
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Aug 22 02:58:37 2007 -0400

    [Makefile.am] Add target sparse to run sparse static source code analyzer
    
    There are still some bits not quite working.

 src/Makefile.am                       |   23 ++++++++++++++++++-----
 src/cairo-cache-private.h             |    1 +
 src/cairo-clip-private.h              |    1 +
 src/cairo-fixed-private.h             |    1 +
 src/cairo-ft-private.h                |    1 +
 src/cairo-gstate-private.h            |    1 +
 src/cairo-hash-private.h              |    1 +
 src/cairo-malloc-private.h            |    1 +
 src/cairo-mutex-private.h             |    4 +---
 src/cairo-mutex-type-private.h        |    4 +---
 src/cairo-os2-private.h               |    3 ++-
 src/cairo-output-stream-private.h     |    1 +
 src/cairo-paginated-surface-private.h |    2 +-
 src/cairo-path-fixed-private.h        |    2 ++
 src/cairo-pdf-surface-private.h       |    2 ++
 src/cairo-private.h                   |    1 +
 src/cairo-ps-surface-private.h        |    2 ++
 src/cairo-quartz-private.h            |    2 +-
 src/cairo-region-private.h            |    2 ++
 src/cairo-scaled-font-private.h       |    2 +-
 src/cairo-surface-private.h           |    2 +-
 src/cairo-svg-surface-private.h       |    2 ++
 src/cairo-type1-private.h             |    2 ++
 src/cairo-types-private.h             |    2 ++
 src/cairo-wideint-private.h           |    2 ++
 src/cairo-xlib-surface-private.h      |    2 ++
 src/cairoint.h                        |   12 ++++++------
 27 files changed, 59 insertions(+), 22 deletions(-)

commit bfdc3b6642a36a7728f82ae87de83244d86ba29e
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Aug 22 01:16:50 2007 -0400

    [Makefile.am] Move -DHAVE_CONFIG_H to the right place

 src/Makefile.am |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit af6a123e95b359234d70f7a766457ff3a427c3cc
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Aug 22 01:09:21 2007 -0400

    [Makefile.am] Inhibit unrecognized options to splint

 src/Makefile.am |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit e9d709b5caf4bc3c48259d6b40e6b95f730aa348
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Aug 22 01:07:59 2007 -0400

    [cairo-image-surface] Fix comment syntax
    Found by splint.

 src/cairo-image-surface.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit ef878345c87c57a79eda079fa5e765aba5ddf163
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Aug 22 01:07:38 2007 -0400

    [Makefile.am] Add target splint to run splint static source code analyzer

 src/Makefile.am |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit f015091bb5361552eebfafc007bcf9e77ba5bfbf
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Aug 22 01:03:50 2007 -0400

    [Makefile.am] Use libcairo_la_CFLAGS instead of INCLUDES
    for clarity.

 src/Makefile.am |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 3e5859c58f8749eaae16149577d52399a2fcf952
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Aug 21 23:02:03 2007 -0400

    [ROADMAP] Mark fine-grained fallbacks done

 ROADMAP |    7 +++++++
 TODO    |    7 -------
 2 files changed, 7 insertions(+), 7 deletions(-)

commit 333b96f0e0a7d775b96014b91c6887cdcda3e93a
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Aug 17 10:41:03 2007 -0700

    Add support for image fallbacks for X servers with 555 visuals
    
    This fixes bugzilla #9993:
    
    	Cairo fails with 555 X server visual
    	https://bugs.freedesktop.org/show_bug.cgi?id=9993

 ROADMAP                   |    2 +-
 src/cairo-image-surface.c |   14 ++++++++++++++
 2 files changed, 15 insertions(+), 1 deletions(-)

commit f00fb10f87d1341b91f025bb068d935355c68c70
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Aug 17 10:36:14 2007 -0700

    Add support for image fallbacks for X servers with 565 visuals
    
    This fixes bugzilla #10461:
    
    	Cairo doesn't support 565 xlib visual
    	https://bugs.freedesktop.org/show_bug.cgi?id=1046

 ROADMAP                   |    2 +-
 src/cairo-image-surface.c |   16 ++++++++++++++++
 2 files changed, 17 insertions(+), 1 deletions(-)

commit ddb78df4c92fc8e51ca18202b59bcef7d1e1d66d
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Aug 17 10:33:25 2007 -0700

    Restore the error message for unsupported X server visuals
    
    Apparently, our much-beloved error message, (just look at how many people
    love to quote it in bugzilla entries), was removed during the switch to
    the new pixman. It was replaced with an obscure failure of a nil surface
    being returned, (leading to obscure failures or false "out of memory"
    errors).
    
    So we're putting this back now, (even though we _really_ want to ensure
    that this message never gets printed in practice).

 src/cairo-image-surface.c |   12 ++++++++++++
 1 files changed, 12 insertions(+), 0 deletions(-)

commit 72fab3675c46a773dac315fffff72cd7f887f79f
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Aug 17 10:29:37 2007 -0700

    Use a pixman_format_code to describe the image surface used for xlib fallbacks
    
    Previously, the code was just using cairo_format_t which is much more limited
    than the formats supported by pixman, (so many "odd" X server visuals would
    just fall over).

 src/cairo-image-surface.c |   87 ++++++++++++++++++++++-----------
 src/cairo-xlib-surface.c  |  117 ++++----------------------------------------
 src/cairoint.h            |   19 +++++++-
 3 files changed, 87 insertions(+), 136 deletions(-)

commit a9662d0aaed8685292ffe13c458182046a644fa7
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Aug 17 08:15:50 2007 -0700

    Eliminate fragile cairo_internal_format_t
    
    Instead we take advantage of the pixman_format_code_t
    that now exists in the public interface of the new, external
    pixman library.

 src/cairo-image-surface.c |  152 ++++++++++++++++++++++++++++++++-------------
 src/cairo-pattern.c       |    2 +-
 src/cairoint.h            |   44 +------------
 3 files changed, 113 insertions(+), 85 deletions(-)

commit 9f4e6436496fe561aa124bb2b89e1c6711684d98
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Aug 21 10:03:00 2007 -0700

    Ensure the Render extension is initialized before calling XESetCloseDisplay
    
    This avoids a potential crash from the Render extension being cleaned
    up during XCloseDisplay before the cairo CloseDisplay hook goes on to
    call into XRenderFreePicture.

 src/cairo-xlib-display.c |    9 +++++++++
 1 files changed, 9 insertions(+), 0 deletions(-)

commit d05593a5fb9fef586171cb9973a9942a105d50d7
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Aug 20 14:50:02 2007 -0700

    Add a new xlib-fallback target to test xlib using image fallbacks instead of the Render extension

 boilerplate/cairo-boilerplate-xlib-private.h |    8 +++
 boilerplate/cairo-boilerplate-xlib.c         |   72 ++++++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c              |    9 +++
 test/fill-rule.c                             |    2 +-
 4 files changed, 90 insertions(+), 1 deletions(-)

commit 590717f03b4a396600734c4dac1dd0a9f140283c
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Wed Aug 22 07:58:14 2007 +0930

    PS: Remove debug info from PS output
    
    The debug code is now conditionally compiled.

 src/cairo-ps-surface.c |   22 ++++++++++++++++++++++
 1 files changed, 22 insertions(+), 0 deletions(-)

commit e66b2b68ab456d779524d9b4ab34acf5d38362b5
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Aug 21 14:52:54 2007 -0700

    Use 8-bit math to flatten color when emitting a solid pattern to PostScript
    
    This isn't necessarily more correct than the old code using the doubles,
    but it does result in bit-for-bit color equivalence when comparing the
    results against the image backend. So that's both good consistency, and
    more ease is using the test suite to verify things.

 src/cairo-ps-surface.c |   26 +++++++++++++++-----------
 1 files changed, 15 insertions(+), 11 deletions(-)

commit bf92255edd20595a6eb220c6ee9d6aa40b244eef
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Tue Aug 21 22:27:57 2007 +0930

    PS: Add finer-grained image fallback support
    
    The analysis surface now keeps track of two regions: supported
    operations, and unsupported operations. If the target surface returns
    CAIRO_INT_STATUS_FLATTEN_TRANSPARENCY, the analysis surface will check
    if any previous operation intersects with this operation. If there is
    nothing previously drawn under the operation, the status is changed to
    supported.
    
    The meta surface has two new functions:
            _cairo_meta_surface_replay_region()
            _cairo_meta_surface_replay_and_create_regions()
    
    During the analysis stage, the paginated surface replays the meta
    surface using _cairo_meta_surface_replay_and_create_regions(). The
    return status from each analyzed operation is saved in the meta
    surface. The _cairo_meta_surface_replay_region() function allows only
    operations from either the supported or unsupported region to be
    replayed. This allows the paginated surface to replay only the
    supported operations before emitting a fallback image for each
    rectangle in the unsupported region.

 src/cairo-analysis-surface-private.h |    3 +
 src/cairo-analysis-surface.c         |  358 +++++++++++++++++++++++++++++-----
 src/cairo-meta-surface-private.h     |   34 +++-
 src/cairo-meta-surface.c             |   78 ++++++--
 src/cairo-paginated-surface.c        |  131 ++++++++++---
 src/cairo-ps-surface.c               |   93 ++++++----
 src/cairo-region-private.h           |    4 +
 src/cairo-region.c                   |   13 ++
 src/cairoint.h                       |    4 +-
 9 files changed, 585 insertions(+), 133 deletions(-)

commit bf4bdbb6076dbe3b74534bc4308dbc9213bf628d
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Aug 20 20:29:51 2007 -0400

    [cairo-scaled-font] Document how glyph surfaces use device offsets

 src/cairo-scaled-font.c |  106 +++++++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 106 insertions(+), 0 deletions(-)

commit 31f5aafa36015ee6ea8ff769c2e1d5841f62642f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Feb 5 20:46:48 2007 -0500

    Fix device_offset misuse in all glyph surface uses
    
    Seems like all over the code, we have been using negated device_offset
    values for glyph surfaces.  Here is all the math(!):
    
    A device_transform converts from device space (a conceptual space) to
    surface space.  For simple cases of translation only, it's called a
    device_offset and is public API (cairo_surface_[gs]et_device_offset).
    A possibly better name for those functions could have been
    cairo_surface_[gs]et_origing.  So, that's what they do: they set where
    the device-space origin (0,0) is in the surface.  If the origin is inside
    the surface, device_offset values are positive.  It may look like this:
    
    Device space:
          (-x,-y) <-- negative numbers
             +----------------+
             |      .         |
             |      .         |
             |......(0,0) <---|-- device-space origin
             |                |
             |                |
             +----------------+
                      (width-x,height-y)
    
    Surface space:
           (0,0) <-- surface-space origin
             +---------------+
             |      .        |
             |      .        |
             |......(x,y) <--|-- device_offset
             |               |
             |               |
             +---------------+
                       (width,height)
    
    In other words: device_offset is the coordinates of the device-space
    origin relative to the top-left of the surface.
    
    We use device offsets in a couple of places:
    
      - Public API: To let toolkits like Gtk+ give user a surface that
        only represents part of the final destination (say, the expose
        area), but has the same device space as the destination.  In these
        cases device_offset is typically negative.  Example:
    
             application window
             +---------------+
             |      .        |
             | (x,y).        |
             |......+---+    |
             |      |   | <--|-- expose area
             |      +---+    |
             +---------------+
    
        In this case, the user of cairo API can set the device_space on
        the expose area to (-x,-y) to move the device space origin to that
        of the application window, such that drawing in the expose area
        surface and painting it in the application window has the same
        effect as drawing in the application window directly.  Gtk+ has
        been using this feature.
    
      - Glyph surfaces: In most font rendering systems, glyph surfaces
        have an origin at (0,0) and a bounding box that is typically
        represented as (x_bearing,y_bearing,width,height).  Depending on
        which way y progresses in the system, y_bearing may typically be
        negative (for systems similar to cairo, with origin at top left),
        or be positive (in systems like PDF with origin at bottom left).
        No matter which is the case, it is important to note that
        (x_bearing,y_bearing) is the coordinates of top-left of the glyph
        relative to the glyph origin.  That is, for example:
    
        Scaled-glyph space:
    
          (x_bearing,y_bearing) <-- negative numbers
             +----------------+
             |      .         |
             |      .         |
             |......(0,0) <---|-- glyph origin
             |                |
             |                |
             +----------------+
                      (width+x_bearing,height+y_bearing)
    
        Note the similarity of the origin to the device space.  That is
        exactly how we use the device_offset to represent scaled glyphs:
        to use the device-space origin as the glyph origin.
    
    Now compare the scaled-glyph space to device-space and surface-space
    and convince yourself that:
    
    	(x_bearing,y_bearing) = (-x,-y) = - device_offset
    
    That's right.  If you are not convinced yet, contrast the definition
    of the two:
    
    	"(x_bearing,y_bearing) is the coordinates of top-left of the
    	 glyph relative to the glyph origin."
    
    	"In other words: device_offset is the coordinates of the
    	 device-space origin relative to the top-left of the surface."
    
    and note that glyph origin = device-space origin.
    
    So, that was the bug.  Fixing it removed lots of wonders and magic
    negation signs.
    
    The way I discovered the bug was that in the user-font API, to make
    rendering the glyph from meta-surface to an image-surface work I had
    to do:
    
    	cairo_surface_set_device_offset (surface, -x_bearing, -y_bearing);
    	_cairo_meta_surface_replay (meta_surface, surface);
    	cairo_surface_set_device_offset (surface, x_bearing, y_bearing);
    
    This suggested that the use of device_offset for glyph origin is
    different from its use for rendering with meta-surface.  This reminded
    me of the large comment in the xlib backend blaming XRender for having
    weird glyph space, and of a similar problem I had in the PS backend
    for bitmap glyph positioning (see d47388ad759b0a1a0869655a87d9b5eb6ae2445d)
    
    ...those are all fixed now.

 src/cairo-atsui-font.c       |    4 +-
 src/cairo-directfb-surface.c |    4 +-
 src/cairo-ft-font.c          |   46 +++++++++++++++++++++--------------------
 src/cairo-glitz-surface.c    |    8 +++---
 src/cairo-ps-surface.c       |   12 +++++-----
 src/cairo-scaled-font.c      |    8 ++----
 src/cairo-svg-surface.c      |    2 +-
 src/cairo-xcb-surface.c      |   40 +----------------------------------
 src/cairo-xlib-surface.c     |   40 +----------------------------------
 9 files changed, 46 insertions(+), 118 deletions(-)

commit d55da1aa621d76b1411300932be5d37883b25dfa
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Feb 7 00:20:29 2007 -0800

    [scaled-font] Really ignore ctm translation
    
    Previously we were ignoring ctm translation in scaled fonts when hashing, but
    still storing it into the scaled font.  Now we zero the translation components
    when storing.

 src/cairo-scaled-font.c |    8 +++++---
 1 files changed, 5 insertions(+), 3 deletions(-)

commit a394e5870e2c5ccedfd9d116b4a42c58b459334d
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Feb 5 16:53:18 2007 -0500

    [cairo-image-surface] Simplify device-offset usage

 src/cairo-image-surface.c |   10 +++++-----
 1 files changed, 5 insertions(+), 5 deletions(-)

commit 61f736d0d1166b050ee948ce2738feab0327ece9
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Feb 5 15:51:30 2007 -0500

    [cairo-paginated-surface] Add XXX mark to integer width,height arguments

 src/cairo-paginated-surface.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit f97bb5613a7fb3d92f2d730460f9c721ee13a41a
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Aug 20 17:32:05 2007 -0700

    Fix path_fixed_offset_and_scale to apply scale and offset in right order

 src/cairo-path-fixed.c |   24 +++++++++---------------
 1 files changed, 9 insertions(+), 15 deletions(-)

commit 51b6cca8de3181d7b42b612ff491451c765d5811
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat Aug 18 00:54:30 2007 +0100

    [cairo-perf-diff] Remove reference to pixman.
    
    Remove the use of pixman as part of the perf id as pixman is no longer
    an integral component of cairo.

 perf/cairo-perf-diff |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

commit 39367b26120b6e1ad0f556911a49f28ef370115b
Author: Martin Ejdestig <marejde@gmail.com>
Date:   Fri Aug 17 02:28:35 2007 +0200

    Plug possible leak of pixman_traps in _cairo_image_surface_composite_trapezoids.
    
    If width and height are 0 and pixman_traps is allocated on the heap,
    it would leak. Fix by simply checking width and height prior to
    allocating pixman_traps.

 src/cairo-image-surface.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 507d7ee09951a35df8b80f0e1507ba17dbd9bfa9
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Jun 27 12:34:35 2007 +0100

    [cairo-xlib-surface] Avoid a malloc(0).
    
    Avoid a zero byte allocation (potentially returning NULL) for an array
    of 0 trapezoids.

 src/cairo-xlib-surface.c |    9 +++++++--
 1 files changed, 7 insertions(+), 2 deletions(-)

commit 85d911d86c9f1dd55d79b7c429ad2b617ec345d1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Jun 27 08:05:35 2007 +0100

    [cairo-image-surface] Avoid malloc(0)
    
    Special case width==0, height==0 to avoid allocating a 0 byte image.

 src/cairo-image-surface.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 7332a5e9949ca19869b003fe5a0a777adac41307
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Jun 27 11:32:50 2007 +0100

    [boilerplate/xmalloc] Special case malloc(0) and friends.
    
    malloc(0) can return NULL so double check the requested size before
    exiting with an out-of-memory error.

 boilerplate/xmalloc.c     |    6 +++---
 src/cairo-image-surface.c |    2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 56e505298c0f5de360380ca7e968baa0e60ac828
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Jun 27 23:01:44 2007 +0100

    [cairo-truetype-subset] Avoid malloc(0).
    
    Avoid attempting to allocate a zero length subset as malloc(0) may return
    NULL.

 src/cairo-truetype-subset.c |   15 +++++++++------
 1 files changed, 9 insertions(+), 6 deletions(-)

commit 7bd1d5ba3d081ae188fe7f8bc346071d0b8d2278
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Jul 3 14:14:56 2007 +0100

    [cairo-png] Protect against malloc(0).
    
    Avoid calling malloc(0) for an empty image.

 src/cairo-png.c |   21 ++++++++++++---------
 1 files changed, 12 insertions(+), 9 deletions(-)

commit 06134df0d0670a7d00d58ebd7a20ba7174f56d16
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Jul 4 19:11:29 2007 +0100

    [cairo-pdf-surface] Check for errors during compression.
    
    Check status return from zlib's compress().

 src/cairo-pdf-surface.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit 76b871d710cd81bee5fe7c2f6175f8d678ebeea5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Aug 16 15:29:11 2007 +0100

    [cairo-image-surface] Remove status return for hard-coded CAIRO_STATUS_SUCCESS.
    
    Remove the status return if the function can only return
    CAIRO_STATUS_SUCCESS, and remove the then surplus conditionals.

 src/cairo-image-surface.c |   13 +++++--------
 1 files changed, 5 insertions(+), 8 deletions(-)

commit 4e39e30d83fc1866a44f0b746c406ee2efb3bf6a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Jul 16 09:25:38 2007 +0100

    [cairo-pen] Remove status from _cairo_pen_find_active_vertex_*()
    
    This pair of functions unconditionally return SUCCESS, so remove the
    status return and supporting tests from their callers.

 src/cairo-path-stroke.c |   24 ++++++------------------
 src/cairo-pen.c         |   16 +++++-----------
 src/cairoint.h          |    4 ++--
 3 files changed, 13 insertions(+), 31 deletions(-)

commit b72b06cc222d88015ce78a5cddf061e903d032b5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Jul 16 09:40:47 2007 +0100

    [cairo-pen] Remove hard-coded CAIRO_STATUS_SUCCESS from _stroke_spline_half()
    
    Remove the status return and update callers as
    _cairo_pen_stroke_spline_half() unconditionally returned SUCCESS.

 src/cairo-pen.c |   15 ++++-----------
 1 files changed, 4 insertions(+), 11 deletions(-)

commit e24969a94ac5670a13c2737db435ac7b5bebb19c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Jul 16 09:36:54 2007 +0100

    [cairo-pdf-surface] cairo_pattern_set_matrix guarantees invertibility.
    
    Be consistent in asserting that the pattern matrix is inverted
    successfully and remove a couple of redundant checks.

 src/cairo-pdf-surface.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit 50ebdda3a97334e5411749cd0c309843ba8cdf44
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Jul 19 10:26:37 2007 +0100

    [cairo-pattern] Assert that the pattern->matrix is invertible.
    
    We guarantee when setting the pattern->matrix that it is invertible, so
    merely assert that it is so when we attempt to use its inverse.

 src/cairo-pattern.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 7d853bcabcc1c55b79a05280a0eb35828b93163d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Aug 16 14:34:07 2007 +0100

    [cairo-boilerplate-xlib] Check for NULL xrender_format before use.
    
    Testing for XRender support (xrender_format != NULL) after
    dereferencing said format doesn't work as intended.

 boilerplate/cairo-boilerplate-xlib.c |   16 ++++++++++++----
 1 files changed, 12 insertions(+), 4 deletions(-)

commit bc635da45a32eb9b7aff6fa5f7f560ebf99092a8
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Aug 16 12:21:49 2007 +0100

    [cairo-ft-font] Decrement lock count on error.
    
    As noted in http://bugs.freedesktop.org/show_bug.cgi?id=12026 the error
    path of _cairo_ft_unscaled_font_lock_face() failed to reset the
    unscaled->lock_count before releasing the mutex and returning NULL.

 src/cairo-ft-font.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 8881265cca73790a49068b3bab5362cb73f8deb6
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Aug 10 20:10:29 2007 +0930

    PDF: Fix regression in pdf_surface_set_size()

 src/cairo-pdf-surface.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 4ca0ca153a847337452bbb237d42f6d7b0a163d0
Author: Søren Sandmann Pedersen <sandmann@redhat.com>
Date:   Mon Aug 6 19:24:31 2007 -0400

    Bump pixman dependency to 0.9.4
    
    Also print the download location if the library wasn't found.

 configure.in               |   11 +++++++----
 src/cairo-region-private.h |    2 +-
 src/cairoint.h             |    2 +-
 test/buffer-diff.c         |    2 +-
 4 files changed, 10 insertions(+), 7 deletions(-)

commit 13cae8b5e6d3fc93c4eb1853b91ba356b572b551
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Aug 6 11:06:47 2007 -0700

    Ensure that a copied pattern gets its own user_data array
    
    This fixes the bug reported here:
    
    	Segfault with cairo_pattern_set_user_data
    	https://bugs.freedesktop.org/show_bug.cgi?id=11855

 src/cairo-pattern.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 027915717df6e203826d10da7bfdf8e26af13ee1
Author: Nis Martensen <nis.martensen@web.de>
Date:   Wed Jul 4 07:09:00 2007 -0700

    Typo fixes in README files

 README      |    4 ++--
 perf/README |    6 +++---
 test/README |    6 +++---
 3 files changed, 8 insertions(+), 8 deletions(-)

commit 72c1f5d802c32f97ae5c0cbf899dc3a12fc28222
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Aug 5 00:50:23 2007 +0930

    PDF: Fix gradients regression

 src/cairo-pdf-surface.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit 9bcedd3d6f0de8c380e7ab4981d32377e3c5a778
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Fri Aug 3 14:18:40 2007 -0700

    [win32] compilation fix for win32

 src/cairo-win32-surface.c |   10 +++++-----
 1 files changed, 5 insertions(+), 5 deletions(-)

commit f52aa4c13e91339e575ca2c52c9e3a1f4d95b106
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Aug 2 21:25:46 2007 +0930

    CFF Subsetting: fix integer encoding bug
    
    Bug report at https://bugzilla.mozilla.org/show_bug.cgi?id=368668

 src/cairo-cff-subset.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit ef93f1897c0703c3284c85206cb1c70e23ff3fe5
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Jul 31 17:52:13 2007 -0400

    [configure.in] Cleanup after pixman removal and correctly check for pixman

 configure.in |   24 ++++--------------------
 1 files changed, 4 insertions(+), 20 deletions(-)

commit 4cce3135e0e50d5edb3a7cc54cf413fc2242a521
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Jul 26 18:04:39 2007 -0400

    Clear executable flag off .c file

 0 files changed, 0 insertions(+), 0 deletions(-)

commit 5b0e2e3e2b6823580bbc40dd1be415b7461bcbf0
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Jul 23 13:05:13 2007 +0100

    [cairo-glitz-surface] Compile fix.
    
    Minor corrections to reflect updated structures.

 src/cairo-glitz-surface.c |   19 +++++++++----------
 1 files changed, 9 insertions(+), 10 deletions(-)

commit c0a7d33ac6c81dd74ee2a9daaa3749a346ef4897
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Wed Jul 4 13:54:03 2007 +0200

    [fixpt] Fixup malloc usage to use _cairo_malloc_*
    
    Fix some introduced mallocs as a result of the fixed point patches.

 src/cairo-clip.c          |    2 +-
 src/cairo-glitz-surface.c |    2 +-
 src/cairo-image-surface.c |    2 +-
 src/cairo-pattern.c       |    2 +-
 src/cairo-xcb-surface.c   |    4 ++--
 src/cairo-xlib-surface.c  |    4 ++--
 6 files changed, 8 insertions(+), 8 deletions(-)

commit b719592428907d2010645303fb65d38dcb8b30c0
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Wed Jul 4 12:16:27 2007 +0200

    [fixpt] Fix up compilation post pixman merge

 src/cairo-pattern.c        |    1 -
 src/cairo-region-private.h |    2 +-
 src/cairo-region.c         |    9 +++++----
 src/cairo-svg-surface.c    |    6 +++---
 4 files changed, 9 insertions(+), 9 deletions(-)

commit 866b485314bfd5d8bbf865d19f6a589d08292e2a
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 18 18:38:54 2007 -0700

    [fixpt] Let the compiler calculate the magic double-to-fixed value

 src/cairo-fixed-private.h |   14 ++------------
 1 files changed, 2 insertions(+), 12 deletions(-)

commit 0abe5324a5b03149630a5b6496c980f83be4fd75
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 18 18:33:29 2007 -0700

    [fixpt] Create cairo_region wrapper around pixman_region16_t
    
    Insulate region-using code from implementation details;
    at some point we'll want to switch to using 32-bit regions.

 src/cairo-analysis-surface-private.h |    4 +-
 src/cairo-analysis-surface.c         |    4 +-
 src/cairo-clip-private.h             |    4 +-
 src/cairo-clip.c                     |  182 +++++++++++++++++----------------
 src/cairo-directfb-surface.c         |   25 +++--
 src/cairo-glitz-surface.c            |   65 ++++++++++--
 src/cairo-image-surface.c            |    4 +-
 src/cairo-pattern.c                  |   16 ++--
 src/cairo-region-private.h           |  105 +++++++++++++++++++
 src/cairo-region.c                   |  173 ++++++++++++++++++++++++++++++--
 src/cairo-surface-fallback.c         |   29 +++---
 src/cairo-surface.c                  |   63 +++++++------
 src/cairo-traps.c                    |   50 +++++-----
 src/cairo-win32-surface.c            |   28 ++++--
 src/cairo-xcb-surface.c              |   26 +++--
 src/cairo-xlib-surface.c             |   28 +++---
 src/cairoint.h                       |   38 ++++++--
 src/test-paginated-surface.c         |    2 +-
 18 files changed, 598 insertions(+), 248 deletions(-)

commit dc035fecda0070e18a68e06f567f268fc39483f1
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 18 17:34:36 2007 -0700

    [fixpt] Fix xcb surface to handle conversion to 16.16

 src/cairo-xcb-surface.c |   87 +++++++++++++++++++++++++++++++++++-----------
 1 files changed, 66 insertions(+), 21 deletions(-)

commit 58d9664702308639ead888c7167e71ca605a8fe3
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 18 17:33:44 2007 -0700

    [fixpt] Fix xlib surface to handle conversion to 16.16

 src/cairo-xlib-surface.c |   87 +++++++++++++++++++++++++++++++++++-----------
 1 files changed, 66 insertions(+), 21 deletions(-)

commit aaf94ef6c4656d7e836e52c2a71db214a1c01b57
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 18 17:29:04 2007 -0700

    [fixpt] remove dependency on some pixman types
    
    Introduce cairo_gradient_stop_t, and remove pixman dependency
    for core pattern types.  Perform conversion from cairo types
    to pixman types as necessary in fallback code.

 src/cairo-matrix.c           |   12 +++---
 src/cairo-pattern.c          |   97 ++++++++++++++++++++++++++++++-----------
 src/cairo-pdf-surface.c      |    8 ++--
 src/cairo-scaled-font.c      |    6 +-
 src/cairo-surface-fallback.c |   10 +++-
 src/cairo-svg-surface.c      |   87 +++++++++++++++++++------------------
 src/cairoint.h               |   27 ++++++------
 7 files changed, 150 insertions(+), 97 deletions(-)

commit e5fdacae1c5b7005b95db8f9065cce51ef19bf20
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 18 17:05:34 2007 -0700

    [fixpt] fix up image surface to translate to 16.16 for pixman

 src/cairo-image-surface.c |   76 ++++++++++++++++++++++++++++++++++++++------
 1 files changed, 65 insertions(+), 11 deletions(-)

commit be3516335cda8587d9baf5bd0097d3ce1cb64ab1
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 18 16:56:24 2007 -0700

    [fixpt] Replace cairo_rectangle_int16_t with cairo_rectangle_int_t
    
    Mostly s/cairo_rectangle_int16_t/cairo_rectangle_int_t/,
    as well as definitions to pick cairo_rectangle_int_t.

 src/cairo-analysis-surface.c         |    2 +-
 src/cairo-clip-private.h             |    6 ++--
 src/cairo-clip.c                     |   12 ++++----
 src/cairo-directfb-surface.c         |   16 +++++-----
 src/cairo-glitz-surface.c            |   20 ++++++------
 src/cairo-gstate.c                   |    2 +-
 src/cairo-image-surface.c            |   12 ++++----
 src/cairo-meta-surface.c             |    2 +-
 src/cairo-os2-surface.c              |   10 +++---
 src/cairo-paginated-surface.c        |    6 ++--
 src/cairo-pattern.c                  |   12 ++++----
 src/cairo-pdf-surface.c              |    4 +-
 src/cairo-ps-surface.c               |    4 +-
 src/cairo-quartz-private.h           |    2 +-
 src/cairo-quartz-surface.c           |   24 ++++++++--------
 src/cairo-rectangle.c                |   10 +++---
 src/cairo-region.c                   |    2 +-
 src/cairo-scaled-font.c              |    2 +-
 src/cairo-surface-fallback-private.h |    2 +-
 src/cairo-surface-fallback.c         |   52 +++++++++++++++++-----------------
 src/cairo-surface.c                  |   40 +++++++++++++-------------
 src/cairo-svg-surface.c              |    4 +-
 src/cairo-win32-private.h            |    4 +-
 src/cairo-win32-surface.c            |   16 +++++-----
 src/cairo-xcb-surface.c              |   18 ++++++------
 src/cairo-xlib-surface.c             |   18 ++++++------
 src/cairo.c                          |    2 +-
 src/cairoint.h                       |   48 +++++++++++++++++++------------
 src/test-fallback-surface.c          |   12 ++++----
 src/test-meta-surface.c              |    4 +-
 src/test-paginated-surface.c         |    2 +-
 31 files changed, 191 insertions(+), 179 deletions(-)

commit 9c38aa3b96a1e926ef422837fc3102e902a796fc
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 18 16:30:09 2007 -0700

    [fixpt] Use _cairo_fixed_mul insted of manual multiplication

 src/cairo-fixed-private.h |    1 -
 src/cairo-path-fixed.c    |   11 +++--------
 src/cairo-traps.c         |   26 +++++++++++---------------
 3 files changed, 14 insertions(+), 24 deletions(-)

commit 0048a26a4477d3acb5dd0231756cfaae92d240a9
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 18 16:26:14 2007 -0700

    [fixpt] Make fixed point methods static inline and generic
    
    Move the fixed point methods to static inline versions in
    cairo-fixed-private.h, and don't hardcode fixed to be 16.16.

 src/cairo-fixed-private.h  |  256 ++++++++++++++++++++++++++++++++++++++++++++
 src/cairo-fixed.c          |  100 +-----------------
 src/cairo-quartz-surface.c |    2 +-
 src/cairoint.h             |   37 +------
 4 files changed, 259 insertions(+), 136 deletions(-)

commit 76c32f899af63649bf911533a2ed6b42e617da41
Author: Vladimir Vukicevic <vladimir@frankenmac.mshome.net>
Date:   Mon Jul 2 15:09:21 2007 +0200

    [fixpt] Update quartz surface for new types

 src/cairo-quartz-surface.c |   20 ++++++++++----------
 1 files changed, 10 insertions(+), 10 deletions(-)

commit 290daee4ce26a931a15425f380ed4f495a4bd3c1
Author: Søren Sandmann <sandmann@redhat.com>
Date:   Tue Jul 10 10:31:23 2007 -0400

    Add note about pixman dependency in README

 README |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 1fac791537d2333b084e3fbabc1a6a890433e9ed
Author: Jinghua Luo <sunmoon1997@gmail.com>
Date:   Tue Jul 10 15:09:04 2007 +0800

    [Glitz] fix compilation.
    
    Separating pixman broke the compilation if glitz backend is enabled,
    fix it and all compiler warning as well.

 src/cairo-glitz-surface.c |  104 +++++++++++++++++++++++++++-----------------
 1 files changed, 64 insertions(+), 40 deletions(-)

commit 5819be398c4eada9a6cfc8e37a532991751b4a51
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Jul 5 18:59:31 2007 +0100

    [check-plt] Ignore entries for pixman.
    
    pixman is now an external library, so we now expect PLT entries.

 src/check-plt.sh |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 35ef8419a981929b65157407485ec001b69b3391
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Jul 5 18:52:21 2007 +0100

    [cairo-matrix] Check determinant for invalid numbers.
    
    By checking matrices for invalid determinants, we can prevent the
    setting and application of invalid matrices.
    
    The trick used here is that NaNs, as specified by IEE754, always
    return FALSE in comparisons. Since we know that the square of the
    determinant must be positive definite, then if the comparison is
    FALSE the computation must have resulted in a NaN.

 src/cairo-matrix.c    |    4 ++
 test/invalid-matrix.c |   94 ++++++++++++++++++++++++++++++++++++++++++------
 2 files changed, 86 insertions(+), 12 deletions(-)

commit 7eaba5d5fbf83f66b39db42a89db3e7a892c2ea0
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Jul 5 15:24:11 2007 +0100

    [configure] Only run PostScript tests if we have ghostscript.
    
    During configure check for the ghostscript command line tool (gs) before
    enabling the PostScript surface tests for make check.

 boilerplate/cairo-boilerplate.c |    2 +-
 configure.in                    |   14 ++++++++++++++
 2 files changed, 15 insertions(+), 1 deletions(-)

commit ef967be630dd8d0bf81ad5889d6264bebe7631d4
Merge: 0c42dbb... 5c7d2d1...
Author: Søren Sandmann Pedersen <sandmann@annarchy.freedesktop.org>
Date:   Mon Jul 2 08:33:29 2007 -0700

    Merge branch 'master' of git+ssh://sandmann@git.freedesktop.org/git/cairo
    
    Conflicts:
    
    	pixman/src/fbcompose.c
    	pixman/src/icimage.c
    	pixman/src/pixmanint.h
    	pixman/src/pixregionint.h
    	src/cairo-clip.c

commit 5c7d2d14d78e4dfb1ef6d2c40f0910f177e07360
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue Jun 19 13:15:21 2007 -0700

    [fix] Avoid int overflow when allocating large buffers
    
    This patch introduces three macros: _cairo_malloc_ab,
    _cairo_malloc_abc, _cairo_malloc_ab_plus_c and replaces various calls
    to malloc(a*b), malloc(a*b*c), and malloc(a*b+c) with them.  The macros
    return NULL if int overflow would occur during the allocation.  See
    CODING_STYLE for more information.

 CODING_STYLE                    |   25 +++++++++
 pixman/src/fbcompose.c          |    4 +-
 pixman/src/icimage.c            |    8 ++--
 pixman/src/pixman.h             |    7 +++
 pixman/src/pixmanint.h          |   17 ++++++
 pixman/src/pixregion.c          |   59 ++++++++++++++++++----
 pixman/src/pixregionint.h       |    1 -
 src/cairo-atsui-font.c          |    2 +-
 src/cairo-bentley-ottmann.c     |    6 +-
 src/cairo-beos-surface.cpp      |    4 +-
 src/cairo-clip.c                |   10 +++-
 src/cairo-directfb-surface.c    |    2 +-
 src/cairo-ft-font.c             |    4 +-
 src/cairo-glitz-surface.c       |   34 +++++++++++--
 src/cairo-gstate.c              |    6 +-
 src/cairo-hull.c                |    2 +-
 src/cairo-malloc-private.h      |  104 +++++++++++++++++++++++++++++++++++++++
 src/cairo-meta-surface.c        |    4 +-
 src/cairo-os2-surface.c         |    9 ++--
 src/cairo-path.c                |    2 +-
 src/cairo-pattern.c             |    6 +-
 src/cairo-pdf-surface.c         |    6 +-
 src/cairo-pen.c                 |    4 +-
 src/cairo-png.c                 |    6 +-
 src/cairo-polygon.c             |    2 +-
 src/cairo-ps-surface.c          |    4 +-
 src/cairo-quartz-surface.c      |    8 ++--
 src/cairo-scaled-font-subsets.c |    4 +-
 src/cairo-scaled-font.c         |    2 +-
 src/cairo-spline.c              |    2 +-
 src/cairo-stroke-style.c        |    2 +-
 src/cairo-surface-fallback.c    |    4 +-
 src/cairo-surface.c             |    2 +-
 src/cairo-svg-surface.c         |    2 +-
 src/cairo-traps.c               |    2 +-
 src/cairo-unicode.c             |    4 +-
 src/cairo-win32-font.c          |    6 +-
 src/cairo-win32-surface.c       |    6 +-
 src/cairo-xcb-surface.c         |    8 ++--
 src/cairo-xlib-surface.c        |    6 +-
 src/cairoint.h                  |    1 +
 41 files changed, 308 insertions(+), 89 deletions(-)

commit fc34073464c487405b6e2e0a5fa269a1ae15a02a
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Jun 27 14:38:41 2007 -0700

    Increment version to 1.5.1 after the 1.4.10 release

 configure.in |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 107a74885a25e585b467c7841c6929a12aa62565
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Jun 27 14:05:56 2007 -0700

    Increment cairo version to 1.4.10 (and libtool versioning to 13:5:11)

 configure.in |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit f595ad2348dbd97b57d22471fdec7664f8ca7bf6
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Jun 27 14:04:27 2007 -0700

    Add notes to NEWS for 1.4.10

 NEWS |   45 +++++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 45 insertions(+), 0 deletions(-)

commit 2bf3e31da99f34328973a0866346af40748097f6
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Jun 27 11:11:36 2007 -0700

    Prefer local dpy variable instead of display->display
    
    This was a tiny piece of cleanup that had been erroneously included
    with some earlier functional changes, (so it went through a cycle
    of being applied and reverted). It's back now in its own commit.

 src/cairo-xlib-display.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit eebb0df512da50f883a417bb5e8e368dc81e35a9
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Jun 27 11:08:53 2007 -0700

    Revert "[cairo-xlib-display] Hide XErrors during processing of the work queue."
    
    This reverts commit 285b702ef6f73e7eb4ca0da235a287ad1e1f412f.
    
    The recent commit of 0791f342b93225849d9171aac8b738014b18bdf5 fixes
    the same bug that 285b702e was fixing, but without introducing any
    performance-killing calls to XSync. So we can drop those now.

 src/cairo-xlib-display.c |   17 +++--------------
 1 files changed, 3 insertions(+), 14 deletions(-)

commit b019cb8a7a910879c7af304edbd06fd105c9d89e
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Jun 27 11:07:07 2007 -0700

    Revert "[cairo-xlib-surface] Check for errors before installing a NOOP error handler."
    
    This reverts commit 7016614dd90798247524f0c118f462aa2e7ef673.
    
    We want to avoid any negative performance impacts due to extra calls
    to XSync. The fact that X errors can be missed with this appraoch is
    undesirable of course---a proper fix will likely involve moving to
    XCB which will hopefully allow us to do the error-checking the way
    we want without any performance penalty.

 src/cairo-xlib-surface.c |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

commit 6d021eb4b6e319dd2bb3e5e126de07c6844d5c07
Merge: 9109946... 0791f34...
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Jun 27 11:01:00 2007 -0700

    Merge branch 'ooo-fix' into cairo

commit 0791f342b93225849d9171aac8b738014b18bdf5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Jun 27 10:53:29 2007 -0700

    Avoid deferring resource cleanup for application drawables
    
    This eliminates X errors propagated from cairo due to cleaning up
    Render Pictures after the application had already destroyed the
    Drawable they reference. (It would be nice if the X server wouldn't
    complain that some cleanup work is already done, but there you
    have it.)
    
    This fix has been verified to fix the bug causing OpenOffice.org to
    crash as described here:
    
    	XError on right click menus in OOo.
    	https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=243811
    
    And unlike other proposed fixes for this bug, this fix does not
    introduce any new calls to XSync, (and thereby avoids performance
    concerns from those).

 src/cairo-xlib-surface.c |   47 +++++++++++++++++++++++++--------------------
 1 files changed, 26 insertions(+), 21 deletions(-)

commit 0c42dbb1925efb8228fb5246e0715bee0a5ded28
Author: Søren Sandmann <sandmann@redhat.com>
Date:   Fri Jun 15 00:39:27 2007 -0400

    pixman_image_set_transform() returns FALSE on failure

 src/cairo-pattern.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit e0cff78b34558f0eed29aff5d818d1591c7bf966
Author: Søren Sandmann <sandmann@redhat.com>
Date:   Thu Jun 14 13:42:08 2007 -0400

    Fix bug where _cairo_image_surface_composite_trapezoids() computed the wrong stride for aliased masks

 src/cairo-image-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit ca5760a289f287a7fafe36e69c6bdf47710c17e7
Author: Søren Sandmann <sandmann@redhat.com>
Date:   Thu Jun 14 13:12:01 2007 -0400

    Fix initialization of radial patterns

 src/cairo-pattern.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 12cc32b674d3f1b705ef1a66bbce1ef8c4488daf
Author: Søren Sandmann <sandmann@redhat.com>
Date:   Wed Jun 13 00:15:34 2007 -0400

    [pixman] Initial port to standalone pixman library.

 Makefile.am                        |    4 +-
 configure.in                       |   14 +-
 pixman/.gitignore                  |   20 -
 pixman/AUTHORS                     |   19 -
 pixman/COPYING                     |   92 -
 pixman/ChangeLog                   | 1534 -------------
 pixman/ChangeLog.libic             |  300 ---
 pixman/ChangeLog.libpixregion      |   47 -
 pixman/ChangeLog.slim              |   39 -
 pixman/INSTALL                     |    9 -
 pixman/Makefile.am                 |    7 -
 pixman/NEWS                        |  135 --
 pixman/README                      |   47 -
 pixman/RELEASING                   |   81 -
 pixman/TODO                        |   10 -
 pixman/autogen.sh                  |   53 -
 pixman/configure.in                |   92 -
 pixman/libpixman.pc.in             |   10 -
 pixman/src/.gitignore              |   13 -
 pixman/src/Makefile.am             |   46 -
 pixman/src/Makefile.win32          |   37 -
 pixman/src/check-config.sh         |   17 -
 pixman/src/check-pixmanint.sh      |   17 -
 pixman/src/fbcompose.c             | 4354 ------------------------------------
 pixman/src/fbedge.c                |  303 ---
 pixman/src/fbedgeimp.h             |  136 --
 pixman/src/fbmmx.c                 | 2821 -----------------------
 pixman/src/fbmmx.h                 |  298 ---
 pixman/src/fbpict.c                | 2181 ------------------
 pixman/src/fbpict.h                |  355 ---
 pixman/src/fbtrap.c                |  236 --
 pixman/src/icblt.c                 |  951 --------
 pixman/src/icbltone.c              |  743 ------
 pixman/src/iccolor.c               |   83 -
 pixman/src/icformat.c              |  220 --
 pixman/src/icimage.c               |  744 ------
 pixman/src/icimage.h               |  384 ----
 pixman/src/icint.h                 | 1070 ---------
 pixman/src/icpixels.c              |  116 -
 pixman/src/icrect.c                |  404 ----
 pixman/src/icrop.h                 |  137 --
 pixman/src/icstipple.c             |   81 -
 pixman/src/ictransform.c           |   63 -
 pixman/src/ictrap.c                |  200 --
 pixman/src/ictri.c                 |  293 ---
 pixman/src/icutil.c                |  287 ---
 pixman/src/pixman-xserver-compat.h |  125 -
 pixman/src/pixmanint.h             | 1076 ---------
 pixman/src/pixregionint.h          |   75 -
 pixman/src/renderedge.c            |  196 --
 pixman/src/renderedge.h            |  157 --
 pixman/update.pl                   |  159 --
 src/Makefile.am                    |    6 +-
 src/cairo-clip.c                   |   36 +-
 src/cairo-glitz-surface.c          |  126 +-
 src/cairo-image-surface.c          |  314 ++--
 src/cairo-pattern.c                |   82 +-
 src/cairo-pdf-surface.c            |   40 +-
 src/cairo-ps-surface.c             |    2 +-
 src/cairo-surface-fallback.c       |    5 +-
 src/cairo-surface.c                |    9 +-
 src/cairo-svg-surface.c            |   31 +-
 src/cairo-traps.c                  |    4 +-
 src/cairo-xlib-surface.c           |   43 +-
 src/cairoint.h                     |   14 +-
 test/buffer-diff.c                 |   16 +-
 66 files changed, 398 insertions(+), 21221 deletions(-)

commit 9109946a1a7f9341e60da7358da6535c5fac52db
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Jun 21 15:40:23 2007 +0100

    [cairo-directfb] Correct minor typo.
    
    Correct the reference to _cairo_directfb_surface_is_similar.

 src/cairo-directfb-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 1e76aa66b23aa7b3fd7b9f7de2b563b4db814517
Author: Nis Martensen <nis.martensen@web.de>
Date:   Tue Jun 19 17:04:48 2007 +0200

    Update INSTALL about status of backends

 INSTALL |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit 02f753c23ad0db7d677ae41f8d69dc566c8aaa0b
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Jun 18 18:23:06 2007 -0700

    Fix cairo-perf-diff to compile cairo-perf explicitly

 perf/cairo-perf-diff |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 2477e57de532fb3ebd1f6113cf51619b84b303d9
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 18 13:58:15 2007 -0700

    [perf] Add pixman_region_init_rects and use in extract_region
    
    Avoid O(N*N) loop in traps_extract_region by letting us hand pixman
    an array of rects all at once.

 perf/Makefile.am          |    3 +-
 perf/cairo-perf.c         |    1 +
 perf/cairo-perf.h         |    1 +
 perf/long-dashed-lines.c  |   67 +++++++++++++++++++++++++++++++++++++++++++++
 pixman/src/pixman-remap.h |    1 +
 pixman/src/pixman.h       |    2 +
 pixman/src/pixregion.c    |   29 +++++++++++++++++++
 src/cairo-traps.c         |   58 +++++++++++++++++++++++++++-----------
 8 files changed, 144 insertions(+), 18 deletions(-)

commit 285b702ef6f73e7eb4ca0da235a287ad1e1f412f
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Jun 15 20:38:01 2007 +0100

    [cairo-xlib-display] Hide XErrors during processing of the work queue.
    
    It is possible for the resources that we defer freeing to be already
    destroyed and trigger an XError whilst processing the work queue. For
    example, the application renders to a Window and then destroys the
    Drawable before proceeding with more rendering. This will trigger an
    invalid Picture from RenderFreePicture whilst attempting to free the
    resources.
    
    By ignoring the possibility that the application could allocate a fresh
    resource with the same ID, we can simply hide the XErrors...
    
    Fixes: https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=243811

 src/cairo-xlib-display.c |   17 ++++++++++++++---
 1 files changed, 14 insertions(+), 3 deletions(-)

commit 7016614dd90798247524f0c118f462aa2e7ef673
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Jun 15 20:45:53 2007 +0100

    [cairo-xlib-surface] Check for errors before installing a NOOP error handler.
    
    Call XSync before ignoring errors from XGetImage to avoid hiding
    unassociated errors. Similarly, call XSync before reinstalling the old
    error handler to ensure no errors creep out of the ignored section.

 src/cairo-xlib-surface.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 0c5d28a4e5ce5e4dd72c0f416ce5e960e92b808b
Author: Ryan Lortie <desrt@desrt.ca>
Date:   Wed Jun 13 18:59:22 2007 -0400

    [xlib] Create source xrender Picture with IncludeInferiors
    
    When an xlib surface is used as the source of a draw operation this
    will cause the contents of child windows to be included in the source
    data.  The semantics of drawing to xlib surfaces are unchanged (ie:
    draws are still clipped by child windows overlapping the destination
    window).

 src/cairo-xlib-surface.c |   15 ++++++++++++++-
 1 files changed, 14 insertions(+), 1 deletions(-)

commit 817d4b0c9a354526389290c6d5a7662713d67cd8
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Jun 9 19:14:05 2007 +0100

    [atsui] Document ATSUI
    
    Add cairo_atsui_font_face_create_for_atsu_font_id
    and ATSUI to the documentation. Don't enable it yet,
    since this is still unsupported.

 doc/public/tmpl/cairo-atsui.sgml |    2 +-
 src/cairo-atsui-font.c           |   13 +++++++++++++
 2 files changed, 14 insertions(+), 1 deletions(-)

commit fd1edaa5d386f15edacfd5596b550593ed45d627
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Wed Jun 13 01:27:36 2007 +0100

    [quartz] remove unused code
    
    clean up warnings about unused code: removing
    _cairo_quartz_cairo_path_to_quartz_path and the functions
    it calls.

 src/cairo-quartz-surface.c |   47 --------------------------------------------
 1 files changed, 0 insertions(+), 47 deletions(-)

commit d7a0816ec3d750939dd935f34b217980ee27af3f
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Wed Jun 13 01:27:36 2007 +0100

    [quartz] move glyph array declarations
    
    Move declarations causing a warning. A separate patch from
    the other warning cleanups because it moves where the allocation
    happens.

 src/cairo-quartz-surface.c |   20 ++++++++++----------
 1 files changed, 10 insertions(+), 10 deletions(-)

commit bf39b28b77a83160e5aa037031d82f8c0843f387
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Wed Jun 13 01:04:54 2007 +0100

    commit 75be87b4093aaa7f477d587d5a68308cade1b29c
    
        [quartz] move glyph array declarations
    
        Move declarations causing a warning. A separate patch from
        the other warning cleanups because it moves where the allocation
        happens.

 src/cairo-quartz-surface.c |   27 +++++++++++++++------------
 1 files changed, 15 insertions(+), 12 deletions(-)

commit 2034d1dbd5888c393c57f0feeb707b0411fa4480
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Wed Jun 13 01:27:36 2007 +0100

    [quartz] pass quartz_stroke_t not CGContextRef
    
    Fix a typo where an incompatible pointer was being passed.

 src/cairo-quartz-surface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 54bbe44b08b37041c8982634837dbc79b19e6c18
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Jun 11 17:51:37 2007 -0400

    [TODO] Add link to Adrian's finer-grain fallback thread

 TODO |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit ef3c64fd13d66648f4e00affb304e8b404249f92
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Mon Jun 11 09:27:11 2007 -0700

    [misc] Blow away last remaining $Id$ directives in sources

 pixman/src/fbtrap.c                  |    2 --
 src/cairo-analysis-surface-private.h |    3 +--
 test/rel-path.c                      |    2 --
 3 files changed, 1 insertions(+), 6 deletions(-)

commit 853f23e18c28548bce4647d4e54a5cfb317ac3dc
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Jun 11 02:42:04 2007 -0400

    [test] Use check_PROGRAMS instead of custom made SUPPORT_PROGS
    
    It better handles $(EXEEXT) and is exactly made for this purpose.

 test/Makefile.am |   14 ++++++--------
 1 files changed, 6 insertions(+), 8 deletions(-)

commit 1d86c7fa888918c32eb13adb084de78883e17c84
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Jun 9 13:48:13 2007 -0400

    [perf] Link to librt if available
    
    This is needed on Solaris, but also works on Linux.

 configure.in     |    4 ++++
 perf/Makefile.am |    3 ++-
 2 files changed, 6 insertions(+), 1 deletions(-)

commit 85d045f2675cf191ea1d1af66ad4cd9e57d58e67
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Jun 8 16:08:44 2007 -0700

    Update version to 1.4.9 after the 1.4.8 release.

 configure.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit fea4f344c46cf5f85c6af3102333008768c55063
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Jun 8 15:49:12 2007 -0700

    Update version to 1.4.8 (and libtool info to 13:4:11)

 configure.in |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 0b19ff1d3f493067fa5484151e71dfcedcd14fd1
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Jun 8 15:34:35 2007 -0700

    Add include of X11/Xlib.h to cairo-xlib-xrender.h
    
    This makes this header file self-sufficient. Thanks to
    Sam Sirlin <samuel.w.sirlin@jpl.nasa.gov> for pointing
    this out.

 src/cairo-xlib-xrender.h |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 8223c976d54319b58906de03fcb8fb1967105e53
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Fri Jun 8 01:56:10 2007 +0100

    [NEWS] add note about quartz fixes
    
    We've got 11 less failures in the quartz tests this time around,
    worth a mention.

 NEWS |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 00063a65f758265f3ad5c0caa374d9c7d5e89932
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Fri Jun 8 01:17:09 2007 +0100

    [quartz] fix DO_IMAGE
    
    The implementation of DO_IMAGE leaks memory via a referenced surface,
    and wasn't applied for strokes and glyphs. This patch corrects those
    issues.

 src/cairo-quartz-private.h |    5 ++-
 src/cairo-quartz-surface.c |   83 +++++++++++++++++++++++++++-----------------
 2 files changed, 55 insertions(+), 33 deletions(-)

commit 39e6a0090faa4e73a658c1ca0ead3040309b84a2
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Fri Jun 8 01:12:24 2007 +0100

    [quartz] fall back on extended gradients
    
    A temporary fix for mozilla bug 379321, use an image fallback for
    gradients that use EXTEND_REPEAT or EXTEND_REFLECT.

 src/cairo-quartz-surface.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

commit 7c1afdcd597331c14f256f406a3e95743f7fdad6
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Mar 26 00:06:23 2007 +0100

    [quartz] fixes the offsets in the font-matrix test
    
    Apply the font matrix offset to text on the quartz surface, if necessary.

 src/cairo-quartz-surface.c |    6 +++++-
 1 files changed, 5 insertions(+), 1 deletions(-)

commit 55f1dbd0fbcbc587823ef8fa291a0af08441c775
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Apr 1 00:04:24 2007 +0100

    [quartz] ensure that line widths are scaled.
    
    cairo-gstate applies the ctm to the coordinates used in paths,
    but not to the line width. In quartz this ends up drawing unscaled
    lines. This is a minimal fix - it undoes the scaling applied to the
    points and then draws the path scaled correctly.

 src/cairo-quartz-surface.c |   72 ++++++++++++++++++++++++++++++++++---------
 1 files changed, 57 insertions(+), 15 deletions(-)

commit 5a9de1b5c9f6cc445f9f6230937c2254ee49e7cb
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Thu Jun 7 23:22:30 2007 +0100

    [atsui] remove unused code
    
    Remove CGAffineTransformMakeWithCairoFontScale.

 src/cairo-atsui-font.c |    8 --------
 1 files changed, 0 insertions(+), 8 deletions(-)

commit 807c5ab613e7df60be452d6683c4f9f045ef62a0
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Thu Jun 7 23:22:29 2007 +0100

    [atsui] clean up warnings
    
    Refactor code to get rid of compiler warnings.

 src/cairo-atsui-font.c |   11 +++++++----
 1 files changed, 7 insertions(+), 4 deletions(-)

commit b210b09e2de2f048debad6e8881f0226b6b17060
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Thu Jun 7 23:22:27 2007 +0100

    [quartz] implement CAIRO_EXTEND_REFLECT
    
    Implement extend-reflect by tiling a larger 2x2 grid of reflected
    images.

 src/cairo-quartz-surface.c |   64 ++++++++++++++++++++-----------------------
 1 files changed, 30 insertions(+), 34 deletions(-)

commit fa5dd548b0dd2dfe523501bd40cafe7916240be1
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Tue May 29 23:11:49 2007 +0100

    [quartz] implement CAIRO_EXTEND_NONE
    
    Implement extend-none for surface patterns, by using a single
    DrawImage where possible. There is some code duplication in this
    patch, to make it easier to edit this patch series without conflicts.
    A patch to remove duplicate code will be required later..

 src/cairo-quartz-surface.c |   61 ++++++++++++++++++++++++++++++++++++++++++-
 1 files changed, 59 insertions(+), 2 deletions(-)

commit 147288864c8c512f3ae17c8117d3c36dbbc6d5f8
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Thu Jun 7 23:22:05 2007 +0100

    [quartz] Refactor code to create a CGImageRef from a pattern
    
    In order to implement CAIRO_EXTEND_NONE we will need to create
    a CGImageRef without also creating a CGPattern. Separate the two
    pieces of code.

 src/cairo-quartz-surface.c |   40 +++++++++++++++++++++-------------------
 1 files changed, 21 insertions(+), 19 deletions(-)

commit a5ee983e1cb97aff63b0c9c3a57125b37d0e3f74
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Jun 7 15:03:43 2007 -0700

    Update release notes for 1.4.8

 NEWS |   75 ++++++++++++++++++++++++++++++++++++++++++-----------------------
 1 files changed, 48 insertions(+), 27 deletions(-)

commit e19c49269d0b236de91a5a9b5230bed7d76282ed
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Jun 7 12:19:46 2007 -0700

    Remove stale reference to cairo-xlib-test.h

 src/Makefile.am |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

commit 5ded4479d6ddbbe16c631144ef987c4c02e706a6
Author: Carl Worth <cworth@cworth.org>
Date:   Thu May 31 15:35:14 2007 -0700

    Fix return value of cairo_surface_write_to_png for unsupported formats
    
    For some reason this was returning CAIRO_STATUS_NULL_POINTER.
    Now fixed to return CAIRO_STATUS_INVALID_FORMAT.

 src/cairo-png.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit ec63a7839457e2d14c7b1a5b64d1a79daf044222
Author: Carl Worth <cworth@cworth.org>
Date:   Thu May 31 14:28:50 2007 -0700

    Add CAIRO_INTERNAL_FORMAT_RGB16_565 and prefer it over deprecated CAIRO_FORMAT_RGB16_565
    
    Also clarify the documentation for cairo_internal_format_t

 src/cairo-image-surface.c |    6 ++--
 src/cairoint.h            |   52 ++++++++++++++++++++++++++------------------
 2 files changed, 34 insertions(+), 24 deletions(-)

commit b6ee6c531c41adb57512fe0eaf21558e5d03f04b
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Jun 7 12:22:20 2007 -0400

    [NEWS] Add par about Chris 'ickle' Wilson's error-handling improvements work

 NEWS |   14 ++++++++++++++
 1 files changed, 14 insertions(+), 0 deletions(-)

commit 2399f923d504fba6b3dcbd0a185cd3d4b29b4dcf
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Jun 4 19:55:23 2007 +0100

    [cairo-bentley-ottmann] Malloc reduction.
    
    Attempt to allocate the edges during tessellate_polygon() from the stack,
    if the polygon size is sufficiently small and amalgamate the separate
    allocations for the list of events and their sorted index into a single
    block.

 src/cairo-bentley-ottmann.c |   28 +++++++++++++++-------------
 1 files changed, 15 insertions(+), 13 deletions(-)

commit ecf6f7f5147195276b3b479879cbd3db402df688
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Jun 4 16:35:15 2007 +0100

    [cairo-scaled-font] Skip the mask composition onto the surface on error.
    
    If we fail to composite the glyph onto the mask, skip compositing the
    mask onto the surface.

 src/cairo-scaled-font.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 2e60029392bca904f7035a8f403de0593193b6b9
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Jun 5 09:08:51 2007 +0100

    [cairo-ft-font] Markup error paths with _cairo_error().
    
    Behdad Esfahbod noted that in ff5af0f540ec4 I had introduce new error
    paths without the appropriate _cairo_error(). So review cairo-ft-font
    to ensure that _cairo_error() is called at the start of every error path,
    as close to the originating error as possible.

 src/cairo-ft-font.c |   58 ++++++++++++++++++++++++++++++++++++---------------
 1 files changed, 41 insertions(+), 17 deletions(-)

commit a5e12cd9f212b12a32230263188be38c175dc0a1
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu May 31 19:21:30 2007 -0400

    [ROADMAP] Add link for a8mask patch

 ROADMAP |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit ff5af0f540ec407beb3d2a105b22f041cd770ce4
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 30 15:44:59 2007 +0100

    [cairo-ft-font] Propagate error rather than asserting.
    
    FT_Set_Char_Size can fail due to an out-of-memory condition, so
    propagate the error status instead of asserting that it never fails.

 src/cairo-ft-font.c |   41 ++++++++++++++++++++++++++++++-----------
 1 files changed, 30 insertions(+), 11 deletions(-)

commit de4dd4263cb5183b128a8fc80576ed7ddb239319
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 11 15:15:11 2007 +0100

    [cairo] Propagate surface->status on cairo_t creation.
    
    Set the cairo_t status to be the surface->status when the context is
    created, and special case the NO_MEMORY status in order to avoid a
    redundant allocation.

 src/cairo-gstate.c |    2 +-
 src/cairo.c        |   12 +++++-------
 2 files changed, 6 insertions(+), 8 deletions(-)

commit 9f4efa8a3ae6cbc194d89012286990582a6c8f5d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 11 09:48:47 2007 +0100

    [cairo-ps-surface] Check status of glyph_lookup.
    
    Check for failure of _cairo_scaled_glyph_lookup() before preceeding to
    access the glyph and propagate the failure up the callstack as far as
    possible.

 src/cairo-ps-surface.c |   14 ++++++++++----
 1 files changed, 10 insertions(+), 4 deletions(-)

commit 8010d46de4056e6c15b6891a06ef3d784c641b82
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun May 27 11:40:47 2007 +0100

    [cairo-gstate] Check scaled font status.
    
    After using the public API to access the scaled font, which only sets
    the status field in the font, check the scaled font status. This will
    then correctly propagate errors during glyph loading to the context.

 src/cairo-gstate.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit faf986bb25eab34eee16415f4dab6f7d5d3460d3
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 29 12:39:16 2007 +0100

    [cairo-gstate] Check status on existing fonts.
    
    Add an initial guard in _cairo_gstate_ensure_scaled_font() and
    _cairo_gstate_ensure_font_face() to check that there is no prior
    error status on the objects.

 src/cairo-gstate.c |   41 +++++++++++++++++++++++------------------
 1 files changed, 23 insertions(+), 18 deletions(-)

commit ac4b20082dd6b2e2b280d3615eebf5387da87e2f
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue May 29 20:50:02 2007 -0700

    [misc] make _cairo_image_surface_nil_invalid static const

 src/cairo-image-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 0b34e958f18f0bcfb8bc9b054fb3bbb2343d2c32
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Tue May 29 17:14:41 2007 -0700

    [test] add XFAIL test surface-pattern-big-scale down
    
    Add test for image downscaling with large images severely limiting
    the destination coordinate space.  See the test for more information.

 test/Makefile.am                      |    2 +
 test/surface-pattern-big-scale-down.c |  121 +++++++++++++++++++++++++++++++++
 2 files changed, 123 insertions(+), 0 deletions(-)

commit 0898411d0abdfa6a02c2fb959b3a668e728fd87c
Author: Kouhei Sutou <kou@cozmixng.org>
Date:   Mon May 28 17:05:40 2007 -0400

    [doc] Minor documentation fixes

 src/cairo-matrix.c      |    2 +-
 src/cairo-pattern.c     |    2 +-
 src/cairo-scaled-font.c |    2 +-
 src/cairo.c             |   22 +++++++++++++++-------
 src/cairo.h             |    2 +-
 5 files changed, 19 insertions(+), 11 deletions(-)

commit 4da50dfa02d7c03c32ee20c15f8304eafa0844e0
Author: Luo jinghua <sunmoon1997@gmail.com>
Date:   Sun May 27 17:09:49 2007 +0800

    [cairo-xlib-surface]: flush work queue before sending glyphs to X server.
    
      After introducing a work queue for deferred destruction of X resource
    my firefox crashes over and over again because XRenderFreeGlyphs is trying
    to free a non-exist glyph (already freed). The problematic call sequence is
    something like below:
      XRenderAddGlyphs (20990204, 20069)
      XRenderAddGlyphs (20990204, 20069)
      XRenderFreeGlyphs (20990204, 20069)
      XRenderFreeGlyphs (20990204, 20069)
    You can see the two add/free glyphs is interlaced. And obviously, we'll crash
    at the last one. To fix this bug, we must be ensure here's no pending work
    to free the glyph that we want to sent.

 src/cairo-xlib-surface.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 69bf823db1b256f19487d2f002e7b0811859e58e
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Fri May 25 01:35:37 2007 +0100

    [atsui] use ATSGlyphGetScreenMetrics to measure glyphs.
    
    I don't know how I managed to get glyph measurement so badly wrong
    before, but tracing paths was not necessary, and 6x slower. The fix
    switches to using ATSGlyphGetScreenMetrics for all metrics, and remove
    the  old measuring code.

 src/cairo-atsui-font.c |   88 +++--------------------------------------------
 1 files changed, 6 insertions(+), 82 deletions(-)

commit 5b2b008048d2bcbb0b558a6c02aee1093311db39
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 11 10:14:57 2007 +0100

    [cairo-scaled-font-subsets] Shortcut empty subset.
    
    If the font_subset if empty, avoid allocating zero bytes and iterating
    over the empty hash table.

 src/cairo-scaled-font-subsets.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

commit c175cf7b833b03c38c8ddea183333ce84c6fdfec
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu May 17 17:04:14 2007 +0100

    [cairo-ft-font] Remove erroneous cached font faces.
    
    Only return a font face from the cache if it is not in an error condition.
    Otherwise unlink the bad font face from the cache and construct a new one.

 src/cairo-ft-font.c |   15 +++++++++++----
 1 files changed, 11 insertions(+), 4 deletions(-)

commit f382c3e110f8078e83cbb9d73cfbb43b1506a11b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 11 15:31:33 2007 +0100

    [cairo-pattern] Fully initialise the error pattern.
    
    _cairo_pattern_fini depends on the pattern being correctly initialised,
    for example when calling _cairo_user_data_array_fini(), so we need to
    initialize the whole pattern and not just set the type to SOLID when
    creating a pattern for a surface in error.

 src/cairo-pattern.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit fcdfda83655faf0eecbb2b5af09a05340fe422e6
Author: Boris Zbarsky <bzbarsky@MIT.EDU>
Date:   Mon May 14 23:46:14 2007 -0500

    [quartz] implementing release_source_image (#11059)
    
    The image surface that _cairo_quartz_surface_acquire_source_image creates never
    seems to be released, probably because there is no release_source_image callback
    in the quartz code.
    
    The attached patch fixes that problem, at least insofar as the image surface
    itself is no longer leaking.  I'm not sure whether any other cleanup needs to
    happen here.
    
    -Boris

 src/cairo-quartz-surface.c |   11 ++++++++++-
 1 files changed, 10 insertions(+), 1 deletions(-)

commit 2c8598aafb4a8779ce94940ce91033a8c5a62ea4
Author: Carl Worth <cworth@cworth.org>
Date:   Fri May 18 13:23:04 2007 -0700

    Fix typo in comment.

 src/cairo-pattern.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 3cb67435f805a8ea39f38194379f216ea4a69ed6
Author: Carl Worth <cworth@cworth.org>
Date:   Fri May 18 13:22:36 2007 -0700

    Document behavior of color stops added with identical offsets.

 src/cairo-pattern.c |   13 +++++++++++++
 1 files changed, 13 insertions(+), 0 deletions(-)

commit 1cf4ed989473e2468ea2d64bb7759084c9f6a1e4
Author: Carl Worth <cworth@cworth.org>
Date:   Fri May 18 13:16:23 2007 -0700

    ROADMAP: Add bugs for 565 and 655 Visuals to the list

 ROADMAP |    8 +++++---
 1 files changed, 5 insertions(+), 3 deletions(-)

commit 7260ee23ecb08e72a938a194e70dfb5e7a48c599
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri May 18 11:55:37 2007 -0400

    [Type1] #include <ctype.h> (#10989)

 src/cairo-type1-subset.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 6a42ddf0f9e9e4b8dc5fa6a98ef4448f1c149789
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu May 17 12:45:22 2007 +0930

    TrueType Subsetting: Remove post table
    
    The post table is not used now that TrueType fonts are embedded
    in PDF as CID fonts.

 src/cairo-truetype-subset.c |   34 +---------------------------------
 1 files changed, 1 insertions(+), 33 deletions(-)

commit 67e752f75fdc561aca419f798a1650feb22e59a4
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu May 17 11:48:25 2007 +0930

    CFF Subsetting: Filter out Unique ID from subset
    
    The subsetted font is not the same as the original font so it should not
    have the same XUID and UniqueID.

 src/cairo-cff-subset.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

commit 99a6983017e1cd27f8a598487f8a72cfa6d411f1
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu May 17 10:17:09 2007 +0930

    Ensure surface backend finish() is never called more than once.
    
    Previously if the backend finish() function returned an error status,
    surface->finished was not set true. This would result in the backend
    finish() function being called twice which in the case of the PostScript
    backend caused a seg fault.

 src/cairo-surface.c |    4 +---
 1 files changed, 1 insertions(+), 3 deletions(-)

commit c5ae0f1232e8cef860bc1fc0b449ddf9d9063d22
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 11 16:11:02 2007 +0100

    [cairo-truetype-subset] Avoid a potential 0 byte allocation.
    
    During _cairo_truetype_subset_init skip copying the string_offsets if
    the vector is empty.

 src/cairo-truetype-subset.c |   21 +++++++++++++--------
 1 files changed, 13 insertions(+), 8 deletions(-)

commit e37bee3f52282a042251f2dfc8e051943fd8f1d7
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 16 14:47:33 2007 +0100

    [cairo-pdf-surface] emit_pattern_stops() array overrun.
    
    _cairo_pdf_surface_emit_pattern_stops() tried to set the last element
    to have an offset of exactly 1.0, but missed and set the next element
    after the end of the array.

 src/cairo-pdf-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 27de1869f5a837b79812cd4b04e17621ec0f848c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 16 13:10:58 2007 +0100

    [cairo-pdf-surface] Free allstops on error.
    
    Ensure the locally allocated resources are freed on the error paths.

 src/cairo-pdf-surface.c |   18 +++++++++---------
 1 files changed, 9 insertions(+), 9 deletions(-)

commit 79e6c0207cb65b6bc1f38537f42632d623a1bc9a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 18:27:58 2007 +0100

    [cairo-pattern] Check for the nil surface.
    
    cairo_surface_create_similar() does not return NULL as was being checked
    for, but the nil surface on error. Also ensure that the returned surface
    is destroyed if we encounter an error whilst compositing.

 src/cairo-pattern.c |   26 ++++++++++++++++++++++----
 1 files changed, 22 insertions(+), 4 deletions(-)

commit 32c0ef9f145cec8b997c011b13208362eaf03004
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 16:20:00 2007 +0100

    [cairo-gstate] Remove a redundant conditional.
    
    Simplify _cairo_gstate_text_to_glyphs() with a tail call.

 src/cairo-gstate.c |    9 ++-------
 1 files changed, 2 insertions(+), 7 deletions(-)

commit 37d8c18b3fc489d6336131bae6ec219cafc35718
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 15:42:59 2007 +0100

    [cairo-scaled-font-subsets] Destroy the glyph if we fail to cache it.
    
    If we fail to insert the glyph into the sub_font glyph cache then we
    must destroy it before propagating the error.

 src/cairo-scaled-font-subsets.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 76e758df5b99fd4dee64481b9039b0d44dd01587
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 15:40:39 2007 +0100

    [cairo-truetype-subset] Destroy the arrays on error.
    
    Growing the arrays may successfully allocate the indirect pointer, but
    fail whilst allocating the actual array - so always call
    _cairo_array_fini after _cairo_array_grow_by().

 src/cairo-truetype-subset.c |   22 +++++++++++-----------
 1 files changed, 11 insertions(+), 11 deletions(-)

commit b63b32958e690409448ddc14e19b1856b9ef555a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 15:32:34 2007 +0100

    [cairo-scaled-font-subsets] Destroy the parent and subfont on error.
    
    If we fail to create the sub font destroy the local reference to the
    parent font and if we fail to insert the sub font into the hash table,
    destroy the newly create sub font.

 src/cairo-scaled-font-subsets.c |   16 ++++++++++++----
 1 files changed, 12 insertions(+), 4 deletions(-)

commit fcd1076bcffa20b7770a1b447a46232760972e2f
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 14:36:11 2007 +0100

    [cairo-ft-font] Destroy the path on error.
    
    During _decompose_glyph_outline() destroy the fixed path if we
    encounter an error.

 src/cairo-ft-font.c |   22 ++++++++++++----------
 1 files changed, 12 insertions(+), 10 deletions(-)

commit abb19e61cf076c62c7626094c70de0530bd9fd00
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 14:32:52 2007 +0100

    [cairo-ft-font] Destroy the unscaled reference on error.
    
    Release the reference to the unscaled font if we encounter an error
    whilst initialising the cairo_ft_scaled_font_t.

 src/cairo-ft-font.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit e4055f02a1f5a3d7942c7c2bb4f460ce0a8b5481
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 14:29:28 2007 +0100

    [cairo-ft-font] Race between unscaled removal from hash table and creation
    
    Small window of opportunity for the unscaled font to be destroyed and
    removed from the hash table before
    _cairo_ft_unscaled_font_create_for_pattern() takes a reference on behalf
    of its cairo. Close the window by taking the reference with the font
    map lock held.

 src/cairo-ft-font.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit f239308ef1014174d554ccaeab1fe7c2d84e26dc
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 13:27:09 2007 +0100

    [cairo-deflate-stream] Free the stream on error.
    
    Before returning the nil output stream, free the locally allocated
    stream when encountering an error during _cairo_deflate_stream_Create().

 src/cairo-deflate-stream.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 35a2ed03352a1abc42e441ce5f52f2704de9be85
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 12:36:47 2007 +0100

    [cairo-ft-font] Destroy surface if glyph transformation fails.
    
    As we allocated the surface we need to destroy it if we encounter an
    error.

 src/cairo-ft-font.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit 6a43c027238d2302f9e01ee7a780370d330def6c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 09:43:30 2007 +0100

    [cairo-xlib-screen] Increase number of GC depths.
    
    Add support for depths 12 and 30, and a separate unknown.

 src/cairo-xlib-private.h |    2 +-
 src/cairo-xlib-screen.c  |   14 ++++++++------
 2 files changed, 9 insertions(+), 7 deletions(-)

commit 70611846ded98ffa0f085f5a704979384b37e84c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 09:40:13 2007 +0100

    [cairo-xlib-surface] Always nullify GC after pushing to screen.
    
    The status return from _cairo_xlib_screen_put_gc() indicates the failure
    to queue a job to free an old GC - the current GC is always transferred
    away from the caller, so always nullify it in the surface.

 src/cairo-xlib-surface.c |   11 +++++------
 1 files changed, 5 insertions(+), 6 deletions(-)

commit 58c35e6d7b2e153dc9cd6ff89fa91497c507afaf
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 00:10:26 2007 +0100

    [cairo-paginated-surface] Check surface status during finish.
    
    Propagate children status during finish.

 src/cairo-paginated-surface.c |   11 +++++++++--
 1 files changed, 9 insertions(+), 2 deletions(-)

commit 9ffd8154e2ec2ccbeeefd3e4a34b2aa16844c1ce
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 11 23:43:53 2007 +0100

    [cairo-scaled-font-subsets] Correctly destroy the hash table.
    
    After an allocation failure in
    _cairo_scaled_font_subsets_create_internal() call
    _cairo_hash_table_destroy() instead of a mere free().

 src/cairo-scaled-font-subsets.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit bcfc5f0bdbd4c1eedc22bde5eed464a8bd18211e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 11 20:57:12 2007 +0100

    [pixman] Propagate allocation failure.
    
    pixman_op() failed to propagate the failure from
    pixman_region_appendNonO() and the generic op.

 pixman/src/pixregion.c |   24 +++++++++++++++++-------
 1 files changed, 17 insertions(+), 7 deletions(-)

commit 9e99f0611c834f80903e3554663f71682ef59ef3
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 11 20:38:24 2007 +0100

    [cairo-traps] Initialize traps to use embedded buffer.
    
    Set the traps to use the embedded buffer during initialization which will
    save one redundant _cairo_traps_grow()

 src/cairo-traps.c |   26 ++++++--------------------
 1 files changed, 6 insertions(+), 20 deletions(-)

commit 35eb65b7772459266e2f954fb370bfdca12b5b64
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 11 18:25:13 2007 +0100

    [cairo-path] Check for errors during the count.
    
    Return the nil object if we encounter any error whilst trying to
    generate the path.
    
    Also special case the NO_MEMORY error object to return the nil object.

 src/cairo-path.c |   10 +++++++++-
 1 files changed, 9 insertions(+), 1 deletions(-)

commit a60afb0e78ab42498158ef852fcea35c8f71e8ec
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 11 16:01:26 2007 +0100

    [cairo-scaled-font] Return status of _cairo_scaled_font_glyph_path()
    
    The status return of _cairo_path_fixed_interpret() was being ignored,
    propagate it.

 src/cairo-scaled-font.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit d46f6872a5fe601862e2f63455c97a15c4667cf2
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun May 13 21:52:52 2007 -0400

    [docs] Update to latest source changes and kill warnings

 doc/public/Headers.mk     |    1 +
 doc/public/Makefile.am    |    2 --
 doc/public/cairo-docs.xml |    6 +++---
 3 files changed, 4 insertions(+), 5 deletions(-)

commit 40558cb15e5f7276a29847b00c9dae08b9d9380e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 12 10:10:49 2007 +0100

    [cairo-xlib-screen] Clear the gc_needs_clip_reset after use.
    
    After consuming the GC we need to unset the clip reset flag, so that
    if we try and get a new GC without first putting a fresh one we do not
    try to call XSetClipMask on a NULL GC.
    
    (Fixes http://bugs.freedesktop.org/show_bug.cgi?id=10921)

 src/cairo-xlib-screen.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit abba3f2375c58401b7722837b3be37c3de9beca4
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu May 10 23:05:46 2007 +0100

    [valgrind-suppressions] Update to cover XrmGetStringDatabase
    
    By dropping the top frame from suppression, the XrmGetFileDatabase
    suppressions will also match XrmGetStringDatabase leaks which are
    starting to occur.

 test/.valgrind-suppressions |   42 ++++++++++++++----------------------------
 1 files changed, 14 insertions(+), 28 deletions(-)

commit c4abc3a0e3ebb27bc0aa178651e496c514eb1fae
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu May 10 21:28:48 2007 +0100

    [cairo-truetype-subset] Set CAIRO_STATUS_NO_MEMORY on malloc failure.
    
    _cairo_truetype_font_create() failed to update the status before
    returning after detecting an allocation failure, leaving its callers
    none the wishing - and eventually triggering a segmentation fault when
    the font was used in anger.

 src/cairo-truetype-subset.c |   16 ++++++++++++----
 1 files changed, 12 insertions(+), 4 deletions(-)

commit ebababc0cf83f828d48200b8e316f57912fb0128
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu May 10 19:24:54 2007 +0100

    [cairo-pattern] Return the nil cairo_pattern_t for CAIRO_STATUS_NO_MEMORY.
    
    If we asked to create a pattern after encountering an allocation failure,
    we can avoid another allocation by returning the nil pattern object.

 src/cairo-pattern.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit e8e5f93ffec8321c029c0b95abcb3cd8cadcff31
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu May 10 20:50:58 2007 +0100

    [cairo-meta-surface] Add a surface->status guard to meta_surface_replay()
    
    Before attempting to access the cairo_meta_surface_t specific members,
    we need to ensure that _cairo_meta_surface_replay() has received a true
    meta surface rather than an error surface (e.g. _cairo_surface_nil).

 src/cairo-meta-surface.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 195112697fac77e70ef36e00a2d557eda1e0e145
Author: elaine <elaine.xiong@sun.com>
Date:   Thu May 10 13:58:44 2007 -0400

    [xlib] The buggy_repeat path should be removed for Xsun now
    
    Sun never released a version of Solaris with Xorg with the buggy repeat
    problem.  This patch was only needed for development versions of Solaris
    Nevada (roughly builds 25-30).  The latest S10U release and Nevada releases
    have a fixed Xorg.  So no users should ever encounter this bug.
    
    We need to remove this test because Xsun has the same VendorString and a lower
    VendorRelease number so it falsely triggers buggy_repeat to be turned on.
    They just added Xrender support recently to Xsun, so this wasn't an issue
    before recently.

 src/cairo-xlib-surface.c |    3 ---
 1 files changed, 0 insertions(+), 3 deletions(-)

commit ab6a767cf476c98b466c62dd410d0f61f8dd6bbb
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu May 10 17:17:30 2007 +0100

    [cairo-scaled-font] Check for allocation failure.
    
    cairo_scaled_font_create() returns a nil object on failure whereas a few
    callers were checking for NULL.
    
    Secondly review the public entry points for cairo_scaled_font_*() to
    ensure that all check that they will not attempt to overwrite the
    read-only nil object.

 src/cairo-gstate.c              |    7 +++----
 src/cairo-scaled-font-subsets.c |    2 ++
 src/cairo-scaled-font.c         |   10 ++++++++--
 src/cairo-type1-fallback.c      |    2 +-
 4 files changed, 14 insertions(+), 7 deletions(-)

commit aec92188f1cf4ca34e890b0a4266425532f669d4
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu May 10 09:29:24 2007 +0100

    [cairo-clip] Correctly report allocation failure
    
    Distinguish between the unrepresentable clip and the failure to allocate
    the clip extents.

 src/cairo-clip.c |    7 +++++--
 1 files changed, 5 insertions(+), 2 deletions(-)

commit 1a719d1189243a76120b98371f84e074c8cd611e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu May 10 09:28:20 2007 +0100

    [cairo] Use _cairo_clip_nil for CAIRO_STATUS_NO_MEMORY
    
    When creating a error clip list for CAIRO_STATUS_NO_MEMORY, simply
    reuse the nil object rather than allocate a fresh list.

 src/cairo.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 3fbc4bb5ae27809f417ec2627fa515375e63a0e7
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 9 21:41:17 2007 +0100

    [cairo-clip] Add missing error status for _cairo__clip_intersect_region()
    
    An out-of-memory error path missed setting CAIRO_STATUS_NO_MEMORY.

 src/cairo-clip.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit b5d25068796d572b4b0c6e33eecc5f0736fb8f78
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 9 16:27:42 2007 +0100

    [cairo] cairo_pop_group() returns a NULL pattern
    
    cairo_pop_group() checks for a NULL return from
    cairo_pattern_create_for_surface() instead of the nil cairo_pattern_t,
    and then returns a NULL pattern instead of the nil object.

 src/cairo.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 6f09e93ad7ac4c941ba6c72b21ea4536d248f8d5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 9 13:39:08 2007 +0100

    [ciro-surface-fallback] Propagate status for _clip_and_composite_trapezoids
    
    The result of _clip_and_composite_trapezoids() was ignored by 2/3 of
    its callers - simply propagate the status.

 src/cairo-surface-fallback.c |   28 ++++++++++++++--------------
 1 files changed, 14 insertions(+), 14 deletions(-)

commit ae5d4a1c17a46c0a6ea2e4c825ecce7a5cbbe28b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 9 13:19:54 2007 +0100

    [cairo] Return after detecting the invalid font-options.
    
    Do not continue to copy the contents of the nil cairo_font_options_t,
    but set the error on the context and return.

 src/cairo.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit dfd4d41ac99dbe5d8ea16aa4ce4809b66308c803
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 9 12:30:40 2007 +0100

    [cairo-xlib-surface] Free the allocation if we fail to queue the work.
    
    Avoid the leak of the allocated argument if we fail to queue the work to
    free the glyph.

 src/cairo-xlib-surface.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit 8ddfc1b2e4aeefb704e05e64661b5c9985788e99
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 16:13:08 2007 +0100

    [cairo-pattern] Return status from _cairo_pattern_init_copy()
    
    During the copy, allocation of the gradient may fail and so the callers
    need to check for a pattern that returned in an error state. No callers
    did so and in order to force all callers to check the error status,
    the status return was added to _cairo_pattern_init_copy().  The early
    error checking may appear redundant for an object with an embedded
    structure, however it does fix an error where an uninitialised pattern
    was being used:
    
    ==1922== Process terminating with default action of signal 11 (SIGSEGV)
    ==1922==  Access not within mapped region at address 0x55555555
    ==1922==    at 0x402CF6F: _cairo_array_index (cairo-array.c:208)
    ==1922==    by 0x402D4F3: _cairo_user_data_array_fini (cairo-array.c:370)
    ==1922==    by 0x4046464: _cairo_pattern_fini (cairo-pattern.c:188)
    ==1922==    by 0x404992A: _cairo_meta_surface_paint (cairo-meta-surface.c:266)
    ==1922==    by 0x403FCE0: _cairo_surface_paint (cairo-surface.c:1331)
    ==1922==    by 0x405CB5E: _test_meta_surface_paint (test-meta-surface.c:195)
    ==1922==    by 0x403FCE0: _cairo_surface_paint (cairo-surface.c:1331)
    ==1922==    by 0x4032A60: _cairo_gstate_paint (cairo-gstate.c:822)
    ==1922==    by 0x402B2D1: cairo_paint (cairo.c:1879)
    ==1922==    by 0x804A4F7: draw (radial-gradient.c:73)
    ==1922==    by 0x804AFA4: cairo_test_expecting (cairo-test.c:326)
    ==1922==    by 0x804A57C: main (radial-gradient.c:109)
    ==1922== Injected fault at:
    ==1922==    at 0x4020EA5: malloc (vg_replace_malloc.c:207)
    ==1922==    by 0x404475C: _cairo_pattern_init_copy (cairo-pattern.c:136)
    ==1922==    by 0x403F779: _cairo_surface_copy_pattern_for_destination (cairo-surface.c:2153)
    ==1922==    by 0x403FCC1: _cairo_surface_paint (cairo-surface.c:1328)
    ==1922==    by 0x405CB5E: _test_meta_surface_paint (test-meta-surface.c:195)
    ==1922==    by 0x403FCE0: _cairo_surface_paint (cairo-surface.c:1331)
    ==1922==    by 0x4032A60: _cairo_gstate_paint (cairo-gstate.c:822)
    ==1922==    by 0x402B2D1: cairo_paint (cairo.c:1879)
    ==1922==    by 0x804A4F7: draw (radial-gradient.c:73)
    ==1922==    by 0x804AFA4: cairo_test_expecting (cairo-test.c:326)
    ==1922==    by 0x804A57C: main (radial-gradient.c:109)

 src/cairo-glitz-surface.c  |   12 +++++++--
 src/cairo-gstate.c         |   55 ++++++++++++++++++++++++++++++-------------
 src/cairo-meta-surface.c   |    6 ++++-
 src/cairo-pattern.c        |   30 +++++++++++++++++------
 src/cairo-quartz-surface.c |    6 ++++-
 src/cairo-surface.c        |   47 ++++++++++++++++++++++++++-----------
 src/cairoint.h             |    2 +-
 7 files changed, 113 insertions(+), 45 deletions(-)

commit dbdaf0690e1121d0f810dfb035e7a9f0dae17248
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 9 09:22:31 2007 +0100

    [cairo-scaled-font] Check _cairo_scaled_glyph_loop() status
    
    In _cairo_scaled_font_glyph_path() we forgot to check the status return
    of _cairo_scaled_glyph_loop() - propagate any failures.

 src/cairo-scaled-font.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit b744c2705184c24845423d661258b39bbb17749b
Author: James Cloos <cloos@jhcloos.com>
Date:   Wed May 9 02:50:59 2007 -0400

    [cairo-directfb-surface] Fix typo from commit a8c8e17d
    Fix typo in name of _cairo_directfb_surface_is_similar().

 src/cairo-directfb-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit cbc9218cd3f664682bcb5095c602adf9615535d0
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 9 09:03:04 2007 +0100

    [cairo-xcb-surface] Fix compilation
    
    As spotted by James Cloos <cloos@jbcloos.com>, I broke the compilation...
    This is a minimal fix with no claims of completeness.

 src/cairo-xcb-surface.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 069514a10ff2ca9ac86cc3dc1703aa19caa538e2
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 18:19:56 2007 +0100

    [test/in-fill-empty-trapezoid] Cleanup after test failure.
    
    Ensure that the failure path also calls cairo_test_fini().

 test/in-fill-empty-trapezoid.c |    8 +++++---
 1 files changed, 5 insertions(+), 3 deletions(-)

commit 43645eb486da1af91b3264af6c84ac18a1eddcaa
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 20:25:21 2007 +0100

    [test/fallback-resolution] Cleanup after test failure
    
    Be valgrind clean even for test failures.

 test/fallback-resolution.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit 21c6643b09c771454f913b444b6b040aaaacd3a8
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 21:28:48 2007 +0100

    [cairo-surface] Check for errors when generating the scaled font.
    
    cairo_surface_show_glyphs() attempts to generate a device specific
    scaled font and so needs to check for failure before attempting to use
    it.

 src/cairo-surface.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

commit ede76a97ea5b68c3bd042dc6a93ecb1aa7c9761c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 17:26:22 2007 +0100

    [cairo-font-options] Check for the nil-object.
    
    The design is for the user to create a cairo_font_options_t object with
    cairo_font_options_create() and then is free to use it with any Cairo
    operation. This requires us to check when we may be about to overwrite
    the read-only nil object.

 src/cairo-font-face.c    |    5 +++++
 src/cairo-font-options.c |    7 ++++++-
 src/cairo-gstate.c       |    4 +---
 src/cairo-scaled-font.c  |   10 ++++++++++
 src/cairo-surface.c      |    3 +++
 src/cairo.c              |   12 ++++++++----
 src/cairoint.h           |    3 ++-
 7 files changed, 35 insertions(+), 9 deletions(-)

commit c441938569ed78123a57662a70ef5a74dcf73851
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 21:40:26 2007 +0100

    [cairo-pattern] Cleanly handle an invalid pattern in cairo_pattern_transform()
    
    Simply return without writing to potentially read-only members of an
    invalid pattern rather than assert. This is cleaner than tracking down
    all the error paths that may call into cairo_pattern_transform()...

 src/cairo-pattern.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit 409f9734297be250de5e462e2d52e653bd893125
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 8 14:18:42 2007 -0400

    [test] If a test target fails, end the test
    otherwise cairo is left in a dirty state and further tests are
    unreliable.

 test/cairo-test.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit aad66d05fd0f310564e80c9ff59526028871751c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 16:40:24 2007 +0100

    [test/nil-surface] Destroy the auxiliary context on failure paths.
    
    Just to be tidy, and aim to be valgrind-clean.

 test/nil-surface.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

commit e3acacc096d7db947e7c8f2167a6d97f04c403b1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 16:35:14 2007 +0100

    [cairo-boilerplate-ps] Destroy the target on creation failure
    
    Remember to destroy the ptc->target as well as the ordinary surface, if
    we need to.

 boilerplate/cairo-boilerplate-ps.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit efd212bfa25cb44b9499b89f93aa7167a9544ccb
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 16:23:07 2007 +0100

    [cairo-boilerplate] Protect against the nil cairo_scaled_font_t
    
    Beware the NULL pointer deference when trying to adjust the max glyph
    cache size...

 boilerplate/cairo-boilerplate.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit b85920684f8feaba8d2d5b0262c60b4960c223b8
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 14:01:00 2007 +0100

    [cairo-test] Destroy the check image on failure
    
    If drawing the checker pattern should fail, we need to free the
    resources allocated locally.

 test/cairo-test.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 0bf3ffacda5dbfc4fd8a5a0d5fd37d9630f5bcdb
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 13:55:04 2007 +0100

    [test-fallback-surface] Destroy the backing image on malloc failure.
    
    Ensure we free all local resource should we encounter an allocation
    failure during _cairo_test_fallback_surface_create().

 src/test-fallback-surface.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit eac18d44c7559fe393abf6706b52e5a8edbfd5e9
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 8 12:46:42 2007 +0100

    [cairo-paginated-surface] Propagate malloc failure
    
    Check for an allocation failure during _cairo_analysis_surface_create()
    and propagate to caller - where we discover that the callers themselves
    missed the status checks...

 src/cairo-paginated-surface.c |   10 ++++++++--
 1 files changed, 8 insertions(+), 2 deletions(-)

commit 0d8a1540ec53ecc309a10e77ea7788fcd16d8345
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Tue May 8 09:11:57 2007 +0200

    SVG: Don't clip SVG element, as clipping region is implicit.
    
    That makes editing of produced SVG easier.

 src/cairo-svg-surface-private.h |    1 +
 src/cairo-svg-surface.c         |   53 +++++++++++++++++++--------------------
 2 files changed, 27 insertions(+), 27 deletions(-)

commit 936c965777c867bd4de7fd2278335837cc24eb22
Author: Jinghua Luo <sunmoon1997@gmail.com>
Date:   Tue May 8 13:24:40 2007 +0800

    glitz: kill some compiler warnings.

 src/cairo-glitz-surface.c |   11 +++++++++--
 1 files changed, 9 insertions(+), 2 deletions(-)

commit 413705872e321288bff1368c62eacad11805c2fc
Author: Jinghua Luo <sunmoon1997@gmail.com>
Date:   Tue May 8 13:19:35 2007 +0800

    glitz: fix a typo preventing build glitz backend from succeeding.

 src/cairo-glitz-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit d81907734e18fb9302e78eccb1e25a838223b726
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat May 5 12:33:29 2007 +0100

    [cairo-color] Only compare the shorts for equality.
    
    By only checking the premultiplied shorts inside the cairo_color_t we
    only have to compare at most 8 bytes instead of the full 24 bytes.

 src/cairo-color.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit 966a39396eb75d9d4ecc9997bb21d62fba176f78
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri May 4 15:25:18 2007 +0100

    [NEWS] Surface cache for solid patterns
    
    Add an entry describing the surface cache to NEWS.

 NEWS |   21 +++++++++++++++++++++
 1 files changed, 21 insertions(+), 0 deletions(-)

commit 056d149212ce4999f8984db62b880ff2eb998ab3
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 2 12:54:49 2007 +0100

    [cairo-pattern] Don't cache fallback surfaces
    
    _cairo_surface_create_similar_solid() may return an image surface,
    should the backend not support the required content or should it
    encounter an error whilst creating the surface. In those circumstances
    we choose not to cache the fallback surface.

 src/cairo-pattern.c |    8 +++++++-
 1 files changed, 7 insertions(+), 1 deletions(-)

commit a8c8e17d845c7060286dac58b553fb717b270788
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 2 10:00:22 2007 +0100

    [cairo-pattern] Cache surface for solid patterns
    
    Original work by Jorn Baayen <jorn@openedhand.com>,
    2715f2098127d04d2f9e304580a26cd0842c0e64
    
    We use a small cache of size 16 for surfaces created for solid patterns.
    This mainly helps with the X backends where we don't have to create a
    pattern for every operation, so we save a lot on X traffic.  Xft uses a
    similar cache, so cairo's text rendering traffic with the xlib backend
    now completely matches that of Xft.
    
    The cache uses an static index variable, which itself acts like a cache of
    size 1, remembering the most recently used solid pattern.  So repeated
    lookups for the same pattern hit immediately.  If that fails, the cache is
    searched linearly, and if that fails too, a new surface is created and a
    random member of the cache is evicted.
    
    A cached surface can only be reused if it is similar to the destination.
    In order to check for similar surfaces a new test is introduced for the
    backends to determine that the cached surface is as would be returned by
    a _create_similar() call for the destination and content.
    
    As surfaces are in general complex encapsulation of graphics state we
    only return unshared cached surfaces and reset them (to clear any error
    conditions and graphics state). In practice this makes little difference
    to the efficacy of the cache during various benchmarks. However, in order
    to transparently share solid surfaces it would be possible to implement a
    COW scheme.
    
    Cache hit rates:    (hit same index + hit in cache) / lookups
    cairo-perf:         (42346 + 28480) / 159600 = 44.38%
    gtk-theme-torturer: (3023  + 3502)  / 6528   = 99.95%
    gtk-perf:           (8270  + 3190)  / 21504  = 53.29%
    
    This translates into a reduction of about 25% of the XRENDER traffic during
    cairo-perf.

 src/cairo-directfb-surface.c   |   15 ++++-
 src/cairo-glitz-surface.c      |   40 ++++++++++++-
 src/cairo-image-surface.c      |   29 ++++++++-
 src/cairo-mutex-list-private.h |    3 +-
 src/cairo-pattern.c            |  135 +++++++++++++++++++++++++++++++++++-----
 src/cairo-pdf-surface.c        |    3 +
 src/cairo-surface.c            |   57 +++++++++++++++++
 src/cairo-win32-surface.c      |   29 ++++++++-
 src/cairo-xcb-surface.c        |   39 +++++++++++-
 src/cairo-xlib-surface.c       |   45 +++++++++++++-
 src/cairoint.h                 |   16 +++++
 11 files changed, 388 insertions(+), 23 deletions(-)

commit 52472b740e821dee444ede1fff041a99d344daab
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 1 18:34:47 2007 +0100

    [cairo-xlib-surface] Defer application of clip mask until required.
    
    By deferring the issuing of the X requests to set the clip mask we can
    theoretically avoid some redundant requests, but primarily we remove
    another path where X requests are emitted.

 src/cairo-xlib-surface-private.h |    7 ++++
 src/cairo-xlib-surface.c         |   72 ++++++++++++++++++--------------------
 2 files changed, 41 insertions(+), 38 deletions(-)

commit a81823cdf9a147d02bb2365558ba667ab52fb3c9
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Apr 20 17:32:25 2007 +0100

    [cairo-xlib-display] Allocate the close_display hooks from a freelist.
    
    Similar to job allocation, but only useful for toolkits like GTK+ which
    recreate a new xlib surface for each expose.

 src/cairo-xlib-display.c |  105 ++++++++++++++++++++++++---------------------
 src/cairo-xlib-private.h |    1 +
 2 files changed, 57 insertions(+), 49 deletions(-)

commit c29ffc64ca341623d21a7861f1b5f131b420d20f
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Apr 20 16:33:56 2007 +0100

    [cairo-xlib-display] Cache the screen_info for the lifetime of the display.
    
    Hold an extra reference to the screen_info and explicitly destroy the
    list of screens on CloseDisplay.

 src/cairo-xlib-display.c |   19 +++++++++++++++++++
 src/cairo-xlib-screen.c  |    3 +--
 2 files changed, 20 insertions(+), 2 deletions(-)

commit 1d6f7b7a0282d1b24bec82d9ad113b0d0a0cde98
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 19 13:01:52 2007 +0100

    [cairo-xlib] Cache freed GCs
    
    Maintain a cache of freed GCs, one for each used depth.

 src/cairo-xlib-display.c |    6 +++-
 src/cairo-xlib-private.h |   10 ++++++
 src/cairo-xlib-screen.c  |   70 ++++++++++++++++++++++++++++++++++++++++++++++
 src/cairo-xlib-surface.c |   22 ++++++++------
 4 files changed, 98 insertions(+), 10 deletions(-)

commit 88c6d25d4e53ddad6f3d465b2f5249c76a421b82
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Apr 17 12:03:07 2007 +0100

    [cairo-xlib-surface] Defer xlib resource cleanup.
    
    Due to caching, destruction of X11 resources may occur outside of a
    usable X11 context. To avoid this, we defer the destruction onto a work
    queue which will be run the next time we try to use the X11 connection
    on behalf of the user (at which point we must have a usable X11 context!)
    or we are closing the Display.

 src/cairo-xlib-surface.c |  180 +++++++++++++++++++++++++++++++++++++++------
 1 files changed, 156 insertions(+), 24 deletions(-)

commit 8ad30ccdb0a00701b15003edb2fe0cd4a8a9dfb7
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 19 12:15:04 2007 +0100

    [cairo-xlib] Introduce a workqueue for deferred destruction of X resources.
    
    Due to the nature of the reference counting, an X resource may be
    destroyed later than anticipated and possibly from a different thread
    than the original context. This becomes an issue for applications that
    carefully manage their single X connection from a single thread and do
    not use locking and are then suprised when cairo triggers X traffic when
    performing work for a different part of the application in another thread.

 src/cairo-xlib-display.c |  171 +++++++++++++++++++++++++++++++++++++++++++++-
 src/cairo-xlib-private.h |   18 +++++
 src/cairo-xlib-screen.c  |    1 -
 src/cairo-xlib-surface.c |   21 +++++-
 4 files changed, 205 insertions(+), 6 deletions(-)

commit dd8681b76b088bab45c99510258920f027490f70
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Apr 16 15:04:08 2007 +0100

    [cairo-xlib] Split per-display attributes from per-screen.
    
    Previously, we stored the per-display attributes inside a special
    screen=NULL _cairo_xlib_screen_info_t. Now we keep track of known X
    displays and store the screen information beneath the display structure
    alongside the per-display hooks.

 src/Makefile.am                |    8 +-
 src/cairo-debug.c              |    4 -
 src/cairo-mutex-list-private.h |    2 +-
 src/cairo-xlib-display.c       |  258 +++++++++++++++++++++++++++++++++
 src/cairo-xlib-private.h       |   37 ++++-
 src/cairo-xlib-screen.c        |  309 ++++++++-------------------------------
 src/cairo-xlib-surface.c       |    2 +-
 src/cairoint.h                 |    6 -
 8 files changed, 359 insertions(+), 267 deletions(-)

commit 9919f1ed9ccbec637252e06dd1de5f4665c873b4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu May 3 19:54:31 2007 -0400

    [TODO] Add link to cairo_copy_clip() proposal

 TODO |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit e5d9d51e55eb45704de6d98ac9265743af56711f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu May 3 19:04:21 2007 -0400

    [cairo-mutex] Fix typo.

 src/cairo-mutex.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit 5ec27eef9566faa22fb1cbaf1a103a57ba5296c8
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu May 3 13:46:25 2007 +0100

    [pixman] Free the old rects if we fail to allocate new.
    
    During the pixman_op, a complicated dance is performed to handle
    enlarging the rectangle array to accommodate the op. One consequence
    of this is to, under certain circumstances, replace the current
    rectangle array with emptyData and track the old array with oldData.
    Hence if we fail to realloc the enlarged array we need to free oldData.

 pixman/src/pixregion.c |    8 ++++++--
 1 files changed, 6 insertions(+), 2 deletions(-)

commit ef3070821713c33fab78abb191e27a62e165f6c6
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed May 2 16:22:13 2007 -0400

    [boilerplate] Fix typo

 boilerplate/xmalloc.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit c412e42c72c0ff53c678119638357ed95897ed78
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed May 2 21:17:39 2007 +0100

    [cairo-xlib-surface] Check that the acquire surfaces are xlib surfaces
    
    _cairo_pattern_acquire_surfaces() may substitute an image surface for
    either the source or the mask should the backend not support creation
    of similar scratch surfaces or an error occurs during creation. For
    composition we require xlib surfaces and so we must trigger the
    fallback path if this happens.

 src/cairo-xlib-surface.c |   10 ++++++++++
 1 files changed, 10 insertions(+), 0 deletions(-)

commit f3153091b742daffa853f2c31b76aa9689c5165a
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 20:10:39 2007 -0400

    [cairo-mutex] Document the API for adding cairo_mutex_t implementations

 src/cairo-mutex-type-private.h |   83 ++++++++++++++++++++++++++++++++++++++++
 1 files changed, 83 insertions(+), 0 deletions(-)

commit 5bfd6553fd028f1429d72c60d04788de4a3c0d58
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 19:48:33 2007 -0400

    [cairo-mutex] Define a NOOP CAIRO_MUTEX_FINALIZE() for pthread
    as now the mutex layer will define a generic CAIRO_MUTEX_FINALIZE()
    whenever the implementation defines CAIRO_MUTEX_FINI().  In the
    case of pthread however we don't need finalization as we don't
    have any place to call it, and pthread_mutex_destroy() doesn't
    do much anyway.

 src/cairo-mutex-type-private.h |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit c4e0a059feb9c2e0c32966dcb168861e75a244b7
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 19:46:51 2007 -0400

    [cairo-mutex] Remove NOOP definition of CAIRO_MUTEX_INITIALIZE
    as now the mutex layer will use a NOOP CAIRO_MUTEX_INITIALIZE
    by default if the implementation does not define CAIRO_MUTEX_INIT.

 src/cairo-mutex-type-private.h |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit 06cc74d974a99526829df558606174b41b0ee6e1
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 19:45:29 2007 -0400

    [cairo-mutex] Rewrite defaults for CAIRO_MUTEX macros not defined by the implementation
    to make them better match the design I have in mind, that I will
    document in a minute.  They are a lot more readable and understandable
    now.

 src/cairo-mutex-private.h |   93 ++++++++++++++++++++++++++++++++------------
 src/cairo-mutex.c         |   18 +++++++-
 2 files changed, 82 insertions(+), 29 deletions(-)

commit e87a25dc7c73a44b0cdfc4ef368736e7f77fb522
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 19:24:26 2007 -0400

    [cairo-mutex] Fix usage of CAIRO_MUTEX_DECLARE()
    
    Previously cairo-mutex.c was abusing cairo-mutex-private.h by
    defining CAIRO_MUTEX_DECLARE before including it, and
    cairo-mutex-private.h was simply not overriding any available
    CAIRO_MUTEX_DECLARE.  This is not the way it should be.
    cairo-mutex.c should instead define CAIRO_MUTEX_DECLARE and
    include cairo-mutex-list-private.h for itself.

 src/cairo-mutex-private.h |    4 +---
 src/cairo-mutex.c         |    9 +++++----
 2 files changed, 6 insertions(+), 7 deletions(-)

commit 1a33e44aa5d73f568c4164c41f9595964e9f1bbb
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 18:13:19 2007 -0400

    [RELEASING] Update GNOME URL to point to 2.19 planning page

 RELEASING |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 4764e6222bf4d5223fc2fbb139bb31a24819b2b5
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 00:50:03 2007 -0400

    [cairo-mutex] Improve error message if no thread implementation found
    
    to put back Carl's "acknowledge and accept" clause (!) before suggesting
    use of CAIRO_NO_MUTEX.

 src/cairo-mutex-type-private.h |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit b5f015f21f3c800919a85f03a081a3ec1648a794
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 00:48:33 2007 -0400

    [cairo-mutex] Make sure mutex implementation declares enough macros
    
    We have defaults for the rest.

 src/cairo-mutex-private.h |   11 +++++++++++
 1 files changed, 11 insertions(+), 0 deletions(-)

commit b0a0a1779dc5cc16423473b6d80ee5099793a47f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 00:47:02 2007 -0400

    [cairo-mutex] Make CAIRO_MUTEX_INIT/FINI take mutex object, not pointer to it
    
    This is more consistent with CAIRO_MUTEX_LOCK/UNLOCK.

 src/cairo-ft-font.c            |    4 ++--
 src/cairo-mutex-private.h      |    2 +-
 src/cairo-mutex-type-private.h |   19 +++++++------------
 src/cairo-mutex.c              |    4 ++--
 src/cairo-scaled-font.c        |    4 ++--
 5 files changed, 14 insertions(+), 19 deletions(-)

commit f9154f7eda4272ff99cc8a894082cc5aa1b008ef
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 00:44:42 2007 -0400

    [cairo-mutex] Make sure CAIRO_MUTEX_FINI() evaluates its argument once

 src/cairo-mutex-private.h      |    2 +-
 src/cairo-mutex-type-private.h |    3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

commit a8d47d0c001a36ddd6c9f09247e6eada408edb24
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 00:43:15 2007 -0400

    [cairo-mutex] Rename macro arguments from "name" to "mutex"

 src/cairo-mutex-private.h      |    6 +++---
 src/cairo-mutex-type-private.h |   20 ++++++++++----------
 src/cairo-mutex.c              |    4 ++--
 3 files changed, 15 insertions(+), 15 deletions(-)

commit f57a536fceec73435bb13c44275717792b9b3a8c
Author: Carl Worth <cworth@cworth.org>
Date:   Tue May 1 13:45:58 2007 -0700

    Increment version to 1.4.7 after the 1.4.6 release

 configure.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit ddca8fec07ff95caeda6e4ce9efc3239b146bd2d
Author: Carl Worth <cworth@cworth.org>
Date:   Tue May 1 13:37:16 2007 -0700

    perf: Add $(EXTRA_PROGRAMS) to CLEANFILES
    
    Otherwise these programs stick around and break distclean,
    distcheck, and hence release-publish targets.

 perf/Makefile.am |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 0390ed4f189365d595b40a45b0cf9eef5aa0c6ba
Author: Carl Worth <cworth@cworth.org>
Date:   Tue May 1 13:24:43 2007 -0700

    Increment version to 1.4.6 (and library versioning to 13:3:11)

 configure.in |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit c9e0bb5c79abfc50ae6a24f603c5493c3ac68e40
Author: Carl Worth <cworth@cworth.org>
Date:   Tue May 1 13:20:56 2007 -0700

    NEWS: Add notes for cairo 1.4.6

 NEWS |  116 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 116 insertions(+), 0 deletions(-)

commit 7f7f4d4f35cd640733b990fcff924a090b43d360
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 1 12:37:38 2007 +0100

    [cairo-xlib-surface.c] Free the Pixmap on surface construction failure.
    
    If we create the Pixmap whilst constructing a similar xlib surface, then
    it our responsibility to free the Pixmap should we fail to allocate the
    surface.

 src/cairo-xlib-surface.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 3e3bd4df7e810a9acd14cd6f3717633f71691b9e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue May 1 11:28:45 2007 +0100

    Minor typo in cairo_surface_destroy() documentation.
    
    The type of @surface is #cairo_surface_t, not #cairo_t.

 src/cairo-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit f7cdbd385a02d023e35357cd27dcc165ada667f2
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue May 1 00:41:07 2007 -0400

    [cairo-mutex-private.h] Move implementation-specific parts to cairo-mutex-type-private.h
    
    This fixes the problem reported by Dave Yeo that boilerplate wasn't building:
    
    In file included from ../src/cairo-scaled-font-private.h:44,
    	     from cairo-boilerplate.c:65:
    ../src/cairo-mutex-private.h:183: error: syntax error before "extern"
    ../src/cairo-mutex-private.h:184: error: syntax error before "void"
    ../src/cairo-mutex-private.h:185: error: syntax error before "void"
    make[3]: *** [cairo-boilerplate.lo] Error 1

 src/Makefile.am                 |    1 +
 src/cairo-mutex-private.h       |   81 +-----------------------
 src/cairo-mutex-type-private.h  |  131 +++++++++++++++++++++++++++++++++++++++
 src/cairo-scaled-font-private.h |    2 +-
 4 files changed, 135 insertions(+), 80 deletions(-)

commit 6de0f2d15775a451ead2cc3e80530b7dc6b321a3
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Apr 30 22:38:00 2007 -0400

    [cairo-mutex] Fix CAIRO_MUTEX_FINALIZE definition to take parantheses
    This was breaking build on some systems as reported by Adrian Johnson
    on the list.

 src/cairo-mutex-private.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 3f297a0fccb01f4e10a093ddc44a25a937364447
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Apr 30 22:00:31 2007 -0400

    [TODO] Add various items discussed recently

 TODO |   13 ++++++++++++-
 1 files changed, 12 insertions(+), 1 deletions(-)

commit 51440ad9027bd9ccf7d987c234995470f7699043
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Apr 30 21:57:29 2007 -0400

    [ROADMAP] Mark clipping trapezoids done

 ROADMAP |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 8ea48710dc933cd5dd52fb7d0c29eb8994a5d160
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Apr 30 19:20:56 2007 -0400

    [perf] Check availability before including nonstandard headers

 configure.in                 |    4 ++++
 perf/cairo-perf-diff-files.c |    2 ++
 perf/cairo-perf.c            |    6 +++++-
 3 files changed, 11 insertions(+), 1 deletions(-)

commit fbc8bf05033a652d26c1defa56d12183e4009870
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Apr 30 19:11:31 2007 -0400

    [perf] Don't build cairo-perf in "make all"

 perf/Makefile.am |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 4be608399f0d196a792f84fe4ddfce9acd2ea943
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sun Apr 29 19:29:24 2007 +0930

    Fix cygwin compile error
    
    The WINVER macros need to be defined before including <windows.h>.
    As a result of some recent include file rearranging, <windows.h>
    was included indirectly before WINVER was defined.

 src/cairo-mutex-private.h |   12 ------------
 src/cairo-win32-surface.c |   11 ++++++-----
 2 files changed, 6 insertions(+), 17 deletions(-)

commit a5d1fc923fdef354ceed8478c93e8b7cb734158a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Apr 30 16:05:36 2007 +0100

    Free all memory when cairo-perf exits.
    
    Similar to cairo-test, we free any global memory used by cairo for its
    caches through the debug interfaces. We do this so that valgrind does
    not unnecessary warn about memory leaks for the cached data and any true
    leak is then not lost in the noise.

 perf/cairo-perf.c |   19 +++++++++++++++++++
 1 files changed, 19 insertions(+), 0 deletions(-)

commit 7e6ab5461c2eb75c948bcb4725613ebe826c697a
Author: Carl Worth <cworth@cworth.org>
Date:   Sat Apr 28 07:46:56 2007 -0700

    Add missing prototypes for getline and strndup
    
    This is needed to prevent breaking the build for non-GNU systems.

 perf/cairo-perf-diff-files.c |   12 ++++++++++--
 1 files changed, 10 insertions(+), 2 deletions(-)

commit 422798db1d73c1a8ecc5877133b0325023f38e61
Author: Carl Worth <cworth@cworth.org>
Date:   Sat Apr 28 07:46:15 2007 -0700

    cairo-perf-diff-files: Add missing include of libgen.h for basename

 perf/cairo-perf-diff-files.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit d89d8e6b45b7c13b77aa7c2f1c480f58429b08af
Author: Carl Worth <cworth@cworth.org>
Date:   Sat Apr 28 07:45:26 2007 -0700

    pixman.h: Add missing definition of WARN_UNUSED_RESULT
    
    This was breaking the build on systems without support for the
    __warn_unused_result__ attribute.

 pixman/src/pixman.h |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit cb6fcdae92503964448144413e48ac388861d95f
Author: Carl Worth <cworth@cworth.org>
Date:   Sat Apr 28 07:38:56 2007 -0700

    Fix typo in Makefile preventing builds from succeeding
    
    The cairo-ps-surface-private.h file was not getting included in the
    distribution.

 src/Makefile.am |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit a392cc85081dd1e0fa3342c313af94a1e0c289b1
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Apr 27 22:46:47 2007 -0700

    Clarify documentation of cairo_in_stroke and cairo_in_fill
    
    Like cairo_stroke_extents and cairo_fill_extents, these functions
    work without regard to the surface dimensions or the current clip
    region.

 src/cairo.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit 8286b8741675ae163fc40187cd04e84395954c6e
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Apr 27 17:23:08 2007 -0700

    Clip trapezoids that are partially (or wholly) outside the clip region.
    
    It's quite simple to add a new _cairo_traps_limit call which installs
    a box into the cairo_traps_t structure. Then at the time of
    _cairo_traps_add we can discard any trapezoid that is wholly outside
    the box and also clip any trapezoid that is partially outside the box.
    
    We take advantage of this for both cairo_stroke and cairo_fill, (when
    cairo is computing the trapezoids in cairo-surface-fallback.c). Note
    that we explicitly do not do any clipping for cairo_stroke_extents,
    cairo_fill_extents, cairo_in_stroke, or cairo_in_fill which are
    defined to ignore clipping.
    
    As seen by the long-lines perf case, this fix successfully works
    around the bug in the X server where it creates overly large masks for
    partially-outside-the-destination-surface trapezoids:
    
     xlib-rgba   long-lines-uncropped-100  545.84 -> 5.83: 93.09x speedup
    ██████████████████████████████████████████████
     xlib-rgb    long-lines-uncropped-100  554.74 -> 8.10: 69.04x speedup
    ██████████████████████████████████

 src/cairo-surface-fallback.c |   52 ++++++++++++++++++++++++++++++++
 src/cairo-traps.c            |   68 +++++++++++++++++++++++++++++++++++++++++-
 src/cairoint.h               |    7 ++++
 3 files changed, 126 insertions(+), 1 deletions(-)

commit 2dcfb944b044172640a3784246d6b3129b686b60
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Apr 27 16:41:17 2007 -0700

    Don't test PDF tests known to fail due to poppler limitations
    
    The following four tests are disabled:
    
    	gradient-alpha, linear-gradient, text-pattern, trap-clip
    
    We don't use XFAIL as that would disable all backends, (but
    we can still usefully use these tests on backends other than
    PDF).

 boilerplate/cairo-boilerplate-pdf.c |   15 +++++++++++++++
 test/gradient-alpha.c               |    3 ++-
 test/linear-gradient.c              |    3 ++-
 test/text-pattern.c                 |    3 ++-
 test/trap-clip.c                    |    3 ++-
 5 files changed, 23 insertions(+), 4 deletions(-)

commit 179e3399101b5a0daa907dcfe1f9f11ae8fe691e
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Apr 27 16:01:56 2007 -0700

    PDF: Change CTM to identity
    
    Some PDF viewers forget the CTM when drawing gradient patterns
    with SMasks. This patch works around these bugs by using the default
    identity matrix for the CTM. All paths are transformed from
    cairo to pdf coordinates before writing to the pdf file.

 src/cairo-pdf-surface-private.h |    1 +
 src/cairo-pdf-surface.c         |  135 +++++++++++++++++++--------------------
 2 files changed, 67 insertions(+), 69 deletions(-)

commit 1816d7c590ae4d423f9314a8a7794e2cae854da3
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Apr 27 09:49:45 2007 -0700

    Add support for transparent gradients
    
    This is based on the gradient patch written by Miklós Erdélyi at
    http://lists.freedesktop.org/archives/cairo/2006-August/007648.html
    
    Currently only EXTEND_NONE and EXTEND_PAD are supported. Other extend
    types will go through the image fallback path.

 src/cairo-pdf-surface-private.h |   13 +
 src/cairo-pdf-surface.c         |  950 ++++++++++++++++++++++++++++++---------
 2 files changed, 752 insertions(+), 211 deletions(-)

commit 050dad71734739f1eaf8976ca5bb88e47c76409c
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 26 11:30:27 2007 -0700

    cairo-perf-diff-files: Always print old and new configuration names
    
    Previously, if the change in the first test case was small enough
    to be considered insignificant, then the header lines showing the
    names of the old and new configurations would be omitted. This
    commit fixes that bug.

 perf/cairo-perf-diff-files.c |   12 ++++++------
 1 files changed, 6 insertions(+), 6 deletions(-)

commit 6035d3b47e635f53b361dc7924e161a214e038b3
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 25 16:28:14 2007 -0700

    cairo-perf-diff: Repair command-line option parsing.
    
    Apparently --force and --html have been broken since the attempt
    to address --help in ef5611df6c6bc8d9c6877af3a59c66fa6fc5c13a .

 perf/cairo-perf-diff |   14 +++++++++-----
 1 files changed, 9 insertions(+), 5 deletions(-)

commit 0a1d2070e252921e097fec89537537675f8b7161
Author: Jeff Muizelaar <jeff@infidigm.net>
Date:   Wed Apr 25 16:01:29 2007 -0700

    Fix bugs in fbCompositeSrc_8888x8x8888mmx and fbCompositeSrc_x888x8x8888mmx
    
    And re-enable fbCompositeSrc_8888x8x8888mmx now that it should work.
    
    This gives another little boost to the paint-with-alpha perf test:
    
    image-rgba paint-with-alpha_image_rgba_over-512 11.76 -> 5.20: 1.85x speedup
    ▉
    image-rgb  paint-with-alpha_image_rgba_over-512 11.76 -> 5.26: 1.84x speedup
    ▉

 pixman/src/fbmmx.c  |   20 +++++++++-----------
 pixman/src/fbpict.c |    8 +++-----
 2 files changed, 12 insertions(+), 16 deletions(-)

commit 342de46eb4033e1cccfec8b905c0002cc880c9fb
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 25 10:25:57 2007 -0700

    Make the traditional speedup vs. slowdown report style available again
    
    Now, if you pass exactly two performance reports on the command line
    you'll get the traditional report style again, (so the tool remains
    backwards compatible). If you really want the new style with two
    reports you can get it by adding /dev/null as a third argument.

 perf/cairo-perf-diff-files.c |  112 ++++++++++++++++++++++++++++++++++++++---
 1 files changed, 103 insertions(+), 9 deletions(-)

commit db2a761ae7055a61d3705a76526cbd0b71fcc95d
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 25 08:53:46 2007 -0700

    Implement support for generating a report from more than two files
    
    This support is intended to compare the identical backends across multiple
    reports from several different configurations, (of one sort or another).
    The configuration names used in the report are taken from the filenames
    of the report files, (which will format most nicely if 8 characters or
    less).
    
    The traditional two-input report mode, (showing one line perdiff with
    all speedups before all slowdowns), is removed with this commit, but
    is intended to return again shortly.

 perf/cairo-perf-diff-files.c |  270 ++++++++++++++++++++++++------------------
 1 files changed, 157 insertions(+), 113 deletions(-)

commit 5030cfce5df507a0338e1070a5dab3851ed9df7c
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 19 16:32:57 2007 -0700

    cairo-perf-diff-files: Use pointers instead of indexing to iterate over reports
    
    We terminate the iteration by adding a final report with a NULL
    name. This will simplify future code that iterates over more than
    two reports simultaneously.

 perf/cairo-perf-diff-files.c |   31 ++++++++++++++++++-------------
 1 files changed, 18 insertions(+), 13 deletions(-)

commit 6121f4fccfe8d98fb09c096402da05d29d10b9e8
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 19 16:21:39 2007 -0700

    cairo-perf-diff-files: Simplify code to grow report->tests

 perf/cairo-perf-diff-files.c |   14 +++++---------
 1 files changed, 5 insertions(+), 9 deletions(-)

commit cc03f0499e7b133a2e5c14e55207259ea000b8c2
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 19 16:09:06 2007 -0700

    cairo-perf-diff-files: Sort and compute stats at the time of loading a report

 perf/cairo-perf-diff-files.c |  150 +++++++++++++++++++++---------------------
 1 files changed, 75 insertions(+), 75 deletions(-)

commit 228c83c9d2d1fdb6fa3af8a650640a47c8e21e36
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 19 14:35:51 2007 -0700

    cairo-perf-diff: Separate command-line options within the args structure
    
    A function like cairo_perf_report_diff wants the options, but really
    doesn't want/need to see the filenames for example,

 perf/cairo-perf-diff-files.c |   44 +++++++++++++++++++++++------------------
 1 files changed, 25 insertions(+), 19 deletions(-)

commit 876786b3f7316b99a51ba8225e34581be13a883d
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 19 13:54:50 2007 -0700

    Move implementation of getline and strndup
    
    These kept getting in my way as I looked for structure declarations
    at the top of the file.

 perf/cairo-perf-diff-files.c |  108 ++++++++++++++++++++---------------------
 1 files changed, 53 insertions(+), 55 deletions(-)

commit 90d532e08f25644c4e621b0b7e592f4531a39d88
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 19 13:52:03 2007 -0700

    Replace old and new reports with reports array
    
    Another baby step toward allowing comparison of more than two reports.

 perf/cairo-perf-diff-files.c |   11 +++++++----
 1 files changed, 7 insertions(+), 4 deletions(-)

commit c6c17633e40f549ede5761095a0652c08adeee08
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 19 13:31:37 2007 -0700

    Replace old_filename and new_filename with a filenames array
    
    More preparation for comparing more than two perf reports.

 perf/cairo-perf-diff-files.c |   30 +++++++++++++-----------------
 1 files changed, 13 insertions(+), 17 deletions(-)

commit 1849a7a8bededb281fbb07ec0939f8d1f4954771
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 19 12:55:04 2007 -0700

    cairo-perf-diff-files: Add new --min-change option, (replacing third positional argument)
    
    An upcoming change will allow cairo-perf-diff-files to generate
    a report based on more than two files. This prepares for that by
    moving the minimum-change support from the 3rd positional argument
    to a new --min-change option.

 perf/cairo-perf-diff-files.c |   39 +++++++++++++++++++++++----------------
 1 files changed, 23 insertions(+), 16 deletions(-)

commit ef5611df6c6bc8d9c6877af3a59c66fa6fc5c13a
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 19 11:26:47 2007 -0700

    cairo-perf-diff: Fix implementation of --help
    
    Previously only "--" would givethe usage, and not "--help"
    as intended. The new approach has been tested with ash, bash,
    and dash, (hopefully that's good enough).

 perf/cairo-perf-diff |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit a8d4fed67a32c6040c27615e063466d654b55a3a
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 19 10:02:22 2007 -0700

    cairo-perf-diff-files: Remove some overzealous option parsing.
    
    The code was complicated and confusing, and only existed to implement
    undocumented and unneeded command-line options.

 perf/cairo-perf-diff-files.c |   13 ++++++-------
 1 files changed, 6 insertions(+), 7 deletions(-)

commit fe9dd719561048af1f2c3c8c43e46f7d97575053
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 18 17:01:36 2007 -0700

    Correct misattribution of Mathias' work to Chris

 NEWS |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 29670d37665d184d78d568070cb409acf98ee797
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 23 10:24:03 2007 -0700

    Add a content value to solid patterns
    
    This allows for the surface acquired from the pattern to have the
    same content. In particular, in a case such as cairo_paint_with_alpha
    we can now acquire an A8 mask surface instead of an ARGB32 mask
    surface which can be rendered much more efficiently. This results
    in a 4x speedup when using the OVER operator with the recently
    added paint-with-alpha test:
    
    Speedups
    ========
    image-rgb  paint-with-alpha_image_rgb_over-256 2.25 -> 0.60: 4.45x speedup
    ███▌
    
    It does slowdown the same test when using the SOURCE operator, but
    I don't think we care. Performing SOURCE with a mask is already a very
    slow operation, (hitting compositeGeneral), so the slowdown here is
    likely from having to convert from A8 back to ARGB32 before the
    generalized compositing. So if someone cares about this slowdown,
    (though SOURCE with cairo_paint_with_alpha doesn't seem extremely
    useful), they will probably be motivated enough to contribute a
    customized compositing function to replace compositeGeneral in which
    case this slowdown should go away:
    
    image-rgba paint-with-alpha_image_rgb_source-256 3.84 -> 8.86%: 1.94x slowdown
    █

 src/cairo-clip.c             |    3 ++-
 src/cairo-glitz-surface.c    |    5 ++++-
 src/cairo-gstate.c           |    3 ++-
 src/cairo-pattern.c          |   41 ++++++++++++++++++++++++++---------------
 src/cairo-surface-fallback.c |   12 ++++++++----
 src/cairo-surface.c          |    2 +-
 src/cairo-xcb-surface.c      |    3 ++-
 src/cairo-xlib-surface.c     |    3 ++-
 src/cairo.c                  |    2 +-
 src/cairoint.h               |    9 ++++++---
 10 files changed, 54 insertions(+), 29 deletions(-)

commit fea5336e2db201be69256ef1bafd418fee98a21e
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 25 10:36:12 2007 -0700

    Allow fbCompositeSrc_x888x8x8888mmx when destination has alpha
    
    Previously the check for this optimized function would only allow
    the function to be called if the source and destination had
    identical formats. But the function doesn't read the destination
    alpha (if any) so can be used when it exists as well.
    
    (Thanks to Jeff Muizelaar for pointing out this problem.)

 pixman/src/fbpict.c |    8 +++++++-
 1 files changed, 7 insertions(+), 1 deletions(-)

commit 72b812be8c69108c46334841823a2e9103b69516
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 23 09:35:35 2007 -0700

    perf: Add new paint-with-alpha test
    
    MacSlow noticed that cairo_paint_with_alpha is much slower than
    it should be, (and jrmuizel has a nice plan for fixing the
    performance bug).

 perf/Makefile.am        |    1 +
 perf/cairo-perf.c       |    1 +
 perf/cairo-perf.h       |    1 +
 perf/paint-with-alpha.c |   45 +++++++++++++++++++++++++++++++++++++++++++++
 4 files changed, 48 insertions(+), 0 deletions(-)

commit 302f1146da5b179e5016e2d523e891437c1a256b
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 23 09:26:32 2007 -0700

    Fix two bugs in documentation code sample of cairo_arc
    
    The sample code for drawing an ellipse had width and height
    reversed in the call to cairo_scale, and also had both
    incorrectly inverted.

 src/cairo.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit e37c9edac02ccd9fbcbc4622a2f421f4be0d597e
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 24 17:33:37 2007 -0400

    [ROADMAP] Add cairo_xlib_surface_get_xrender_format()

 ROADMAP |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

commit ac0ef0302e68ba17ec5a59c689579f1854c7386c
Merge: d3cf214... 260dcb3...
Author: Peter Weilbacher <mozilla@weilbacher.org>
Date:   Mon Apr 23 23:18:05 2007 +0200

    Merge branch 'master' of git+ssh://pmw@git.freedesktop.org/git/cairo

commit 260dcb316e14945e7600406954e4876e8827a777
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Apr 23 13:54:37 2007 +0100

    Add a _cairo_error() to png_simple_error_callback()
    
    With the introduction of the error callbacks for PNG, we have the
    opportunity for the user to set a breakpoint (via _cairo_error) at the
    point the error is first rasied.

 src/cairo-png.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 0fce7e85a1c853216866ddf6a40725e7ce57fe93
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Apr 23 13:00:40 2007 +0100

    Do not print out libpng error messages to stderr.
    
    We wish to avoid writing to file descriptors (and streams) that are
    outside cairo's control. In this case, the messages are superfluous as
    the errors are propagated via the cairo_status_t returns.

 src/cairo-png.c |   31 +++++++++++++++++++++++++------
 1 files changed, 25 insertions(+), 6 deletions(-)

commit 59670dd5d3854af1f7cbdef984df7802c338330b
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Apr 23 05:19:56 2007 -0400

    [ROADMAP] Add URL to David Turner's patchset

 ROADMAP |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit ce91a176489f4cb8f40c5ec29f23881d1e013a9f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 22 16:13:22 2007 -0400

    [cairo-mutex] Add a poor man's mutex implementation in case of CAIRO_NO_MUTEX
    just for fun.

 src/cairo-mutex-private.h |   13 ++++++++-----
 1 files changed, 8 insertions(+), 5 deletions(-)

commit 97b50e99bfa785d77b4900d3070f22a22827db22
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 22 16:05:25 2007 -0400

    [BeOS] Remove old-style mutex initialization cruft

 src/cairo-beos-surface.cpp |   34 ----------------------------------
 1 files changed, 0 insertions(+), 34 deletions(-)

commit 0fd13a3db00e7e11915b5a7bbe81bf8f43f1941f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 22 16:04:49 2007 -0400

    [BeOS] Add mutex implementation

 src/cairo-mutex-private.h |   17 ++++++-----------
 1 files changed, 6 insertions(+), 11 deletions(-)

commit fc83784525d3f2bb3e09d931cc9c83261c0b73ae
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 22 15:56:18 2007 -0400

    [cairo-mutex] Properly paranthesize macro arguments

 src/cairo-mutex-private.h |   12 ++++++------
 1 files changed, 6 insertions(+), 6 deletions(-)

commit 406fc63b68203e86c9236d06448e2ffa2c259669
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 22 07:11:47 2007 -0400

    [util] Change make target from "tools" to "util"
    to match targets like "test", "perf", and "doc", that match
    their directory names.

 util/Makefile.am |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 5bc1f3365d0002f2864bc30638df85c392a495f5
Author: Peter Weilbacher <pmw@avila.aip.de>
Date:   Sun Apr 22 07:11:00 2007 -0400

    [perf] Add OS/2 implementation for timer routines

 perf/Makefile.am      |    4 ++
 perf/cairo-perf-os2.c |   95 +++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 99 insertions(+), 0 deletions(-)

commit 3b46e105bd781d7a4081068a14668334a7c82986
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 08:21:01 2007 -0400

    [util] Import my malloc wrapper that prints simple statistics
    
    To build, do:
    
    	make malloc-stats.so
    
    inside util/, and to use, run:
    
    	LD_PRELOAD=malloc-stats.so some-program
    
    For binaries managed by libtool, eg, cairo-perf, do:
    
    	../libtool --mode=execute /bin/true ./cairo-perf
    	LD_PRELOAD="../util/malloc-stats.so" .libs/lt-cairo-perf
    
    The code also includes Jeff Muizelaar's libbacktracesymbols that
    is a much better implementation of backtrace_symbols() than what
    is provided by glibc.  That can be built by:
    
    	make backtrace-symbols.so

 util/.gitignore          |   17 +++
 util/Makefile.am         |   22 +++
 util/backtrace-symbols.c |  361 ++++++++++++++++++++++++++++++++++++++++++++++
 util/malloc-stats.c      |  301 ++++++++++++++++++++++++++++++++++++++
 4 files changed, 701 insertions(+), 0 deletions(-)

commit d3cf2144dbd42737d5e2c45908fbca082dd54022
Merge: 6c12961... abdcbf8...
Author: Peter Weilbacher <mozilla@weilbacher.org>
Date:   Sat Apr 21 13:50:30 2007 +0200

    Merge branch 'master' of git+ssh://pmw@git.freedesktop.org/git/cairo

commit 6c129611408ddb5cf0a9a821b30bbb8148af08d9
Author: Peter Weilbacher <mozilla@weilbacher.org>
Date:   Sat Apr 21 13:49:04 2007 +0200

    Use deprecated png symbol only when compiling against old version
    
    png_set_gray_1_2_4_to_8 is deprecated in libpng >= 1.2.9, the identical
    substitute for it is png_set_expand_gray_1_2_4_to_8

 src/cairo-png.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

commit 515491334cc32d8be856f25b7d2e36e63cb72246
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 07:48:10 2007 -0400

    Add util/ to distribution
    We already reference an script in util/ in PORTING_GUIDE, but was
    not shipping it!

 Makefile.am      |    2 +-
 configure.in     |    1 +
 util/Makefile.am |    4 ++++
 3 files changed, 6 insertions(+), 1 deletions(-)

commit abdcbf896af69677058490d1d08ba58672c429ec
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 07:23:30 2007 -0400

    [boilerplate] Add missing headers.  Oops!
    I blame git for it...

 boilerplate/cairo-boilerplate-pdf.h  |   33 +++++++++++++++++++++++++++++++++
 boilerplate/cairo-boilerplate-xlib.h |   33 +++++++++++++++++++++++++++++++++
 2 files changed, 66 insertions(+), 0 deletions(-)

commit 781f2533a32d84ca43a1bdf646bb69b7adab7a77
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 07:21:38 2007 -0400

    [.gitignore] Add cairo-*.*.*

 .gitignore |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit febcd689e7a4b277bbebffd8ebdc0970a04f68eb
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 07:19:47 2007 -0400

    Update .gitignore to ignore .perf

 .gitignore |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit de425ada871c71277a53687dcd8a93a607d4faab
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 03:46:18 2007 -0400

    [doc/public/Headers.mk] Update.

 doc/public/Headers.mk |   13 ++++++++-----
 1 files changed, 8 insertions(+), 5 deletions(-)

commit 519b722747d606170741ccc520d6ec7332b2481f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 03:45:51 2007 -0400

    [RELEASING] Remove *-test.h from instructions
    as they are all removed now.

 RELEASING |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 0108f9c69f2f5391ff6b1066ae6b58fe3f71255a
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 03:44:53 2007 -0400

    [check-def.sh] Do not allow _cairo_.*_test_ symbols anymore
    as all are removed now.

 src/check-def.sh |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 79098c037043f45df0a18265417e96d6214d68e1
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 03:43:04 2007 -0400

    [scaled-font] Get rid of _cairo_scaled_font_test_set_max_glyphs_cached_per_font
    in favor of cairo_boilerplate_scaled_font_set_max_glyphs_cached.

 boilerplate/Makefile.am                     |    1 +
 boilerplate/cairo-boilerplate-scaled-font.h |   34 ++++++++++++++++++
 boilerplate/cairo-boilerplate.c             |   11 ++++++
 src/Makefile.am                             |    1 -
 src/cairo-scaled-font-private.h             |    1 +
 src/cairo-scaled-font-test.h                |   49 ---------------------------
 src/cairo-scaled-font.c                     |   14 ++------
 test/glyph-cache-pressure.c                 |    6 ++--
 8 files changed, 53 insertions(+), 64 deletions(-)

commit 44563161de82a5ee7bbf8f100213ea1a3af6d5db
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 03:38:24 2007 -0400

    Move a couple typedefs to cairo-types-private.h

 src/cairo-types-private.h |    2 ++
 src/cairoint.h            |    2 --
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 737d20a5702a18a1480c3b45f876e886b82b065c
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 03:35:07 2007 -0400

    Move cairo_hash_entry_t to cairo-types-private.h

 src/cairo-hash-private.h        |   38 --------------------------------------
 src/cairo-scaled-font-private.h |    2 ++
 src/cairo-types-private.h       |   38 ++++++++++++++++++++++++++++++++++++++
 3 files changed, 40 insertions(+), 38 deletions(-)

commit 51ce92c3db093c8d26c8002ddbc105b11e7607bf
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 03:24:31 2007 -0400

    [scaled-font] Move cairo_scaled_font_t to cairo-scaled-font-private.h

 src/Makefile.am                 |    1 +
 src/cairo-scaled-font-private.h |  109 +++++++++++++++++++++++++++++++++++++++
 src/cairo-scaled-font.c         |    1 +
 src/cairoint.h                  |   66 +-----------------------
 4 files changed, 112 insertions(+), 65 deletions(-)

commit 91f1056caf46d71c99eb044afbc943b92fb5550c
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 03:18:30 2007 -0400

    Move cairo_cache_t to cairo-types-private.h

 src/cairo-cache-private.h |    2 +-
 src/cairo-cache.c         |   11 -----------
 src/cairo-hash-private.h  |    4 ++--
 src/cairo-types-private.h |   14 ++++++++++++++
 4 files changed, 17 insertions(+), 14 deletions(-)

commit d2bb5f30079badf1029fa71faab9d6781092a271
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 03:08:26 2007 -0400

    [svg] Get rid of _cairo_svg_test_force_fallbacks
    in favor of cairo_boilerplate_svg_surface_force_fallbacks.

 boilerplate/Makefile.am             |    1 +
 boilerplate/cairo-boilerplate-svg.c |   19 ++++++++++++
 boilerplate/cairo-boilerplate-svg.h |   33 +++++++++++++++++++++
 src/Makefile.am                     |    4 +-
 src/cairo-svg-surface-private.h     |    2 +
 src/cairo-svg-surface.c             |   20 +------------
 src/cairo-svg-test.h                |   54 -----------------------------------
 test/fallback-resolution.c          |    4 +-
 8 files changed, 60 insertions(+), 77 deletions(-)

commit ea1b7c2d8a55d694d575c0bb711e60f70a33ff77
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 03:04:03 2007 -0400

    [paginated] Include cairo-surface-private.h

 src/cairo-paginated-surface-private.h |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 7e0ae8bd43dfd8b052d021601912b46956b2921e
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 02:57:55 2007 -0400

    [svg] Move cairo_svg_surface_t to cairo-svg-surface-private.h

 boilerplate/cairo-boilerplate-ps.c |    6 +++-
 src/Makefile.am                    |    2 +-
 src/cairo-svg-surface-private.h    |   71 ++++++++++++++++++++++++++++++++++++
 src/cairo-svg-surface.c            |   24 +------------
 4 files changed, 78 insertions(+), 25 deletions(-)

commit 3885fff3e6215023e801dd2c72fc39560a4e22fd
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 03:33:58 2007 -0400

    [ps] Get rid of _cairo_ps_test_force_fallbacks
    
    in favor of cairo_boilerplate_ps_surface_force_fallbacks.

 boilerplate/Makefile.am            |    1 +
 boilerplate/cairo-boilerplate-ps.c |   15 ++++++++++
 boilerplate/cairo-boilerplate-ps.h |   33 ++++++++++++++++++++++
 src/Makefile.am                    |    2 +-
 src/cairo-ps-surface-private.h     |    3 +-
 src/cairo-ps-surface.c             |   24 +--------------
 src/cairo-ps-test.h                |   54 ------------------------------------
 test/fallback-resolution.c         |    4 +-
 8 files changed, 56 insertions(+), 80 deletions(-)

commit 57dc972d6e5fe715a83cbcaad9c6cc3d38bf8129
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 03:02:48 2007 -0400

    [ps] Move cairo_ps_surface_t to cairo-ps-surface-private.h

 src/Makefile.am                |    2 +-
 src/cairo-ps-surface-private.h |   79 ++++++++++++++++++++++++++++++++++++++++
 src/cairo-ps-surface.c         |   33 +----------------
 3 files changed, 81 insertions(+), 33 deletions(-)

commit 3e69fbca6233e9f568935dbb69bf14bc34812d77
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 03:00:21 2007 -0400

    [pdf] Fix header file header!

 src/cairo-pdf-surface-private.h |   12 +++++++++---
 1 files changed, 9 insertions(+), 3 deletions(-)

commit 29247e5010632f0453367b64a38c865076605681
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 02:57:12 2007 -0400

    [ps/pdf/svg] Fix minor coding style issue

 src/cairo-pdf-surface.c |   12 ++++++------
 src/cairo-ps-surface.c  |    2 +-
 src/cairo-svg-surface.c |   14 +++++++-------
 3 files changed, 14 insertions(+), 14 deletions(-)

commit 20ce190e71f838dea598cbd5267f047b75945cee
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 02:50:53 2007 -0400

    [pdf] Get rid of _cairo_pdf_test_force_fallbacks
    in favor of cairo_boilerplate_pdf_surface_force_fallbacks.

 boilerplate/Makefile.am             |    1 +
 boilerplate/cairo-boilerplate-pdf.c |   19 ++++++++++++
 src/cairo-pdf-surface-private.h     |    2 +
 src/cairo-pdf-surface.c             |   25 ++--------------
 src/cairo-pdf-test.h                |   54 -----------------------------------
 test/fallback-resolution.c          |    4 +-
 6 files changed, 27 insertions(+), 78 deletions(-)

commit 03477064fa639ab1c735467d1889bde7c99313c4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 21 02:25:51 2007 -0400

    [paginated] Move cairo_paginated_surface_t to cairo-paginated-surface-private.h
    The old cairo-paginated-surface-private.h is cairo-paginated-private.h now.

 src/Makefile.am                       |    1 +
 src/cairo-analysis-surface.c          |    2 +-
 src/cairo-paginated-private.h         |  136 +++++++++++++++++++++++++++++++++
 src/cairo-paginated-surface-private.h |  116 ++++++----------------------
 src/cairo-paginated-surface.c         |   32 +-------
 src/cairo-pdf-surface.c               |    2 +-
 src/cairo-ps-surface.c                |    2 +-
 src/cairo-svg-surface.c               |    2 +-
 src/cairo-types-private.h             |    1 +
 src/test-paginated-surface.c          |    2 +-
 10 files changed, 170 insertions(+), 126 deletions(-)

commit 21a7de61c26faaaa1ce96cddab6d777dbb37d0bb
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 02:52:53 2007 -0400

    [boilerplate] Add cairo-boilerplate-xlib.h to Makefile.am

 boilerplate/Makefile.am |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 68e2158aaeacefcff8e6df11c25bb61ab0e89606
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 02:37:15 2007 -0400

    [pdf] Move cairo_pdf_surface_t to cairo-pdf-surface-private.h

 src/Makefile.am                         |    3 +-
 src/cairo-output-stream-private.h       |    2 +-
 src/cairo-pdf-surface-private.h         |   83 +++++++++++++++++++++++++++++++
 src/cairo-pdf-surface.c                 |   42 +---------------
 src/cairo-scaled-font-subsets-private.h |    2 -
 src/cairo-types-private.h               |    3 +
 6 files changed, 90 insertions(+), 45 deletions(-)

commit 183c6af4f1730861a604a912a0609e315da65ecc
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 02:30:46 2007 -0400

    [paginated] Move cairo_paginated_mode_t to cairo-types-private.h
    
    as it is used in surface structs for PS/PDF/SVG and we will need
    it.

 src/cairo-paginated-surface-private.h |    5 -----
 src/cairo-types-private.h             |    5 +++++
 2 files changed, 5 insertions(+), 5 deletions(-)

commit cd72167ede50b44aa3559ee63b95e12e4b51d80f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 02:27:19 2007 -0400

    [xlib] Get rid of _cairo_xlib_test_disable_render
    
    in favor of cairo_boilerplate_xlib_surface_disable_render.

 boilerplate/cairo-boilerplate-xlib.c |   15 +++++++++
 src/Makefile.am                      |    2 +-
 src/cairo-xlib-surface.c             |   23 +--------------
 src/cairo-xlib-test.h                |   54 ----------------------------------
 test/xlib-surface.c                  |    8 +++--
 5 files changed, 22 insertions(+), 80 deletions(-)

commit 908418cb4d43e387d06698a43626ac9a663d6c2a
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 02:25:55 2007 -0400

    [cairo-surface] Move cairo_surface_t struct in cairo-surface-private.h

 src/Makefile.am                  |    2 +
 src/cairo-surface-private.h      |   96 ++++++++++++++++++++++++++++++++++++++
 src/cairo-types-private.h        |   65 +++++++++++++++++++++++++
 src/cairo-xlib-private.h         |    1 -
 src/cairo-xlib-surface-private.h |    2 +
 src/cairoint.h                   |   74 +----------------------------
 6 files changed, 167 insertions(+), 73 deletions(-)

commit 8ae02fa470eace1b449c09b6cd0f86cc09b81ec2
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 01:54:35 2007 -0400

    [boilerplate] Minor indentation fix

 boilerplate/cairo-boilerplate-xlib-private.h |   12 ++++++------
 1 files changed, 6 insertions(+), 6 deletions(-)

commit 1345552ac24099900acdb968f905d6e75cc20593
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 01:46:23 2007 -0400

    [xlib] Move cairo_xlib_surface_t definition into cairo-xlib-surface-private.h

 src/Makefile.am                  |    3 +-
 src/cairo-xlib-surface-private.h |   91 ++++++++++++++++++++++++++++++++++++++
 src/cairo-xlib-surface.c         |   54 +----------------------
 3 files changed, 94 insertions(+), 54 deletions(-)

commit 735be3f09d1d150909305ff3232fda42efcb87bd
Author: Peter Weilbacher <pmw@avila.aip.de>
Date:   Fri Apr 20 20:46:55 2007 +0200

    Fix build break related to mutexes on OS/2
    
    cairo_mutex_t is HTMX which is ULONG on OS/2, so we have to set the
    mutex itself to 0 and not the address...

 src/cairo-mutex-private.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 5135bcf414abc91e7777e2c024c9b6e10bf6115c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Apr 20 19:08:07 2007 +0100

    cairo-boilerplate - use xmalloc and friends
    
    Prefer to abort gracefully if we run out of memory (or simply to protect
    them from memfault).

 boilerplate/cairo-boilerplate.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit b6be361d0ef3b81ef5cbc28852f323a671e3d030
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Apr 20 17:49:10 2007 +0100

    Clean up compiler warnings from cairo-png
    
    I introduced some compiler warnings into read_png() with the superfluous
    introduction of a couple of volatile qualifiers. I'm sure at the time,
    the reason was that gcc suggested adding them - however, ATM gcc issues
    no warnings without them.

 src/cairo-png.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit fc455c53ecb0aa496915b1eae68dc0275af78e09
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Sat Apr 21 00:26:25 2007 +0930

    Ensure _cairo_scaled_font_subsets_map_glyph() returns correct values
    
    The CID font subsetting exposed a bug where the subset_glyph->is_scaled
    return argument of _cairo_scaled_font_subsets_map_glyph() is sometimes
    not assigned a value.

 src/cairo-scaled-font-subsets.c |   55 +++++++++++++++------------------------
 1 files changed, 21 insertions(+), 34 deletions(-)

commit 9d8eb42c013d197b3365af88e372d1c2c1617173
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Apr 20 22:45:12 2007 +0930

    Exclude Type1 fonts from CID subsets
    
    Make cairo-scaled-font-subsets.c limit Type1 font subsets to
    256 glyphs. This allows Type1 subsetting to be enabled again
    with type1-fallback as the fallback option for Type1 fonts.

 src/cairo-pdf-surface.c                 |   42 ++++++++++++++----------------
 src/cairo-scaled-font-subsets-private.h |   11 +++++++-
 src/cairo-scaled-font-subsets.c         |   36 +++++++++++++++++---------
 src/cairo-type1-subset.c                |   27 ++++++++++++++++++++
 src/cairoint.h                          |    1 +
 5 files changed, 82 insertions(+), 35 deletions(-)

commit 56ad56263b86a9678387fe8dd994e77c183c6328
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Apr 20 22:44:04 2007 +0930

    Enable embedding of CID fonts in PDF
    
    Update cairo-pdf-surface.c to embed CFF and TrueType fonts
    as CID fonts. Update the ToUnicode CMap to handle CID fonts.

 src/cairo-pdf-surface.c |  285 +++++++++++++++++++++++++++++------------------
 1 files changed, 177 insertions(+), 108 deletions(-)

commit ca3662d6fc630e5390b3a8f8dbaa1d65aebc3fe8
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Apr 20 22:43:37 2007 +0930

    Make cairo-output-stream.c accept variable width printf fields

 src/cairo-output-stream.c |   27 +++++++++++++++++++++++----
 1 files changed, 23 insertions(+), 4 deletions(-)

commit 0c2a653033e0b631a1cb6591263cbd6125ccc00c
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Apr 20 22:30:55 2007 +0930

    Add CFF CID Fallback
    
    Switching to CID font embedding requires a fallback font for
    the case where CFF CID or TrueType CID subsetting fails.
    
    The new function _cairo_type2_charstrings_init() added to
    cairo-type1-fallback.c creates Type2 charstrings from glyph
    paths. _cairo_cff_fallback_init() in cairo-cff-subset.c
    wraps these charstrings in a CFF CID font.

 src/cairo-cff-subset.c                  |  212 +++++++++++++++++++++++++++++++
 src/cairo-scaled-font-subsets-private.h |   68 ++++++++++
 src/cairo-type1-fallback.c              |  211 ++++++++++++++++++++++---------
 3 files changed, 432 insertions(+), 59 deletions(-)

commit c68a2389f51880b0fa9df6750abdd840258666fc
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Apr 20 22:30:05 2007 +0930

    Make CFF Subsetting create CID subsets
    
    OpenType/CFF fonts come in two types: CID and non CID.
    CFF CID font subsetting was previously disabled in cairo
    due 1) to the need to embed CFF CID fonts in PDF as a CID fonts
    and 2) there is no easy way to convert CFF CID to CFF non CID.
    
    With the switch to CID fonts cairo-cff-subset.c has been
    updated to subset CID fonts and to covert non CID fonts to
    CID. A further advantage of converting non CID CFF fonts
    to CID is the reduction in size due to not embedding the
    name of each glyph in the font subset.

 src/cairo-cff-subset.c  |  858 ++++++++++++++++++++++++++++++----------------
 src/cairo-pdf-surface.c |    2 +
 2 files changed, 561 insertions(+), 299 deletions(-)

commit 073fce5a85ab90b1bc6915e41d6a420a47e540e6
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Apr 20 22:29:41 2007 +0930

    Add support for creating CID/composite font subsets
    
    cairo-scaled-font-subsets.c now provides three functions for creating subsets:
    
      _cairo_scaled_font_subsets_create_scaled()
        Create a subset for each scaled font with maximum size INT_MAX.
    
      _cairo_scaled_font_subsets_create_simple()
        Create subsets suitable for embedding as simple fonts in PS/PDF.
    
      _cairo_scaled_font_subsets_create_composite()
        Create subsets suitable for embedding as composite fonts in PS/PDF.
    
    The _create_simple() and _create_composite() functions both merge
    scaled fonts with the same face and an outline path available into
    the same subset. _create_composite() has a maximum subset size of
    65536 for outline fonts. Bitmap fonts have a separate subset for
    each scale with a maximum subset size of 256.
    
    The _create_simple() and _create_composite() functions both reserve
    the first glyph in the subset for the .notdef glyph. CID fonts require
    CID 0 to be .notdef.
    
    Update Type1, TrueType and CFF subsetting to expect glyph 0 of each
    subset to be the .notdef.

 src/cairo-cff-subset.c                  |    9 +--
 src/cairo-pdf-surface.c                 |    5 +-
 src/cairo-ps-surface.c                  |   13 +--
 src/cairo-scaled-font-subsets-private.h |   61 +++++++++++----
 src/cairo-scaled-font-subsets.c         |  127 ++++++++++++++++++++++---------
 src/cairo-svg-surface.c                 |    2 +-
 src/cairo-truetype-subset.c             |   21 ++---
 src/cairo-type1-fallback.c              |    2 +-
 src/cairo-type1-subset.c                |    3 -
 9 files changed, 156 insertions(+), 87 deletions(-)

commit bf957ee0f29ff49970b4791718eccdb92f3d6886
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Mar 23 12:59:38 2007 +0000

    cairo-png - handle short reads
    
    During MT cairo testing we get the error "libpng: Read Error" which is
    emitted should the fread return fewer bytes than asked. However, this is
    not necessarily an error, so double-check the ferror() status before
    raising a png_error().

 src/cairo-png.c |   24 +++++++++++++++++-------
 1 files changed, 17 insertions(+), 7 deletions(-)

commit d00aa44206f474e11c66c585d09bfd55e747cc5b
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 01:28:56 2007 -0400

    [Makefile.am] Add a "make snapshot" target
    that creates a tarball named with version, date, and git hash of
    the tree.  Like cairo-1.4.5-20070420-2a0389.tar.gz.

 Makefile.am |   11 ++++++++++-
 1 files changed, 10 insertions(+), 1 deletions(-)

commit 2a038956635e27f61fb2147527d2262eebf9bb26
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 00:55:03 2007 -0400

    [pixman] Fix typo in Makefile.am

 pixman/src/Makefile.am |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit abcd929c57459f95e93504e0ef07b012b497a363
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 00:50:48 2007 -0400

    [boilerplate] Add cairo_boilerplate_format_from_content

 boilerplate/cairo-boilerplate-quartz.c        |    9 +--------
 boilerplate/cairo-boilerplate-test-surfaces.c |   13 +------------
 boilerplate/cairo-boilerplate-win32.c         |    8 ++------
 boilerplate/cairo-boilerplate.c               |   18 ++++++++++++++++++
 boilerplate/cairo-boilerplate.h               |    3 +++
 5 files changed, 25 insertions(+), 26 deletions(-)

commit 97624dc488b41eb83d70b2c44a595daa5d833e7f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 00:45:42 2007 -0400

    [boilerplate] Strip test-surfaces boilerplate into cairo-boilerplate-test-surfaces*

 boilerplate/Makefile.am                            |    5 +
 .../cairo-boilerplate-test-surfaces-private.h      |   63 +++++++
 boilerplate/cairo-boilerplate-test-surfaces.c      |  170 ++++++++++++++++++++
 boilerplate/cairo-boilerplate.c                    |  146 +----------------
 4 files changed, 241 insertions(+), 143 deletions(-)

commit 2e709321d858a048731eeaaca4a13a96de739e3f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 00:34:51 2007 -0400

    [boilerplate] Move xasprintf to xmalloc.c

 boilerplate/cairo-boilerplate.c |   45 -----------------------------------
 boilerplate/cairo-boilerplate.h |   32 +++++++++++-------------
 boilerplate/xmalloc.c           |   50 ++++++++++++++++++++++++++++++++++++--
 boilerplate/xmalloc.h           |    9 ++++++-
 test/cairo-test.h               |    2 +-
 5 files changed, 71 insertions(+), 67 deletions(-)

commit 5331445c12756293a915420a26ab5553fc7db3fc
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 00:26:17 2007 -0400

    [boilerplate] Cleanup includes in cairo-boilerplate-beos.cpp

 boilerplate/cairo-boilerplate-beos.cpp |   20 ++++++++++----------
 1 files changed, 10 insertions(+), 10 deletions(-)

commit 56e916d40cf2a5f061347254657592f7bfc90d02
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 00:25:44 2007 -0400

    [boilerplate] Fix typos in cairo-boilerplate-glitz.c

 boilerplate/cairo-boilerplate-glitz.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 06718b0da642d39b7b4dbfc009f08acb24e5e802
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 00:15:19 2007 -0400

    [boilerplate] Remove leftover call to cairo_test_log

 boilerplate/cairo-boilerplate.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 99737a60cb8cae1643b84782768e8c6d50ac7d0a
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 00:13:25 2007 -0400

    [boilerplate] Clean up includes and remove unnecessary ones

 boilerplate/cairo-boilerplate-directfb.c |    9 +++++----
 boilerplate/cairo-boilerplate-pdf.c      |    2 +-
 boilerplate/cairo-boilerplate-svg.c      |    2 +-
 boilerplate/cairo-boilerplate-xcb.c      |    2 +-
 boilerplate/cairo-boilerplate.c          |   30 +++++++++---------------------
 5 files changed, 17 insertions(+), 28 deletions(-)

commit 4b569f13d758015f33ad258a70ad4f472da771ed
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 20 00:08:44 2007 -0400

    [boilerplate] Strip win32 boilerplate into cairo-boilerplate-win32*

 boilerplate/Makefile.am                       |    5 ++
 boilerplate/cairo-boilerplate-win32-private.h |   38 ++++++++++++++++++
 boilerplate/cairo-boilerplate-win32.c         |   51 +++++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c               |   31 ++-------------
 4 files changed, 99 insertions(+), 26 deletions(-)

commit 0a03d66fffe7388d8fb4ffdb7bb5501a214c6342
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 23:58:51 2007 -0400

    [boilerplate] Rename create_win32_surface to _cairo_boilerplate_win32_create_surface

 boilerplate/cairo-boilerplate.c |   22 +++++++++++-----------
 1 files changed, 11 insertions(+), 11 deletions(-)

commit 5ee882d3941a9df61d539e056933564a758a6bbc
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 23:53:34 2007 -0400

    [boilerplate] Remove empty cleanup_win32

 boilerplate/cairo-boilerplate.c |   11 ++---------
 1 files changed, 2 insertions(+), 9 deletions(-)

commit a684fd80e750bea5661262e29a59c4f8c4d9cee3
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 23:36:00 2007 -0400

    [directfb] Silence compiler warning

 src/cairo-directfb-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 23e6abc3fc01e3d722adfc48cd1df9c8db73adc1
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 22:40:52 2007 -0400

    [boilerplate] Strip glitz boilerplate into cairo-boilerplate-glitz*

 boilerplate/Makefile.am                       |   30 +-
 boilerplate/cairo-boilerplate-glitz-private.h |   73 ++++
 boilerplate/cairo-boilerplate-glitz.c         |  477 ++++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c               |  480 +------------------------
 4 files changed, 582 insertions(+), 478 deletions(-)

commit 7d576a376706aad427915b4872429f5605104886
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 22:25:28 2007 -0400

    [boilerplate] Minor indentation fix

 boilerplate/cairo-boilerplate.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 06b657ccf129f6f154c0db7886e5cca6191f93ca
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 22:20:38 2007 -0400

    [boilerplate] Strip xcb boilerplate into cairo-boilerplate-xcb*

 boilerplate/Makefile.am                     |    5 +
 boilerplate/cairo-boilerplate-xcb-private.h |   44 ++++++++++
 boilerplate/cairo-boilerplate-xcb.c         |  115 +++++++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c             |   90 +--------------------
 4 files changed, 167 insertions(+), 87 deletions(-)

commit 65f636649d54348722354b2400c3a191309da0e1
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 22:13:08 2007 -0400

    [boilerplate] Strip svg boilerplate into cairo-boilerplate-svg*

 boilerplate/Makefile.am                     |    5 +
 boilerplate/cairo-boilerplate-svg-private.h |   44 +++++++++
 boilerplate/cairo-boilerplate-svg.c         |  129 +++++++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c             |  106 +---------------------
 4 files changed, 181 insertions(+), 103 deletions(-)

commit 8c9960675b82978acbd5a85ef358c674c3407ee3
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 22:10:09 2007 -0400

    [boilerplate] Strip pdf boilerplate into cairo-boilerplate-pdf*

 boilerplate/Makefile.am                     |    5 +
 boilerplate/cairo-boilerplate-pdf-private.h |   44 +++++++++
 boilerplate/cairo-boilerplate-pdf.c         |  134 +++++++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c             |  111 +---------------------
 4 files changed, 186 insertions(+), 108 deletions(-)

commit d9ce7de57514710f425bdee613edc4ea79ac0f0a
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 22:08:24 2007 -0400

    [boilerplate] Rename xcairo_surface_set_user_data to cairo_boilerplate_surface_set_user_data
    
    and make it public.

 boilerplate/cairo-boilerplate.c |   48 +++++++++++++++++++++-----------------
 boilerplate/cairo-boilerplate.h |    6 +++++
 2 files changed, 32 insertions(+), 22 deletions(-)

commit df6b8ecc8963518c897648d82aab1aa090b4721a
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 21:46:51 2007 -0400

    [boilerplate] Strip ps boilerplate into cairo-boilerplate-ps*

 boilerplate/Makefile.am                    |    5 +
 boilerplate/cairo-boilerplate-ps-private.h |   44 +++++++++
 boilerplate/cairo-boilerplate-ps.c         |  138 ++++++++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c            |  115 +----------------------
 4 files changed, 190 insertions(+), 112 deletions(-)

commit 6461f0d120bf5fabd08b7621233229b223b3de89
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 20:45:10 2007 -0400

    [boilerplate] Remove unused variables

 boilerplate/cairo-boilerplate.c |    3 ---
 1 files changed, 0 insertions(+), 3 deletions(-)

commit f2d6275352142df631e00e27456d7e6ceb83804c
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 20:41:34 2007 -0400

    [boilerplate] Fix renaming typo

 boilerplate/cairo-boilerplate.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit d5535c993b5cde5df29a7a29339aa500992128bf
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 20:36:14 2007 -0400

    [boilerplate/test] Move vector_ignored_tests from boilerplate/ to test/

 boilerplate/cairo-boilerplate.c |   28 -----------------
 test/cairo-test.c               |   62 ++++++++++++++++++++++++++++----------
 2 files changed, 45 insertions(+), 45 deletions(-)

commit d6dc4f978364d287367d239e5594c7ffe50a2571
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 20:28:22 2007 -0400

    [boilerplate] Add a boolean is_vector to boilerplate target type
    
    This is used to move the skip-these-tests-for-vector code into
    cairo-test which it belongs.

 boilerplate/cairo-boilerplate.c |   18 ++++++++++++------
 boilerplate/cairo-boilerplate.h |    1 +
 2 files changed, 13 insertions(+), 6 deletions(-)

commit 0b5e2dbaa84225452a0935f61d2348bce88a3e69
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 20:23:55 2007 -0400

    [boilerplate] Sort backend entries in Makefile.am alphabetically

 boilerplate/Makefile.am |   10 +++++-----
 1 files changed, 5 insertions(+), 5 deletions(-)

commit be0320c4f8082a9274899959dc82297a04aa7800
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 20:17:26 2007 -0400

    [boilerplate] Properly namespace boilerplate methods
    
    in preparation for ripping them into per-backend files.

 boilerplate/cairo-boilerplate-beos.cpp   |   24 +-
 boilerplate/cairo-boilerplate-directfb.c |   33 ++--
 boilerplate/cairo-boilerplate-quartz.c   |   12 +-
 boilerplate/cairo-boilerplate-xlib.c     |   24 +-
 boilerplate/cairo-boilerplate.c          |  328 +++++++++++++++++-------------
 5 files changed, 236 insertions(+), 185 deletions(-)

commit 9b660a3d54940c68eb48f2afeca7e87e1d2bffa6
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 19:56:05 2007 -0400

    [boilerplate] Strip xlib boilerplate into cairo-boilerplate-xlib*

 boilerplate/Makefile.am                      |    5 +
 boilerplate/cairo-boilerplate-xlib-private.h |   44 ++++++
 boilerplate/cairo-boilerplate-xlib.c         |  196 ++++++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c              |  183 ++-----------------------
 4 files changed, 254 insertions(+), 174 deletions(-)

commit d945f6434643ac35f0e86352cfe3ccf021f568de
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 19:44:57 2007 -0400

    [boilerplate] Move includes around

 boilerplate/cairo-boilerplate.c |   23 ++++++++++-------------
 1 files changed, 10 insertions(+), 13 deletions(-)

commit 0130cca6924f5c0969ca285585c68a458301a882
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 19:39:58 2007 -0400

    [boilerplate] Rename test-directfb to boilerplate-directfb

 boilerplate/Makefile.am                          |    3 +-
 boilerplate/cairo-boilerplate-directfb-private.h |   23 ++++
 boilerplate/cairo-boilerplate-directfb.c         |  143 ++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c                  |    6 +-
 boilerplate/cairo-test-directfb.c                |  143 ----------------------
 boilerplate/cairo-test-directfb.h                |   23 ----
 6 files changed, 171 insertions(+), 170 deletions(-)

commit fb2c0daa09af083278024c3da6f7e9e3f851984f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 19:38:20 2007 -0400

    [boilerplate] Rename test-beos to boilerplate-beos

 boilerplate/Makefile.am                      |    3 +-
 boilerplate/cairo-boilerplate-beos-private.h |   34 ++++
 boilerplate/cairo-boilerplate-beos.cpp       |  258 ++++++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c              |    8 +-
 boilerplate/cairo-test-beos.cpp              |  258 --------------------------
 boilerplate/cairo-test-beos.h                |   34 ----
 6 files changed, 298 insertions(+), 297 deletions(-)

commit 01760286b388870e5bebf3851b4bef1350d89852
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 19:32:52 2007 -0400

    [boilerplate] Rename quartz-boilerplate to boilerplate-quartz

 boilerplate/Makefile.am                        |    4 +-
 boilerplate/cairo-boilerplate-quartz-private.h |   41 ++++++++++++++++
 boilerplate/cairo-boilerplate-quartz.c         |   60 ++++++++++++++++++++++++
 boilerplate/cairo-boilerplate.c                |   10 ++--
 boilerplate/cairo-quartz-boilerplate-private.h |   41 ----------------
 boilerplate/cairo-quartz-boilerplate.c         |   60 ------------------------
 6 files changed, 108 insertions(+), 108 deletions(-)

commit d64ef355217db7a555da0029187d19c80ec12609
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 19 23:12:09 2007 +0100

    Include cairo-perf in make check
    
    Although cairo-perf is not written to perform explicit failure testing of
    cairo, it does generate long sequences of cairo operations which often
    trigger unexpected errors. By including it with make check, it becomes
    even easier for the programmer to check that one has not broken cairo in
    terms of expected behaviour or performance.

 Makefile.am      |    3 ++-
 perf/Makefile.am |   30 +++++++++++++++++++-----------
 2 files changed, 21 insertions(+), 12 deletions(-)

commit 0ffb021e9b0cc2ec9afc3eaa360b4518327afa6c
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:52:51 2007 -0400

    [cairo-mutex] If no mutex implementation is found, should #error instead of #warning
    
    otherwise we will cause compile errors before the sanity check macros get
    a chance to err.

 src/cairo-mutex-private.h |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 813cdd71503ca2d77da011c91368e55cf20ad657
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:49:35 2007 -0400

    [configure.in] Support --disable-pthread
    
    Also allows for --enable-pthread=yes which will make configure abort
    if pthread is not found (as opposed to silently disabling it).

 configure.in |   13 ++++++++++++-
 1 files changed, 12 insertions(+), 1 deletions(-)

commit 6d01e89988ea89ae21f3461825583d89b6eef55e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 19 21:46:00 2007 +0100

    Add callgrind output files to CLEANFILES and .gitignore.

 perf/.gitignore  |    2 ++
 perf/Makefile.am |    1 +
 2 files changed, 3 insertions(+), 0 deletions(-)

commit 2c79f8b75bd5bb0bb3bf054fb2b3cae6de382a7c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 19 21:41:43 2007 +0100

    Fix command line for running cairo-perf under valgrind.
    
    The CAIRO_PERF_ENVIRONMENT slipped into the middle of the command line
    instead of at the start.

 perf/Makefile.am |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit 3631c11eb4ab49f2bb3b9ef0478e5516793f221f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:38:23 2007 -0400

    [cairo-mutex] Switch to HAVE_WINDOWS_H to use Win32 mutexes

 src/cairo-mutex-private.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit d2a824a191e6b0d10a1f495d970b0406e37e0a39
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:37:36 2007 -0400

    [cairo-commit] Update attribution headers in cairo-mutex-private.h

 src/cairo-mutex-private.h |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit 12dfd8bb4bf72483c835e169003fa00b114beb13
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:36:43 2007 -0400

    [cairo-mutex] Warn if no mutex definition found and let sanity macros err
    about undefined CAIRO_MUTEX macros.

 src/cairo-mutex-private.h |    8 +++++---
 1 files changed, 5 insertions(+), 3 deletions(-)

commit 6aa823841d6c1d59d4d972f0236f0e6a43199970
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:36:10 2007 -0400

    [cairo-mutex] Support non-reentrant compilation if CAIRO_NO_MUTEX defined
    to 1.

 src/cairo-mutex-private.h |   10 +++++++++-
 1 files changed, 9 insertions(+), 1 deletions(-)

commit e5980f69ad2d59ee305fe9aae62070a74d2df58b
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:31:47 2007 -0400

    [cairo-commit] Just warn for BeOS and let the sanity check macros err
    about undefined CAIRO_MUTEX macros.

 src/cairo-mutex-private.h |   10 +++-------
 1 files changed, 3 insertions(+), 7 deletions(-)

commit 8ebb054ff9d2fe12faa7b1807aef24b2bf916e64
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:28:44 2007 -0400

    [cairo-mutex] Prefer "#if CAIRO_SOMETHING" over "#if defined CAIRO_SOMETHING"

 src/cairo-mutex-private.h |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 97c197478023ceb5477a203d058eaec2cb18f987
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:26:21 2007 -0400

    [cairo-mutex] Add default implementation for CAIRO_MUTEX_INIT
    that uses CAIRO_MUTEX_NIL_INITIALIZER.  This used to be the
    implementation for pthread because pthread_mutex_init() is
    broken.  See d48bb4fbe876a93199ba48fcf5f32734fbe18ba9.

 src/cairo-mutex-private.h |   11 +++++++----
 1 files changed, 7 insertions(+), 4 deletions(-)

commit 6d2a2dd6d9190c62b209e47c083b7df72e7134fb
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:24:16 2007 -0400

    [cairo-mutex] Add default no-op implementation for CAIRO_MUTEX_FINI

 src/cairo-mutex-private.h |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit 2067d6fa90dae80aa666fb7328d51e2f92bec5bd
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:23:14 2007 -0400

    [cairo-mutex] Use CAIRO_MUTEX_NOOP when applicable

 src/cairo-mutex-private.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 5dda76c90f8886b6017ca8bbdf81be2b97201962
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:22:02 2007 -0400

    [cairo-mutex] Err if at least one of mutex macros are not defined

 src/cairo-mutex-private.h |   23 +++++++++++++++++++++++
 1 files changed, 23 insertions(+), 0 deletions(-)

commit f771b9157c26430949f4dd1412c7a7b35367f81a
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:21:13 2007 -0400

    [cairo-mutex] Define and use CAIRO_MUTEX_USE_GENERIC_INITIALIZATION
    We use the generic initialization if CAIRO_MUTEX_INITIALIZE is not
    defined.

 src/cairo-mutex-private.h |    9 +++++++++
 src/cairo-mutex.c         |    2 +-
 2 files changed, 10 insertions(+), 1 deletions(-)

commit 4fc52e2d49c1299f8f175e22472ebe08baa41fa4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:19:48 2007 -0400

    [cairo-mutex] Define CAIRO_MUTEX_NOOP

 src/cairo-mutex-private.h |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit f9dd8fd0ef0ad95921723155b951cd113ccb2d0b
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 16:19:25 2007 -0400

    [cairo-mutex] Inlucde cairo-features.h and config.h
    Previously we were lucky enough to have them included before us

 src/cairo-mutex-private.h |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit 4e754cf3df9855c1d442578e555b7fb17c3dd4a1
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 15:31:24 2007 -0400

    [cairo-truetype-subset] Shut gcc warning up

 src/cairo-truetype-subset.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 4141e752e2eb0f40f2eb298bad398e6390e00ef8
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 15:04:11 2007 -0400

    [cairo-freelist] Remove redundant struct declarations

 src/cairo-freelist-private.h |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

commit ea817c560c429f445e4c450b60d499dae27f6024
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 14:50:38 2007 -0400

    [cairo-mutex] Remove unneeded #undef CAIRO_MUTEX_EXTERNAL

 src/cairo-mutex-private.h |    8 --------
 1 files changed, 0 insertions(+), 8 deletions(-)

commit 0b281085b55aae70876c6ef022266b73461800ab
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 14:45:41 2007 -0400

    [cairo-mutex] Err on unintended inclusion of cairo-mutex-list-private.h

 src/cairo-mutex-list-private.h |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 47be7280bfe751c9f635f1e17c158f04b2927ae3
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 19 14:42:55 2007 -0400

    [cairo-mutex] Remove multiple-inclusion guards from cairo-mutex-list-private.h
    
    This is a list header file.  We should not prevent it from multiple
    inclusions.

 src/cairo-mutex-list-private.h |    3 ---
 src/cairo-mutex.c              |    2 --
 2 files changed, 0 insertions(+), 5 deletions(-)

commit 55ea0466e25de2c60171a9d6c96536bc2e7fb9e3
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 19 20:24:27 2007 +0100

    Embed simple clip XRectangles in cairo_xlib_surface_t
    
    Toolkits like GTK+ almost always set a simple rectangular clip mask before
    any cairo operation, so avoid the allocation for this simple case by
    embedding a small number of XRectangles into the surface structure.

 src/cairo-xlib-surface.c |   18 +++++++++++-------
 1 files changed, 11 insertions(+), 7 deletions(-)

commit 7906a993403e75aa34b32d2d9338ec179896d765
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Thu Apr 19 14:54:30 2007 +0200

    Define INT32 limits on MSVC as noticed by Hans-Jürgen Schäler

 src/cairo-wideint-private.h |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit cc8841645cd7aa06ae48cbad804b31b3c0c2146b
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Thu Apr 19 13:47:45 2007 +0200

    Properly use CAIRO_MUTEX_{INIT,FINI} and remove CAIRO_MUTEX_LIST_PRIVATE_H sentinal before explicitly including the mutex list.

 src/cairo-mutex.c |   10 ++++++----
 1 files changed, 6 insertions(+), 4 deletions(-)

commit 39a633a8f3618f3b1adb3eefdf36e2fc6d896054
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Thu Apr 19 13:15:08 2007 +0200

    Reintroduce DllMain as deterministic mutex initialization path

 src/cairo-win32-surface.c |   30 ++++++++++++++++++++++++++++++
 1 files changed, 30 insertions(+), 0 deletions(-)

commit 9b348929b51fb45f5985914350a10955d6df17ae
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Thu Apr 19 13:13:42 2007 +0200

    Introduce CAIRO_MUTEX_FINALIZE as counter-part for CAIRO_MUTEX_INITIALIZE

 src/cairo-mutex-private.h |    8 +++++++-
 src/cairo-mutex.c         |   12 ++++++++++++
 src/cairo-os2-surface.c   |    6 +++---
 3 files changed, 22 insertions(+), 4 deletions(-)

commit 67767afa09e3622988b9ac67b754114ea9f84105
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Thu Apr 19 12:35:10 2007 +0200

    Update _cairo_mutex_initialized during initialization.

 src/cairo-mutex.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 41c6eebcd1fab94fd3a91d09f1ef6ee0d8c7a044
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 19 11:56:15 2007 +0100

    Optionally provide a pattern to use for creating a similar solid surface.
    
    _cairo_surface_create_similar_solid() creates a fresh pattern to wrap
    color, however sometimes the caller already has that pattern available.
    In those circumstances we can pass the pattern as well as the color and
    avoid the extra allocation.

 src/cairo-clip.c          |    3 ++-
 src/cairo-glitz-surface.c |    3 ++-
 src/cairo-pattern.c       |    3 ++-
 src/cairo-surface.c       |   24 +++++++++++++++---------
 src/cairoint.h            |    6 +++++-
 5 files changed, 26 insertions(+), 13 deletions(-)

commit ef60e7c65144edd1aa14757b269f2c196df732a2
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 18 18:08:45 2007 +0100

    cairo-xlib-surface - track picture properties.
    
    By tracking picture properties we can dramatically reduce the amount of
    X11 traffic by avoiding redundant changes.

 src/cairo-xlib-surface.c |   35 ++++++++++++++++++++++++-----------
 1 files changed, 24 insertions(+), 11 deletions(-)

commit 9cf09556339e64bdf1273e95938b657112df07b6
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 19 09:27:51 2007 +0100

    Create opaque similar solid surfaces when possible.
    
    For opaque surfaces the backends may use simpler code paths - for
    example, the xlib backend may be able to use the Core protocol rather
    than Render. So we only generate a surface with an alpha component if
    the color is not opaque.

 src/cairo-pattern.c |    8 +++++---
 1 files changed, 5 insertions(+), 3 deletions(-)

commit f7b6fc474651311356f116b7d8d7a5ef1cbab570
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 19 09:22:08 2007 +0100

    Define a CAIRO_ALPHA_IS_OPAQUE variant that operates on uint16.
    
    Introducing this variant also fixed a bug in _gradient_is_opaque()
    which was using the fractional test on a uint16.

 src/cairo-pattern.c |    6 +++---
 src/cairoint.h      |    3 +++
 2 files changed, 6 insertions(+), 3 deletions(-)

commit 157074c794903f1dbe68c1ba5b129b4176dc7975
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 18 19:46:30 2007 -0400

    [boilerplate] Add cairo_boilerplate_get/free_targets
    This means, test and perf suites now share the same target handling
    code, including parsing CAIRO_TEST_TARGET.

 boilerplate/cairo-boilerplate.c |   73 +++++++++++++++++++++++++++++++++++++--
 boilerplate/cairo-boilerplate.h |    6 +++-
 perf/cairo-perf.c               |   20 +++++-----
 test/cairo-test.c               |   54 ++++-------------------------
 4 files changed, 92 insertions(+), 61 deletions(-)

commit 47c02a6bd67e8b7e50977cc87d5e35358d5c4c2e
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 18 19:15:16 2007 -0400

    [boilerplate] s/_cairo_test_content_name/cairo_boilerplate_content_name/g

 boilerplate/cairo-boilerplate.c |    8 ++++----
 boilerplate/cairo-boilerplate.h |    2 +-
 test/cairo-test.c               |   10 +++++-----
 3 files changed, 10 insertions(+), 10 deletions(-)

commit b9026d0b137520247b4a93287bd518fc79774e93
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 18 19:09:53 2007 -0400

    [perf] Make targets more consistent with the test suite
    That is:
    1) no VALGRING vs VG abbreviations
    2) setting TARGETS and ITERS on the make command line works now

 perf/Makefile.am  |   26 +++++++++++++++++---------
 perf/cairo-perf.c |    8 ++++++--
 2 files changed, 23 insertions(+), 11 deletions(-)

commit 9f3e0694e644d2279c7f4835f8035d4ecccb5711
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 18 19:08:54 2007 -0400

    [test] Allow bypassing all test targets by setting CAIRO_TEST_TARGET=" "

 test/cairo-test.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

commit 52d4e0f3191440e8ebe366b593c2e9c955328258
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 18 18:27:28 2007 -0400

    [doc] Make section title capitalization more consistent

 doc/public/cairo-sections.txt    |    2 +-
 doc/public/language-bindings.xml |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit beadcdf9bd7c1dde48c8c751ba8af75c60b93a5f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 18 18:24:09 2007 -0400

    Rename cairo-font.c to cairo-font-face.c

 src/Makefile.am       |    2 +-
 src/Makefile.win32    |    2 +-
 src/cairo-font-face.c |  514 +++++++++++++++++++++++++++++++++++++++++++++++++
 src/cairo-font.c      |  514 -------------------------------------------------
 src/cairoint.h        |    2 +-
 5 files changed, 517 insertions(+), 517 deletions(-)

commit f56582ef06bbf56edcc6ecc26698abaeba1306b0
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 18 17:50:36 2007 -0400

    Put back __inline definition for MSC compilers, in both cairo and pixman
    Apparently it's too much to expect people compiling on windows to fill
    in sensible values for config.h... /sigh

 pixman/src/pixmanint.h |   10 ++++++++--
 src/cairoint.h         |    2 ++
 2 files changed, 10 insertions(+), 2 deletions(-)

commit a54b6ed0784dd00375424e581bc7349dd8a2a2d9
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 18 17:45:31 2007 -0400

    [pixman] Rename icint.h to pixmanint.h

 pixman/src/Makefile.am             |    4 +-
 pixman/src/check-pixmanint.sh      |   17 +
 pixman/src/fbcompose.c             |    4 +-
 pixman/src/fbedge.c                |    4 +-
 pixman/src/fbmmx.c                 |    4 +-
 pixman/src/fbpict.c                |    4 +-
 pixman/src/fbtrap.c                |    4 +-
 pixman/src/icblt.c                 |    4 +-
 pixman/src/icbltone.c              |    4 +-
 pixman/src/iccolor.c               |    6 +-
 pixman/src/icformat.c              |    6 +-
 pixman/src/icimage.c               |    4 +-
 pixman/src/icpixels.c              |    4 +-
 pixman/src/icrect.c                |    6 +-
 pixman/src/icstipple.c             |    4 +-
 pixman/src/ictransform.c           |    6 +-
 pixman/src/ictrap.c                |    5 +-
 pixman/src/ictri.c                 |    5 +-
 pixman/src/icutil.c                |    4 +-
 pixman/src/pixman-xserver-compat.h |    4 +-
 pixman/src/pixman.h                |    4 -
 pixman/src/pixmanint.h             | 1070 ++++++++++++++++++++++++++++++++++++
 pixman/src/pixregion.c             |    4 +-
 pixman/src/renderedge.c            |    4 +-
 24 files changed, 1110 insertions(+), 75 deletions(-)

commit 48121e97ac4f0114a0d5bc35aec76d2aba23a783
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 18 17:04:07 2007 -0400

    [cairoint.h] Define WARN_UNUSED_RESULT if undefined

 src/cairoint.h |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit a396e0b05731db3acbf1e8d82ab77592b697e417
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 18 14:24:10 2007 +0100

    cairo-perf - add the missing newline.
    
    Oops, missed out the newline for the fprintf in the previous commit.

 perf/cairo-perf.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 383e9d5368706168498a87d1b7f023f2b59c2f92
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 18 14:12:20 2007 +0100

    cairo-perf - Check that the surface is created.
    
    Exit(1) if we fail to create the target surface.

 perf/cairo-perf.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

commit 7131f4e6aea11d94e38375a6be71887825008e48
Author: Dave Yeo <daveryeo@telus.net>
Date:   Tue Apr 17 15:30:20 2007 -0400

    [OS2] Fix #include "cairo-mutex-list-private.h"

 src/cairo-os2-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit f7a2787685d640dd35ef7ef1314c4e754771c512
Merge: 2efaf3a... cab4d41...
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Mon Apr 16 23:05:10 2007 +0200

    Merge branch 'master' of git+ssh://hasselmm@git.freedesktop.org/git/cairo

commit cab4d41cae4463841bca297a7e16c970633c8c21
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Apr 16 16:57:24 2007 +0100

    create-for-stream - free resources after test failure.
    
    create-for-stream often fails whilst running under valgrind due to the
    postscript output containing a CreationDate with seconds resolution,
    hence the visibility of the resource leaks during failure.

 test/create-for-stream.c |   37 ++++++++++++++++++++-----------------
 1 files changed, 20 insertions(+), 17 deletions(-)

commit 9d435d5fbfae0f64053f6596f73410bc352cd2de
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Apr 16 15:42:07 2007 +0100

    Add suppression for leak from XauFileName.
    
    The string is statically allocated by XauFileName() and so ignore the fact
    that is not freed upon termination.

 test/.valgrind-suppressions |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)

commit 3a3fb0031decec26260cd94e60f1b0bf06541a6d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Apr 16 15:08:54 2007 +0100

    Update .gitignore
    
    Add .*.sw? (vim swapfiles).
    Add *~ (backup files).
    Add *.gcno and *.gcda (gcov intermediates).

 .gitignore             |    1 +
 boilerplate/.gitignore |    4 ++++
 perf/.gitignore        |    4 ++++
 src/.gitignore         |    1 +
 test/.gitignore        |    3 +++
 5 files changed, 13 insertions(+), 0 deletions(-)

commit 7ff95c7230471be3ffa231ebc71e1d63ba4621b0
Author: Kouhei Sutou <kou@cozmixng.org>
Date:   Mon Apr 16 02:48:14 2007 -0400

    Support MinGW DLL compilation

 configure.in              |    1 +
 src/cairo-win32-surface.c |    4 ++++
 2 files changed, 5 insertions(+), 0 deletions(-)

commit ca9df759b4eda8f19a92b2e0b1092fa7b618d25b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sat Apr 14 15:28:29 2007 +0100

    Change of email address.
    
    Update to my new email address and drop my old work one.

 AUTHORS |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 96ee8d5ebe6c6494a140c5424137f26de5fd5d85
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Apr 13 17:47:25 2007 -0700

    Update version to 1.4.5 after the 1.4.4 release

 configure.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit ebba4a6d1467a8e5db5cc43eb08e8fc98c39b30a
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Apr 13 17:37:14 2007 -0700

    Increment version to 1.4.4 (and library versioning to 13:2:11)

 configure.in |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit e21a58ce4c2f550198de9ed35f7a37df764e7cdf
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Apr 13 17:36:31 2007 -0700

    NEWS: Add notes for cairo 1.4.4

 NEWS |   91 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 91 insertions(+), 0 deletions(-)

commit e1a1f6ff251582b2293098a55953f81a13bb9cc0
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Apr 13 16:37:52 2007 -0700

    AUTHORS: Update descriptions for Mathias Hasselmann and Chris Wilson
    
    Both have contributed a tremendous amount of effort to cairo 1.4.4.
    Well done!

 AUTHORS |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit ef3e13337e513cf470801cff5cd2b8fdcff1b6eb
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Apr 13 13:34:20 2007 -0700

    cairo-perf-diff: Use median not minimum to report differences
    
    Ideally, the minimum value would indicate the best possible performance,
    but I've encountered situations where a bogus minimum value gets lodged
    into the cached results for some reason, (and yet doesn't also get
    discarded as an outlier). The downside of that situation is that running
    more iterations never changes the result, so it's hard to fix the problem,
    (resulting in cairo-perf-diff feeling just plain broken as more runs
    change nothing).
    
    So let's try using the median time instead.

 perf/cairo-perf-diff-files.c |   10 +++++-----
 1 files changed, 5 insertions(+), 5 deletions(-)

commit 7ead3e64f17fe302398ec60c61eaeaae4e9b18cf
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 13 16:34:31 2007 -0400

    [ROADMAP] Put back bug 10508 into 1.4.4 roadmap and mark it fixed
    
    Yay!

 ROADMAP |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 84c10a79ffd233a953434bd787dcfe57787552f8
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 13 16:33:07 2007 -0400

    [cairo-pattern] Slightly hackish fix for bug #10508
    
    The so-attributed-to-X-server bug was that cairo maps the drawing
    region to the pattern space, rounds the box, and uploads only that
    part of the source surface to the X server.  Well, this only works for
    NEAREST filter as any more sophisticated filter needs to sneak a peek
    at the neighboring pixels around the edges too.
    
    The right fix involves taking into account the filter used, and the
    pattern matrix, but for most cases, a single pixel should be enough.
    Not sure about scaling down...
    
    Anyway, this is just a workaround to get 1.4.4 out of the door.  I'll
    commit a proper fix soon.

 src/cairo-pattern.c |   15 ++++++++++-----
 1 files changed, 10 insertions(+), 5 deletions(-)

commit fcf49a56130ede8c6aa9f84a8c59ecef54714b7b
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Apr 13 12:02:11 2007 -0700

    boilerplate: Cleanup conditional compilation ofcairo-quartz-boilerplate.c
    
    It's much nicer to use automake to conditionally compile a file,
    instead of always compiling it and conditionally having the compiler
    see an empty file.

 boilerplate/Makefile.am                        |    6 +++-
 boilerplate/cairo-boilerplate-private.h        |   45 ------------------------
 boilerplate/cairo-boilerplate.c                |    5 ++-
 boilerplate/cairo-quartz-boilerplate-private.h |   41 +++++++++++++++++++++
 boilerplate/cairo-quartz-boilerplate.c         |    6 +---
 5 files changed, 51 insertions(+), 52 deletions(-)

commit cea107c9800a4414f57a874dd52924efdff725ec
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Apr 13 11:28:21 2007 -0700

    Punt bug #10508 off of 1.4.4
    
    It looks like this is an X server bug, and we don't have an
    imminent fix. Meanwhile, the bug is avoidable by preferring
    to use xlib surface sources for transformed rendering to xlib
    instead of using image surface sources.

 ROADMAP |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

commit 4e3be548615f8ce8a45f0e887f19eb39ba21f8a4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 12 21:34:49 2007 -0400

    [cairo-pattern] Add a TODO item to code

 src/cairo-pattern.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

commit ec639449de9b630cdb4e7bca4ba8487b3a263184
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 12 18:16:52 2007 -0700

    Fix typo in loop control for computation of std. deviation
    
    Thanks to Chris Wilson for pointing out this problem.

 perf/cairo-stats.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 537a795b3b5698d4aa02f2f14e479e9bfd27fe0d
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 12 17:01:41 2007 -0700

    Remove ft-text-vertical-layout-type1
    
    This test can fail if the wrong font is loaded, but that's no
    different than many other text tests---so it doesn't really
    deserve special XFAIL treatment because of that.

 test/Makefile.am |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit 04164c996cad242a25c2af596ffcd3b07ba19289
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 12 20:14:23 2007 -0400

    [cairo-surface] Make sure cairo_surface_get_font_options() fully initializes
    the font_options passed in.

 src/cairo-surface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 7224e1a6e6eb474a3809d07f9540c959b3da10b2
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 12 17:54:32 2007 -0400

    [image] Set hint-metrics on in default font options

 src/cairo-image-surface.c |   12 +++++++++++-
 1 files changed, 11 insertions(+), 1 deletions(-)

commit 57434e249aba93f3b478a3c701e260093711d13f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 12 17:45:33 2007 -0400

    [xlib] Turn metrics-hinting on by default

 src/cairo-xlib-screen.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 8a4c108a4be6c4650cefe80e68d4c9974ccc27ba
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 12 22:19:03 2007 +0100

    Add a reference count to cairo_xlib_screen_info_t
    
    Due to the interaction between multiple threads showing glyphs and
    asynchronous CloseDisplays, it is possible for a font to maintain a
    cairo_xlib_screen_info_t beyond the CloseDisplay. The simple solution
    is to add a reference count in order to track the lifetime of the
    cairo_xlib_screen_info_t correctly.

 src/cairo-xlib-private.h |    6 +++
 src/cairo-xlib-screen.c  |   77 +++++++++++++++++++++++++++++++++++----------
 src/cairo-xlib-surface.c |    4 ++
 3 files changed, 70 insertions(+), 17 deletions(-)

commit 50ef5bcf7b5e6cc903f9247256fbd4439887ab5e
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 12 13:44:32 2007 -0700

    Revert cairo_public_warn addition to cairo.h
    
    This new feature isn't appropriate for a minor cairo release,
    (we're between 1.4.2 and 1.4.4 right now), but will make a
    lot of sense during 1.5.
    
    The code being reverted here was originally added with the
    following commit:
    
    	46eab95698e101e41407778eda22089b508a8984
    
    but this change reverts only the public-facing parts of it.

 configure.in |   11 -----------
 src/cairo.h  |   40 ++++++++++++++++++++--------------------
 2 files changed, 20 insertions(+), 31 deletions(-)

commit 35bb2152c06ef2621b14a8b2153cc327be8b43a1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 12 21:30:39 2007 +0100

    Hold the scaled_font->mutex whilst operating on the shared members.
    
    Obey the locking rules whilst resetting the scaled_font after a
    CloseDisplay.

 src/cairo-xlib-surface.c |   10 ++++++----
 1 files changed, 6 insertions(+), 4 deletions(-)

commit 97d897a7475f540ad901cb2a2cd6885e885ee02a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 12 21:17:42 2007 +0100

    cairo_xlib_close_display - drop the mutex whilst calling the hooks
    
    In order to avoid recursive dead-locks where whilst one thread holds the
    scaled font lock and is waiting on the XLockDisplay() another thread catches
    the CloseDisplay and then tries to acquire the scaled font lock, we drop
    the list mutex whilst processing the callbacks.

 src/cairo-xlib-screen.c |   33 ++++++++++++++++++++++++---------
 1 files changed, 24 insertions(+), 9 deletions(-)

commit 13b0aa669fd9ce6abc930730a941782e2baba215
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 12 13:29:56 2007 -0700

    Rebuild doc/public/Headers.mk
    
    Add a sort so that future update changes will be more legible.

 doc/public/Headers.mk  |   47 ++++++++++++++++++++++++-----------------------
 doc/public/Makefile.am |    3 ++-
 2 files changed, 26 insertions(+), 24 deletions(-)

commit ae80d375f829b076a8d1450c54b00b3750428366
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 12 13:02:26 2007 -0700

    Rename cairo-mutex-list.h to cairo-mutex-list-private.h
    
    Also add it (and cairo-mutex-private.h) to Makefile.am
    where they should have been.

 src/Makefile.am                |    2 +
 src/cairo-mutex-list-private.h |   50 ++++++++++++++++++++++++++++++++++++++++
 src/cairo-mutex-list.h         |   50 ----------------------------------------
 src/cairo-mutex-private.h      |    2 +-
 src/cairo-mutex.c              |    2 +-
 5 files changed, 54 insertions(+), 52 deletions(-)

commit 29adf591b7026092a809e9a27878b5b4e35051fb
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 12 12:47:27 2007 -0700

    move show-glyphs-many to the DISABLED_TESTS list
    
    And add a detailed comment explaining the reasons for disabling each
    test in the list.

 test/Makefile.am |   62 +++++++++++++++++++++++++++++++++++++----------------
 1 files changed, 43 insertions(+), 19 deletions(-)

commit c5b2f9d5c22c2259a11f0cbfbca8128cd3ac5794
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 12 01:22:49 2007 +0100

    cairo_xlib_screen_info_t - always perform an exact match
    
    This ensures that only one cairo_xlib_screen_info_t holds the
    close_display_hooks, an assumption used later.

 src/cairo-xlib-screen.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 8c9f0f607b992c47b555b5eaff3c599a8c1eac57
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 12 01:21:03 2007 +0100

    cairo-xlib-screen - avoid dereferencing a NULL screen.
    
    Do not initialize font options when setting up the
    cairo_xlib_screen_info_t corresponding to the display itself and not
    associated with any screen. This avoids a potential NULL dereferences.
    
    (Fixes https://bugs.freedesktop.org/show_bug.cgi?id=10517)

 src/cairo-xlib-screen.c |   12 +++++++-----
 1 files changed, 7 insertions(+), 5 deletions(-)

commit dc1de86680b59def00ce1e9f11997cf554cdfec1
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 12 15:06:37 2007 -0400

    [ROADMAP] Add cairo_object_t

 ROADMAP |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 12b962d648d307d7a6b94035b6c4ffdeaadd68e2
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 12 14:56:36 2007 -0400

    [ROADMAP] Mark bug #5777 as fixed

 ROADMAP |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit e391d3eaee65d65f267f86d1ef1e1fd8898e6556
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 12 14:42:41 2007 -0400

    [test] Disable text-glyph-range that was crashing
    
    Disabled tests are defined in DISABLED_TESTS.  This has the benefit
    that they will still be buildable and be shipped.  Just not run by
    default.

 test/Makefile.am |   10 ++++++----
 1 files changed, 6 insertions(+), 4 deletions(-)

commit d3c7942fb271fe8d1df7ca3205b41601abdcb5c8
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 12 14:22:02 2007 -0400

    [pixman] Mark some small functions that are called per-pixel inline
    
    These uses were introduced in the previous commit.

 pixman/src/fbcompose.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit e3b3d22999a130f7017e8e20a432a0d8a7f48f3b
Author: David Reveman <davidr@novell.com>
Date:   Thu Apr 12 14:14:12 2007 -0400

    [pixman] Fix fbcompose.c that was broken for some composite operations (#5777)

 pixman/src/fbcompose.c |  244 ++++++++++++++++++++++++++++++------------------
 1 files changed, 151 insertions(+), 93 deletions(-)

commit c8d2d1e8764c7ba754e46a3af68af2b4460d2e04
Author: Vladimir Vukicevic <vladimir@pobox.com>
Date:   Thu Apr 12 10:51:17 2007 -0700

    add licenses to test files

 test/composite-integer-translate-over-repeat.c |   26 ++++++++++++++++++++++++
 test/composite-integer-translate-source.c      |   26 ++++++++++++++++++++++++
 2 files changed, 52 insertions(+), 0 deletions(-)

commit e240048a14333d5c61a0d4ae5c30acd12bcb5805
Merge: 29a1fe1... 977a898...
Author: Michael Emmel <memmel@debian.localdomain>
Date:   Wed Apr 11 21:43:15 2007 -0700

    Merge branch 'master' of ssh+git://git.cairographics.org/git/cairo

commit 29a1fe12cf33a68713a4ddf7f59217fd40f6e967
Author: Michael Emmel <memmel@debian.localdomain>
Date:   Wed Apr 11 21:42:57 2007 -0700

    Fixed compile error from missing directfb.h include

 src/cairo-directfb.h |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit 977a8982ab17760af0d69cb2e018ed50f4c7b992
Author: Kristian Høgsberg <krh@redhat.com>
Date:   Wed Apr 11 23:49:01 2007 -0400

    Add missing copyright notice.

 test/pixman-rotate.c |   26 ++++++++++++++++++++++++++
 1 files changed, 26 insertions(+), 0 deletions(-)

commit 9193b29645ef1625a599471e3b0cb5279d2c05cb
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 11 23:30:31 2007 -0400

    [ROADMAP] Mark done items

 ROADMAP |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 284edb86484de8ccf3adf35d5cb9ff6ba64759ec
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 12 03:01:31 2007 +0100

    Do not raise an error if we fail to locate 'find' or 'xargs'
    
    Whilst not being able to delete all of the test output is messy it is
    however not fatal, so do not abort configuration simply because we
    cannot find either program.

 configure.in     |    6 ++----
 test/Makefile.am |   15 +++++++++------
 2 files changed, 11 insertions(+), 10 deletions(-)

commit a8974223dc6376a11588c6ecf1e54da5329b9c72
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 12 02:29:33 2007 +0100

    Check for find and xargs during configure
    
    Replace hard-coded find, xargs and rm with the paths determined during
    configure. This also gives us an opportunity to detect missing programs
    and inform the developer.

 configure.in     |    9 +++++++++
 test/Makefile.am |   12 ++++++------
 2 files changed, 15 insertions(+), 6 deletions(-)

commit 632ec8088cef5e9d4c2ff2886cfd550d706433e4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 11 20:18:11 2007 -0400

    [test] Add copyright headers for my tests

 test/extend-pad.c                 |   26 ++++++++++++++++++++++++++
 test/surface-pattern-scale-down.c |   26 ++++++++++++++++++++++++++
 test/surface-pattern-scale-up.c   |   26 ++++++++++++++++++++++++++
 test/surface-pattern.c            |   26 ++++++++++++++++++++++++++
 4 files changed, 104 insertions(+), 0 deletions(-)

commit 82397a631410af343f14cafdb31f48de9373f4a7
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Apr 12 00:55:04 2007 +0100

    Avoid using GNU find extensions.
    
    Replace the complex single find with a series of simple but POSIX correct
    equivalents.

 test/Makefile.am |   14 ++++++--------
 1 files changed, 6 insertions(+), 8 deletions(-)

commit 06382092e5e911ad2648f26e8ba5a6f8f7953e1b
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Apr 11 19:42:34 2007 -0400

    [pdiff] Ship gpl.txt

 test/pdiff/Makefile.am |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit c8645c85de94b83fe2fd60a4d881cb639eb79b46
Merge: be98123... 52435e9...
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 16:38:46 2007 -0700

    Merge branch 'master' of git.cairographics.org:/git/cairo into cairo

commit 52435e99f31f06c18273a5a7351a2c21f7c0ecf6
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 11 23:34:24 2007 +0100

    Move pixman_format_t from heap to stack allocations.
    
    pixman_format_t is a simple structure used in short-term allocations and
    suitable for on-stack allocation.
    
    Killing the pixman_format_create()/pixman_format_destroy() pairs avoid
    around 6% of the allocations during cairo-perf (e.g. 426,158 allocs out
    of a total of 7,063,469).

 pixman/src/icformat.c     |  118 +++++++++++++++------------
 pixman/src/icint.h        |   12 +---
 pixman/src/icrect.c       |    2 +-
 pixman/src/ictrap.c       |   36 +++-----
 pixman/src/ictri.c        |  199 +++++++++++++++------------------------------
 pixman/src/pixman.h       |   27 ++++---
 src/cairo-image-surface.c |  103 ++++++++++--------------
 7 files changed, 202 insertions(+), 295 deletions(-)

commit be98123b2c30a3102629afff74b9233c18e0535d
Merge: efedf57... a6506c6...
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 16:02:08 2007 -0700

    Merge cached-scaled-font-in-error into cairo
    
    Conflicts:
    
    	src/cairo-scaled-font.c

commit a6506c67f24331c703dd56502a1bc4504b7b2311
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 23:27:52 2007 +0100

    Don't return scaled fonts in the error state from the cache.
    
    It is possible for a scaled_font to be flagged as in error, though only
    through a "true error" e.g. a malloc failure. However, when returning a font
    from the cache it should not be in error. So if we find a error font in the
    cache we remove it and return a new font.

 src/cairo-scaled-font.c |   55 +++++++++++++++++++++++++++-------------------
 1 files changed, 32 insertions(+), 23 deletions(-)

commit efedf57f43540ad79eddcc5ee79dc0d86846891e
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 15:25:18 2007 -0700

    cairo-truetype-subset.c: Add missing error checks and propagation
    
    These are all to satisfy new warnings caused by the preceding commit,
    (which added cairo_warn to various function tables). While fixing the
    propoagation, fix functions to declare a return type of cairo_status_t
    instead of int.

 src/cairo-truetype-subset.c |  178 +++++++++++++++++++++++++++++--------------
 1 files changed, 120 insertions(+), 58 deletions(-)

commit e6ca34e718859b40dc8eb75a6c68b056751a6deb
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 22:59:10 2007 +0100

    Mark function tables with attribute(warn_unused_result)

 src/cairo-paginated-surface-private.h |    2 +-
 src/cairoint.h                        |   52 ++++++++++++++++----------------
 2 files changed, 27 insertions(+), 27 deletions(-)

commit 3bc413343a0b846c9501ee870db0424412aea701
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 11 01:08:17 2007 +0100

    Define cairo_public_warn in terms of cairo_public.
    
    By defining cairo_public_warn as an extension of cairo_public, the
    programmer need only to override cairo_public in order to export the
    complete API for different architectures i.e. existing configurations
    will continue to work with no alterations.

 configure.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 54134dd901d6dc94aa56d45486223e7d4f6ba569
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Apr 10 23:09:13 2007 +0100

    Only enable warn-unused-result for recent gcc
    
    The attribute was introduced with gcc-3.4, but the ability to suppress
    warnings from misapplied attributes (-Wno-attributes) was only introduced
    later. Without the supression, gcc will emit tens of warnings for each
    compilation completely drowning the real errors that the programmer
    must see.

 configure.in        |   19 +++++++++++++++++--
 pixman/src/pixman.h |   10 +++++++---
 src/cairoint.h      |   13 ++++++-------
 3 files changed, 30 insertions(+), 12 deletions(-)

commit f53c2b418cb4a36fbc1c30cdb1bf0ba9dba77bd0
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Apr 9 16:24:11 2007 +0100

    _pixman_create_source_image() - check for malloc failure
    
    Fix an unchecked malloc by propagating the NULL pointer up to its callers,
    which were already checking for failures.

 pixman/src/icimage.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit d0745c08b782d79fc7ccfd59cab0ae841a56c428
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Thu Apr 12 06:32:29 2007 +0930

    PDF: Fix glyph positioning bug when glyphs are not horizontal
    
    Bug reported in
    http://lists.freedesktop.org/archives/cairo/2007-April/010337.html

 src/cairo-pdf-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit e36794ad34282a4d671d7cc5527e9c650c2736fe
Merge: b692472... b745126...
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 13:15:57 2007 -0700

    Merge branch 'warn-unused-result' into cairo

commit b745126a04c126acc695e8abb6372c1890b03f07
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 11 12:26:21 2007 +0100

    Use find | xargs to overcome shell command line limit.
    
    Once again we have hit the command line limit with the sheer volume of
    generated test output. So replace the glob with a find which has the
    additional advantage of only needing to walk the tree once to generate
    the file lists - this begins to be noticeable with such large directories.

 test/Makefile.am |   16 +++++++++-------
 1 files changed, 9 insertions(+), 7 deletions(-)

commit 61b8e346135f8b61b22257541c97b9f262c17826
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 11 11:59:27 2007 +0100

    Unexport fbSolidFillmmx and fbCopyAreammx.
    
    By unexporting these function we have exact control over their call sites
    and so can convert the initial guards into asserts which transforms the
    two functions to return unconditional success and hence conversion to
    void.

 pixman/src/fbmmx.c        |  215 +++++++++++++++++++++------------------------
 pixman/src/fbmmx.h        |   19 ----
 pixman/src/pixman-remap.h |    1 -
 3 files changed, 101 insertions(+), 134 deletions(-)

commit efee2087387ba49e36d8d6104c4e2dd3ffeba081
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 11 11:26:27 2007 +0100

    Propagate errors up through pixman_composite_trapezoids()
    
    Change the return type to indicate errors detected during
    pixman_composite_trapezoids() and add checking for failures during
    region ops.

 pixman/src/ictrap.c |   37 +++++++++++++++++++++----------------
 pixman/src/pixman.h |    2 +-
 2 files changed, 22 insertions(+), 17 deletions(-)

commit bec097b5e281fcf2453de53946e89c13b37ecd1a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 11 11:13:30 2007 +0100

    Propagate region errors from pixman_color_rects().
    
    Region operations within pixman_color_rects can fail, so cleanup and
    propagate.

 pixman/src/icrect.c       |   74 +++++++++++++++++++++++++++++++++-----------
 pixman/src/pixman.h       |    4 +-
 src/cairo-image-surface.c |    6 ++-
 3 files changed, 61 insertions(+), 23 deletions(-)

commit 909334ee00701e18b2f2033b1c3a27714ce988fb
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 11 10:45:55 2007 +0100

    FbClipImage* should check for errors during region operations.
    
    Propagate the error from pixman_region_intersect().

 pixman/src/icimage.c |   18 ++++++++++++++----
 1 files changed, 14 insertions(+), 4 deletions(-)

commit 5b67efcbd8acad60080129e0a8a307671b18b4fc
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 11 10:38:09 2007 +0100

    Propagate region failures during pixman_image_set_clip_region().
    
    Operating on regions can fail so check the status and return an error,
    after any necessary cleanup.

 pixman/src/icimage.c |   15 ++++++++++++---
 1 files changed, 12 insertions(+), 3 deletions(-)

commit e1abc3c26dd797ba9a888362713c5e5c1257867b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 11 09:51:58 2007 +0100

    Provide a private entry point for cairo_scaled_font_status().
    
    Add slim_hidden* markup for cairo_scaled_font_status() as we now use
    it internally.

 src/cairo-scaled-font.c |    1 +
 src/cairoint.h          |    1 +
 2 files changed, 2 insertions(+), 0 deletions(-)

commit 054c28a09de2c8ec2dc7111d786bca41a94f5a83
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 02:26:08 2007 -0700

    boilerplate: Add error checking for cairo_surface_write_to_png

 boilerplate/cairo-boilerplate.c |    9 ++++++++-
 1 files changed, 8 insertions(+), 1 deletions(-)

commit 0a54ca2d2340c55896ee6951efe6917322813431
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 02:22:22 2007 -0700

    boilerplate: Add error checking for cairo_surface_set_user_data

 boilerplate/cairo-boilerplate.c |   26 ++++++++++++++++++++++----
 1 files changed, 22 insertions(+), 4 deletions(-)

commit 5661de9e1c93bd548b400de2619b6de6133d6483
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 02:08:36 2007 -0700

    SVG: Add missing error checking for calls to _cairo_output_stream_destroy

 src/cairo-svg-surface.c |   28 +++++++++++++++++++++-------
 1 files changed, 21 insertions(+), 7 deletions(-)

commit 8d5aa0fb8d3ac6302dd5e832425f3285ad84280a
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 02:03:10 2007 -0700

    SVG: Add missing error checks and propagation
    
    The function calls that get the new treatment here are:
    
    	_cairo_meta_surface_replay
    	_cairo_surface_show_page
    	_cairo_array_append
    
    all within _cairo_svg_surface_emit_meta_surface

 src/cairo-svg-surface.c |   39 +++++++++++++++++++++++++++++----------
 1 files changed, 29 insertions(+), 10 deletions(-)

commit 9c810625e796704e32e76caae18d2129219f46db
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 01:55:59 2007 -0700

    PDF: Added error checking and propagation for _cairo_array_append

 src/cairo-pdf-surface.c |   89 +++++++++++++++++++++++++++++-----------------
 1 files changed, 56 insertions(+), 33 deletions(-)

commit 5ae82deb6942fae1515740551c71e9eb24750a7c
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 01:47:21 2007 -0700

    PS: Add missing check for return value of _cairo_meta_surface_replay
    
    Here we have to change the return type of a couple of functions in
    order to propagate the error condition.

 src/cairo-ps-surface.c |   25 ++++++++++++++++++++-----
 1 files changed, 20 insertions(+), 5 deletions(-)

commit 8c31cca2af11c544a6028bf42c2187625b978f56
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 01:42:02 2007 -0700

    PS: Add missing checks for return value of _cairo_pattern_get_extents
    
    Propagation is extremely straightforward in this case.

 src/cairo-ps-surface.c |   11 +++++++++--
 1 files changed, 9 insertions(+), 2 deletions(-)

commit 01ac5f1aea298434b617d935512e2e72033989fd
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 11 01:35:11 2007 -0700

    Assert that cairo_matrix_invert succeeds rather than ignoring tis return value
    
    This assertion is safe as an internal consistency check thanks to
    the recent checks added to cairo_pattern_set_matrix.

 src/cairo-pdf-surface.c |    4 +++-
 src/cairo-ps-surface.c  |    5 ++++-
 2 files changed, 7 insertions(+), 2 deletions(-)

commit bd0b328f7e07b3a292190aef6f82622800230f6f
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 22:55:00 2007 -0700

    test/invalid-matrix: Add new test to exercise CAIRO_STATUS_INVALID_MATRIX paths
    
    This new test exercises every path where the user might possibly
    pass in an invalid matrix. Currently the test fails if no error
    is reported. Also, if an incorrect error is reported, (such as
    CAIRO_STATUS_NO_MEMORY instead of CAIRO_STATUS_INVALID_MATRIX),
    this is logged as a warning in invalid-matrix.log, but the test
    still passes.
    
    It would still be worthwhile to follow up quickly and fix those
    cases to propagate the correct error value.

 test/.gitignore       |    1 +
 test/Makefile.am      |    1 +
 test/invalid-matrix.c |  142 +++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 144 insertions(+), 0 deletions(-)

commit a6186604f794f2746089abc9c1716384c23aafc4
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 22:52:37 2007 -0700

    cairo_pattern_set_matrix: Validate that matrix is invertible
    
    If not, set an error in the pattern.

 src/cairo-pattern.c |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

commit 8e72852f0b9f2cd8558eb6c11acb326e73fceb12
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 22:51:44 2007 -0700

    _cairo_gstate_ensure_scaled_font: Add missing propagation for error hiding inside the scaled_font

 src/cairo-gstate.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit 2f1221e0f225f305c3f9c8e7311fe8f3fecab34b
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 22:50:46 2007 -0700

    _cairo_gstate_ensure_scaled_font: Prefer to treat a pointer as a pointer, not a Boolean value

 src/cairo-gstate.c |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

commit dca69f73e3a11d397a701f82331d5aaa7194bd7f
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 17:16:39 2007 -0700

    Check (and assert) return values of cairo_matrix_invert
    
    Now that we have matrix validation at the time of _cairo_scaled_font_init
    we know that it is safe to invert this matrix.

 src/cairo-pdf-surface.c |    5 ++++-
 src/cairo-ps-surface.c  |    5 ++++-
 2 files changed, 8 insertions(+), 2 deletions(-)

commit 4ce2b62bcea49eccc0a4ee3781a115e4a34d3ad4
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 17:12:51 2007 -0700

    _cairo_scaled_font_init: Detect an invalid matrix and return an error.
    
    Also fix all callers to notice and propagate the error, (though
    some paths will still lose the CAIRO_STATUS_INVALID_MATRIX value
    due to a return value of NULL at one point).

 src/cairo-atsui-font.c  |    9 +++++++--
 src/cairo-scaled-font.c |   24 +++++++++++++++++-------
 src/cairo-win32-font.c  |   10 ++++++----
 3 files changed, 30 insertions(+), 13 deletions(-)

commit fd8c1e4dc851dd4ce8f84a3e47abdc4906c83b0f
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 16:43:50 2007 -0700

    Fix cairo_scaled_font_create to return a nil scaled font, not NULL

 src/cairo-scaled-font.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 0f0ed88ee26f22c1b0e0ec7c95b8a258d137dde4
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 23:01:55 2007 -0700

    paginated: Add missing error check for _cairo_surface_show_page
    
    Fixing this uncovered a leak of a CAIRO_INT_STATUS_UNSUPPORTED value
    up to cairo_show_page, (and similarly to cairo_copy_page). There was
    really no good reason for _cairo_surface_show_page and
    _cairo_surface_copy_page to be returning cairo_int_status_t. Fix
    this by simply handling the UNSUPPORTED return at the surface layer
    instead of the gstate layer.

 src/cairo-gstate.c            |   20 ++------------------
 src/cairo-paginated-surface.c |    4 +++-
 src/cairo-surface.c           |   16 ++++++----------
 src/cairoint.h                |    4 ++--
 4 files changed, 13 insertions(+), 31 deletions(-)

commit 381f0bcafc86cefa665368cbbe2026adda1d98c9
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 16:33:34 2007 -0700

    paginated: Add missing error check for _cairo_surface_get_extents

 src/cairo-paginated-surface.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 41911002d754f187618ab310ab93c85c4b038943
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 16:32:09 2007 -0700

    test-meta-surface.c: Fix memory leak on error recovery path.

 src/test-meta-surface.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit d954e4c1488c6478852dcc02641e66df1d4e9317
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 16:31:21 2007 -0700

    Fix indentation of CLEANUP_IMAGE label.

 src/cairo-paginated-surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit c011c37ba086f0c8d0dac6437318822927543955
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 16:30:43 2007 -0700

    paginated: Fix missing errors checks for _cairo_meta_surface_replay

 src/cairo-paginated-surface.c |   14 ++++++++++----
 1 files changed, 10 insertions(+), 4 deletions(-)

commit e73a55ad3cc30b0ea69379b12283515523015751
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 14:17:42 2007 -0700

    cairo-truetype-subset: Fix missing error propagation

 src/cairo-truetype-subset.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit 97b8fd8117160cfea9864c81cbb8a06b321618f1
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 14:16:01 2007 -0700

    cairo-truetype-subset: Check resturn value from _cairo_array_append and propagate

 src/cairo-truetype-subset.c |   28 ++++++++++++++++++++++++----
 1 files changed, 24 insertions(+), 4 deletions(-)

commit 84639e563ddfbd70ca48dcde4d3631418fd1cd82
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 14:11:43 2007 -0700

    test-meta-surface: Add missing check for error from _cairo_surface_get_extents

 src/test-meta-surface.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 866b2296b4a8b347011f1c8ae2e0f3a987a29d0c
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 14:09:56 2007 -0700

    test-meta-surface: Add missing checks for errors from _cairo_meta_surface_replay

 src/test-meta-surface.c |   10 ++++++++--
 1 files changed, 8 insertions(+), 2 deletions(-)

commit ec1fc931257ff90fe190c52ed0a3bed9f218c350
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 13:59:42 2007 -0700

    Add missing error check of return value of _cairo_path_fixed_close_path

 src/cairo-ft-font.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit 3d21037a8fb69bde0765871f53fe461ac397367e
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 13:57:41 2007 -0700

    Add assertion check to quiet warn_unused_result warning.
    
    This is a somewhat useful internal consistency check.

 src/cairo-xlib-surface.c |    6 +++++-
 1 files changed, 5 insertions(+), 1 deletions(-)

commit 2f468677160080e9dd1db52a2ad7ca4adbf48149
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 13:53:58 2007 -0700

    Rename _cairo_pdf_surface_emit_toUnicode_stream to eliminate StudlyCaps
    
    Obviously, the new name is _cairo_pdf_surface_emit_to_unicode_stream which
    is consistent with the to_unicode_stream identifiers already existing in
    the implementation.

 src/cairo-pdf-surface.c |   12 ++++++------
 1 files changed, 6 insertions(+), 6 deletions(-)

commit cc6c115e3c5b931be4ab0210ce7f8cecaccf6241
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 13:51:46 2007 -0700

    PDF: Check return value of _cairo_output_stream_destroy and propagate

 src/cairo-pdf-surface.c |   56 +++++++++++++++++++++++++++++-----------------
 1 files changed, 35 insertions(+), 21 deletions(-)

commit 8873928f09a78d3e6e8e57d5d4e0b94cf1f78ab7
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 13:40:04 2007 -0700

    PS: Add missing error checks for _cairo_output_stream_destroy

 src/cairo-ps-surface.c |   14 ++++++++++----
 1 files changed, 10 insertions(+), 4 deletions(-)

commit ab5eccbbf6cc361e864e0d75c0299cf7b5d6122d
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 13:28:48 2007 -0700

    Make _cairo_clip_reset void
    
    Yet another unconditionally successful function---so it's easier to return nothing.

 src/cairo-clip-private.h |    2 +-
 src/cairo-clip.c         |    4 +---
 src/cairo-gstate.c       |    4 +++-
 src/cairo-meta-surface.c |    2 +-
 4 files changed, 6 insertions(+), 6 deletions(-)

commit 7a0ae5b7057798106b5e1a82431178f6c5f148e7
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Apr 10 21:09:36 2007 +0100

    Disable warnings for cairo_*_reference functions.
    
    This class of functions modify their argument and return it as a
    *convenience* for the caller. For example, within cairo a common idiom is:
    
        cairo_object_reference (new);
        cairo_object_unreference (this->obj);
        this->obj = new;
    
    which updates the member to the new object irrespective of whether the
    new object is the same as the one being replaced. Other issues arise
    with subtypes, as the return type is the parent's and so require more
    complicated handling to compile cleanly.
    
    Disabling the warning is therefore preferred over adding code which
    decreases readibility and reduces maintainability. We need to make the
    compiler work for us, not against us...

 src/cairoint.h |   26 +++++++++++++++-----------
 1 files changed, 15 insertions(+), 11 deletions(-)

commit b82e595449e6eebbe6024454aaaaee31e6c43c73
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Apr 9 15:31:28 2007 +0100

    pixman region operations can fail, propagate the error.
    
    Copying the clip region could fail, add error returns and propagate up
    the call stack.

 src/cairo-clip-private.h |    4 +-
 src/cairo-clip.c         |   53 +++++++++++++++++++++++++++++++++-------------
 src/cairo-gstate.c       |   14 +++++++++--
 src/cairo.c              |    2 +-
 src/cairoint.h           |    2 +-
 5 files changed, 53 insertions(+), 22 deletions(-)

commit b0a256aaf3f0fd4491a28fca797aef1ef4b1251d
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 13:07:09 2007 -0700

    Change _cairo_dtostr to have a void return type
    
    As previously implemented, there's no essential information in the
    return value from _cairo_dotostr, (the caller can simply use strlen
    to recompute the same value, which is what the only caller is already
    doing).
    
    There would be real information in a return value which would return
    the result from the call to snprintf for the case where the buffer is
    not large enough for the number being printed.

 src/cairo-output-stream-private.h |    2 +-
 src/cairo-output-stream.c         |    5 +----
 src/cairoint.h                    |    3 ---
 3 files changed, 2 insertions(+), 8 deletions(-)

commit 5303980f82431a9d084177998a68527b60610241
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 12:56:56 2007 -0700

    _cairo_output_stream_vprintf: Add assertion to detect internal inconsitency
    
    This will catch any inconsistency between the length of a single
    format specifier and the fixed size of the single_fmt buffer.

 src/cairo-output-stream.c |   14 +++++++++++---
 1 files changed, 11 insertions(+), 3 deletions(-)

commit 97a69bc82e023d139d997ef69c7eba50d2708686
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 12:13:27 2007 -0700

    Fix mis-indented _cairo_dtostr

 src/cairo-output-stream.c |   64 ++++++++++++++++++++++----------------------
 1 files changed, 32 insertions(+), 32 deletions(-)

commit 5c95800cded4e906baf8ddd10bfb4abc59151b13
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 12:13:10 2007 -0700

    Fix mis-indented _cairo_traps_init_box

 src/cairo-traps.c |   30 +++++++++++++++---------------
 1 files changed, 15 insertions(+), 15 deletions(-)

commit 57188b4dcbcc2625dfc1817f8fe3b8ffeade5dc5
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 12:06:09 2007 -0700

    Fix cairo_traps_t status handling
    
    Add a _cairo_traps_status function and use it instead of adding
    error checks to callers of _cairo_traps_add_trap and
    _cairo_traps_add_trap_from_points, (both of which are now given
    a void return type).

 src/cairo-bentley-ottmann.c |   14 +++++++-------
 src/cairo-traps.c           |   24 ++++++++++++++----------
 src/cairoint.h              |    5 ++++-
 3 files changed, 25 insertions(+), 18 deletions(-)

commit 67bc608603b9baf8de8bcd2fedcf8ec315432a37
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 11:11:32 2007 -0700

    Add missing error checking to _trace_mask_to_path
    
    Note: It looks like it would be convenient to shove a status value
    into cairo_path_fixed_t to reduce this sequence of error checks.
    But I tried that first, and it actually makes things worse overall
    due to many things like _cairo_path_fixed_move_to called by
    cairo_move_to where the result must be immediately checked anyway.
    So I've already rejected that approach.

 src/cairo-scaled-font.c |   54 +++++++++++++++++++++++++++++++++++-----------
 1 files changed, 41 insertions(+), 13 deletions(-)

commit b1086caf3b108b0df19f70a2b6df161ad51bb280
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Apr 10 10:45:15 2007 -0700

    Add a status field to cairo_polygon_t
    
    Now, the functions to add new data to a polygon all become void,
    and there's a new _cairo_polygon_status call to query the status
    at the end of a sequence of operations.
    
    With this change, we fix many callerswhich were previously not
    checking the return values of _cairo_polygon functions by adding
    only a single call to _cairo_polygon_status rathern than several
    new checks.

 src/cairo-path-fill.c   |   36 ++++++++-------------------
 src/cairo-path-stroke.c |    8 +++++-
 src/cairo-pen.c         |    9 ++++---
 src/cairo-polygon.c     |   60 +++++++++++++++++++++++++---------------------
 src/cairoint.h          |   11 ++++++--
 5 files changed, 64 insertions(+), 60 deletions(-)

commit bff45ec9f90b5949a8ffa19cb03c140a08119e4d
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:44:12 2007 -0700

    Invert condition to more intuitive form.
    
    The idiom for checking the return value of malloc is:
    
    	if (pointer == NULL) { ... }
    
    rather than:
    
    	if (pointer != NULL) { ... }

 src/cairo-pattern.c |    7 ++++---
 1 files changed, 4 insertions(+), 3 deletions(-)

commit 01955a6e82ee28dd1377a3f2242aa2ddeebadac9
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:42:04 2007 -0700

    Rename ARRAY_LEN to ARRAY_LENGTH
    
    Yet another victim in my hunt against abbreviations within cairo's implementation.

 src/cairo-arc.c             |    2 +-
 src/cairo-atsui-font.c      |    4 ++--
 src/cairo-bentley-ottmann.c |    2 +-
 src/cairo-cff-subset.c      |    6 +++---
 src/cairo-hash.c            |    2 +-
 src/cairo-pattern.c         |    8 ++++----
 src/cairo-polygon.c         |    2 +-
 src/cairo-spline.c          |    4 ++--
 src/cairo-surface.c         |    2 +-
 src/cairo-svg-surface.c     |    2 +-
 src/cairo-traps.c           |    2 +-
 src/cairo-truetype-subset.c |    6 +++---
 src/cairoint.h              |    4 ++--
 13 files changed, 23 insertions(+), 23 deletions(-)

commit d317e8175de04c73c4a1f84db4a7e5354411ca06
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:38:17 2007 -0700

    Prefer FALSE over 0 for initializing a cairo_bool_t value

 src/cairo.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 9a33dab96988b94940a917921accc1bf19960a53
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:37:30 2007 -0700

    Fix an incorrectly indented condition

 src/cairo-xlib-surface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 4bfc8c98ccf29fc11d11ee35996be9aab5a63f36
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:36:41 2007 -0700

    ATSUI: Fix broken error checks for NULL surface
    
    The cairo_image_surface_create function never returns NULL so
    the previous error checks would never have triggered. The correct
    approach is to check the result of cairo_surface_status().

 src/cairo-atsui-font.c |    9 +++++----
 1 files changed, 5 insertions(+), 4 deletions(-)

commit bd98295100ce84a9dfffd16bc6e50ef0ced4d4bc
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:30:06 2007 -0700

    Add a couple of missing newline characters
    
    A return statement that's not at the end of a function really needs
    a line of whitespace after it.

 src/cairo-bentley-ottmann.c |    1 +
 src/cairo-type1-fallback.c  |    1 +
 2 files changed, 2 insertions(+), 0 deletions(-)

commit a7d8e52cc4be2376429f567abc2be853da7d5fbc
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:24:18 2007 -0700

    Cleanup multi-line if condition
    
    The standard idiom of assigning to a local status variable looks much,
    much nicer here.

 src/cairo-path.c |   20 +++++++++++---------
 1 files changed, 11 insertions(+), 9 deletions(-)

commit 7c97696af98a6dab9e0c5cdc72ff08c19892c95f
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:16:30 2007 -0700

    Make _cairo_path_bounder_add_point void
    
    Yet another function that cannot fail under any circumstances.

 src/cairo-path-bounds.c |    6 ++----
 1 files changed, 2 insertions(+), 4 deletions(-)

commit 93776772edbadeab90ea199a115750310be91e4e
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:15:33 2007 -0700

    Make _cairo_matrix_compute_scale_factors void
    
    Yet another function that cannot fail under any circumstances.

 src/cairo-matrix.c |    4 +---
 src/cairoint.h     |    2 +-
 2 files changed, 2 insertions(+), 4 deletions(-)

commit d5b35d7d7666634f1f98d6c0141a2a29976e7e2f
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:12:11 2007 -0700

    Make _cairo_pen_init_empty void
    
    Yet another function that cannot fail under any circumstances.

 src/cairo-pen.c |    4 +---
 src/cairoint.h  |    2 +-
 2 files changed, 2 insertions(+), 4 deletions(-)

commit 9077da99abd163ebd0c52e8375e6f40ce60cf7d2
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:09:51 2007 -0700

    Make _cairo_gstate_user_to_device (and friends) void.
    
    This is just multiplication after all, so there's nothing that can fail.
    And we can get rid of a lot of useless error-checking code this way.
    The corrected functions are:
    
    	_cairo_gstate_user_to_device
    	_cairo_gstate_user_to_device_distance
    	_cairo_gstate_device_to_user
    	_cairo_gstate_device_to_user_distance

 src/cairo-gstate.c |   16 +++----------
 src/cairo.c        |   62 +++++++++++++++------------------------------------
 src/cairoint.h     |    8 +++---
 3 files changed, 26 insertions(+), 60 deletions(-)

commit 628ec8eb91fb246b8a44be3451163a5d8592a860
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Apr 9 17:03:29 2007 -0700

    Make _cairo_gstate_identity_matrix void
    
    Now that we have the warn_unused_result attribute enabled, (thanks
    Chris!), it's actually harmful to have a function return an
    uncoditional value of CAIRO_STATUS_SUCCESS. The harm is that
    it would force lots of unnecessary error-checking paths that
    just add clutter.
    
    It is much better to simply give a function that cannot fail
    a return type of void.

 src/cairo-gstate.c |    9 ++-------
 src/cairo.c        |    6 +-----
 src/cairoint.h     |    2 +-
 3 files changed, 4 insertions(+), 13 deletions(-)

commit 90803eca0fa8d49c54c465580707009aae382d28
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 4 11:17:23 2007 +0100

    Implement clone_surface for test-fallback-surface.
    
    A few tests were failing due to clip_init_deep_copy() not being able to
    clone the target surface. Before propagating the failure, this was being
    silently ignored.
    
    Copy the simple implementation from cairo-image-surface.

 src/test-fallback-surface.c |   22 +++++++++++++++++++++-
 1 files changed, 21 insertions(+), 1 deletions(-)

commit 4456ecbf2694f0b71a431353e0dea0515b72926b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 23:40:31 2007 +0100

    Fix detection of FcFini().
    
    It is customary to check for a FontConfig function in the FontConfig
    library rather than the FreeType library.

 configure.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit cd2394c076e2f6b14a9a3281461026b811692f2e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Apr 3 21:50:15 2007 +0100

    Free the bitmap->buffer on failure
    
    Currently if the ownership of the bitmap->buffer is passed to
    _get_bitmap_surface() then the status of the buffer is inconsistent
    should the function detect an error (i.e. CAIRO_STATUS_NO_MEMORY).
    Fix it up that should we encounter an error and we own the buffer then
    we always free it on behalf of the caller.

 src/cairo-ft-font.c |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)

commit ac33953a81114dddc25ceb57f6df57e01d4d937b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 23:37:29 2007 +0100

    Correct handling of a malloc failure during pattern_create_in_error()
    
    Confusion had been introduced as to who provided the fixup after
    the malloc failed which resulted in a NULL deference whilst checking for
    an erroneous pattern in _cairo_pattern_create_in_error.

 src/cairo-pattern.c |   24 ++++++------------------
 1 files changed, 6 insertions(+), 18 deletions(-)

commit b6924722b8c8e5f4356d3c8ba438a702ffb8a5ed
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 8 23:35:01 2007 -0400

    [cairo-skiplist] Use one random number per insertion, instead of two

 src/cairo-skiplist-private.h |    3 +++
 src/cairo-skiplist.c         |    7 +++++--
 2 files changed, 8 insertions(+), 2 deletions(-)

commit ce1651f1ea57b53ad91f5115524d33f6424d5797
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Apr 3 16:53:17 2007 +0100

    Free the pixman_image if we fail to wrap it with a surface.

 src/cairo-image-surface.c |    9 +++++++++
 1 files changed, 9 insertions(+), 0 deletions(-)

commit bd99507f15dd8a2d162f13e691cc5f8d71795577
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Mar 30 14:00:50 2007 +0100

    Initialise cairo_spline_t to use its embedded buffer.
    
    Currently the code defaults to setting its points to NULL and fixing it up
    on the first add_point() to use the embedded buffer. Skip this extra step
    by initialising points to the embedded buffer.

 src/cairo-spline.c |   24 +++++++-----------------
 1 files changed, 7 insertions(+), 17 deletions(-)

commit 6daaf8a89d24fb3022687fe8d52c8001dc270265
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 8 23:32:27 2007 -0400

    [cairo-skiplist] Reduce MAX_LEVEL from 31 to 15
    
    The probability that a node of level L is generated is
    0.25^(L-1) * 0.75.  It means, a node of level 15 or
    more will be used with a probability of about 3 * 10^-9.
    That's really rare...
    
    Actually that's not still true, because the level of a new
    node is capped by current max-level plus one.  So to really
    get a node with a level of 15 one should first get a node
    of level 2, then 3, then 4, ..., finally 15.  Now that's
    REALLY rare.
    
    And guess what, the skiplist only start behaving bad with a
    max level cap of MAX_LEVEL when having on the order of
    4**MAX_LEVEL items in it.  I really hope we don't get there.

 src/cairo-skiplist-private.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit a7de9501f6d0f3a574c5246b81d78aa749b64e67
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 8 23:24:50 2007 -0400

    [cairo-skiplist] Group levels two-by-two in freelists
    
    Most memory allocators allocate in multiples of twice the size of
    a pointer.  So there is no point in keeping freelists for both
    even and odd levels.  We now round odd levels up to the next
    even level for freelist computations.  This reduces the number of
    node mallocations.

 src/cairo-skiplist-private.h |   10 +++++++++-
 src/cairo-skiplist.c         |   21 ++++++++++++++-------
 2 files changed, 23 insertions(+), 8 deletions(-)

commit b2280c5ac25e752c4462acdc8d2ded916fce7c34
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Mar 30 11:24:18 2007 +0100

    Do not overwrite cr->status
    
    The idiom for cairo.c is to do
        cr->status = _cairo_op ();
        if (cr->status) _cairo_set_error (cr, cr->status);
    
    Unfortunately a trivial mistake for a _cairo_op () is to call a cairo_op ()
    and forget to check cr->status but return CAIRO_STATUS_SUCCESS which will
    mask the earlier error.
    
    Obviously this is a bug in the lower level but the impact can be reduced
    by chaning cairo.c to use a local status variable for its return:
        cairo_status_t status = _cairo_op ();
        if (status) _cairo_set_error (cr, cr->status);

 src/cairo.c |  537 +++++++++++++++++++++++++++++++++++------------------------
 1 files changed, 319 insertions(+), 218 deletions(-)

commit 14ac5dd78b38aaaa118e8ac39fa50f485bff516d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 23:11:57 2007 +0100

    Return the correct status from _cairo_pen_stroke_spline().
    
    The return value is shared before the normal cleanup and error paths,
    so do not simply return a hard-coded CAIRO_STATUS_SUCCESS.

 src/cairo-pen.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit b823e2f68ff613b2c4f537aba6bbbcf413412eb2
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 23:09:31 2007 +0100

    cairo-xlib-surface - propagate status returns.
    
    These were found during a cairo_static pass on an alternative branch...
    
    A critical one in particular was setting the have added glyph flag to
    TRUE even if _cairo_xlib_surface_add_glyph() fails. This can cause an
    application crash due to a RenderBadGlyph error later when the scaled
    font is cleaned and we attempt to remove the glyph.

 src/cairo-xlib-surface.c |   44 +++++++++++++++++++++++++++++++-------------
 1 files changed, 31 insertions(+), 13 deletions(-)

commit 4a624b8e8b0a14dd03e551b28257d8a54b9ee6f6
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Mar 29 13:36:07 2007 +0100

    Remove the entry if we return an error code during _cair_hash_table_insert.
    
    Previously if we detected an error during resize we would report a
    failure to insert the entry into the hash table having already done so.

 src/cairo-hash.c |   11 +++++++++--
 1 files changed, 9 insertions(+), 2 deletions(-)

commit 1cdb54f8835446b23769b7771445201a9b5d165e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Thu Mar 29 09:11:21 2007 +0100

    Reorder cleanup cairo_xlib_surface_show_glyphs()
    
    _cairo_pattern_release_surface() asserts that it is passed a pattern
    surface. This itself is bad as breaks the symmetry with
    _cairo_pattern_acquire_surface under() error conditions, however reorder
    the cleanup to avoid this assertion.

 src/cairo-xlib-surface.c |   22 ++++++++++++----------
 1 files changed, 12 insertions(+), 10 deletions(-)

commit a1331fb043051ac10f8555b2ad2fe85183db96df
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Mar 28 19:32:25 2007 +0100

    Detect failure to allocate glyphs during _cairo_scaled_font_init()
    
    If _cairo_cache_create fails, return CAIRO_STATUS_NO_MEMORY.

 src/cairo-scaled-font.c |    9 ++++++---
 1 files changed, 6 insertions(+), 3 deletions(-)

commit 1237eedff3d557b94db9c940fd8de48be9ba41ba
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 22:56:43 2007 +0100

    Check for error whilst trying to advance along a text string.
    
    The text perf-case tries to fill the region with a single text string,
    but fails to detect when the current point does not advance due to an
    error. This causes the perf-case to enter an infinite loop, so we break
    out when the cairo_status() has been set.

 perf/text.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit ea4945850ae3ce3614bcadc0fa413eb836344430
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Mar 16 20:04:26 2007 +0000

    Avoid using substituted surfaces for xlib operations.
    
    Detect when a substitute image surface is returned for a solid pattern,
    and avoid mixed image/xlib composite operations. This can happen for example
    if there is a resource allocation failure during creating a similar surface.

 src/cairo-xlib-surface.c |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)

commit 751976970bb0ec9b810c1f58a05d53b7bfb7d90f
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Fri Mar 16 19:35:02 2007 +0000

    Handle failure to allocate a GC.

 src/cairo-xlib-surface.c |   51 ++++++++++++++++++++++++++++++---------------
 1 files changed, 34 insertions(+), 17 deletions(-)

commit c6055dc349c3f96e8d6f0e4166540871a59cb0e2
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 22:50:44 2007 +0100

    Reset cairo_scaled_font_map after freeing.
    
    Along the error path the global font map was freed but not reset,
    causing segfaults on any subsequent use of a cairo_scaled_font_t.

 src/cairo-scaled-font.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 65de47d8bc7865c6bf6318fd7bd861acf4e4af05
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 22:47:19 2007 +0100

    cairo-bentley-ottmann - check init for failure
    
    This was found during a cairo_static pass on an alternative branch...
    Add the trivial error propagation for _cairo_bo_event_queue_init()

 src/cairo-bentley-ottmann.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit b4cb0306b4415f2ddf0acd84043b72c8b8485726
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Mar 28 15:55:06 2007 +0100

    cairo-type1-fallback - propagate error returns
    
    Add status returns in order to propagate a matrix inversion failure
    up through the call stack.

 src/cairo-type1-fallback.c |   25 ++++++++++++++++++-------
 1 files changed, 18 insertions(+), 7 deletions(-)

commit b29d78dda169ee58b82cdbd04e3af2eedcc58edd
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Mar 28 15:43:37 2007 +0100

    cairo-svg-surface - propagate some error returns
    
    Add status returns to functions in order to propagate an error up
    the call stack.
    
    For the emit_*_pattern we add a new status return even when when
    the functon return CAIRO_STATUS_SUCCESS unconditionally in order for
    the caller to handle all cases in a consistent manner.

 src/cairo-svg-surface.c |   56 +++++++++++++++++++++++++++++++----------------
 1 files changed, 37 insertions(+), 19 deletions(-)

commit 3f7ca6ef5b09263607ff2f9862950393815c5d2c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Mar 28 14:57:44 2007 +0100

    cairo-pen - cairo_pen_init() can fail propagate its error.
    
    Add status returns in order to propagate an intialisation failure
    back up the call chain.

 src/cairo-path-stroke.c |   23 +++++++++++++++--------
 1 files changed, 15 insertions(+), 8 deletions(-)

commit 67f13b3518c5fc98d1e3fb184bc6c2f5ea96f4c9
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:54:41 2007 +0100

    cairo-bentley-ottmann/skip-list - catch and propagate out-of-memory errors
    
    The skip list inserts could return NULL indicating an out-of-memory error.
    In order to handle this, propagate the error up the call stack.

 src/cairo-bentley-ottmann.c |   50 ++++++++++++++++++++++++++++++-------------
 src/cairo-skiplist.c        |    2 +
 2 files changed, 37 insertions(+), 15 deletions(-)

commit 293122279fd87098a00386bb4c9310f3fc1bb373
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:50:48 2007 +0100

    cairo-path-stroke - add trivial missing status checks
    
    Propagate the error status.

 src/cairo-path-stroke.c |   33 +++++++++++++++++++++++++--------
 1 files changed, 25 insertions(+), 8 deletions(-)

commit 2f2bff038cb0e59865a0405b19da4805213d718e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:47:01 2007 +0100

    buffer-diff - check for any errors whilst writing the png
    
    Propagate any errors from writing out the png.

 test/buffer-diff.c |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

commit 79424fc64640db4b518eaf4a23477f1bbc26db5a
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:45:58 2007 +0100

    cairo - add missing status checks
    
    Add a few missing status checks and set the error on the context when
    applicable.

 src/cairo.c |   74 ++++++++++++++++++++++++++++++++++++++--------------------
 1 files changed, 48 insertions(+), 26 deletions(-)

commit a34a32fd99145733df9290f7c72bf7d9759e212b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:36:42 2007 +0100

    cairo-type1-fallback - check for an error during cleanup
    
    The cleanup path is shared between the error path and the true path, and
    so any error along it can not be ignored.

 src/cairo-type1-fallback.c |    7 ++++---
 1 files changed, 4 insertions(+), 3 deletions(-)

commit d2efadc84d0716498cec0510916f5375fbb7acf0
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:35:28 2007 +0100

    cairo-svg-surface - propagate error returns
    
    Add a couple of missing checks for error statues.

 src/cairo-svg-surface.c |   34 ++++++++++++++++++++++++----------
 1 files changed, 24 insertions(+), 10 deletions(-)

commit 02264b40f5ab4831e52c0ad156471045c62c9e85
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:34:25 2007 +0100

    cairo-surface-fallback - propagate error returns
    
    _cairo_surface_composite() can fail so check for and error return and
    propagate.

 src/cairo-surface-fallback.c |   44 ++++++++++++++++++++++++-----------------
 1 files changed, 26 insertions(+), 18 deletions(-)

commit 76b27fb0e81cc557c7348f6ba98b72552d781aed
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:33:00 2007 +0100

    cairo-ps-surface - add a couple of status checks
    
    Handle a couple more error returns.

 src/cairo-ps-surface.c |   54 +++++++++++++++++++++++++++--------------------
 1 files changed, 31 insertions(+), 23 deletions(-)

commit 619425a8b3bff79fb453f4b84e3a8e75db369b40
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:29:19 2007 +0100

    cairo-polygon - trivial propagation of error status
    
    _cairo_polygon_move_to() returns an error status so use it.

 src/cairo-polygon.c |    8 +++-----
 1 files changed, 3 insertions(+), 5 deletions(-)

commit 4b195779a465f69b035e9fd6695ef5c137a6b342
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:28:25 2007 +0100

    cairo-pen - trivial propagation of error status
    
    Add a couple of missing checks for error statuses and correct the
    error path cleanup for _cairo_pen_stroke_spline().

 src/cairo-pen.c |   24 +++++++++++++++++-------
 1 files changed, 17 insertions(+), 7 deletions(-)

commit 66d3e252025cf7f8a624fad83bffa1488a98910d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:26:33 2007 +0100

    cairo-pdf-surface - propagate error status
    
    Catch and propagate any error status.

 src/cairo-pdf-surface.c |   25 +++++++++++++------------
 1 files changed, 13 insertions(+), 12 deletions(-)

commit b32a5b1dc6d66a4477fb8df1461821a27192600f
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:25:46 2007 +0100

    cairo-pattern - propagate status
    
    Catch, cleanup and propagate after an error return.

 src/cairo-pattern.c |   10 ++++++++--
 1 files changed, 8 insertions(+), 2 deletions(-)

commit fd49bbb4b21b73247b4d391c2cb1b028a596f6eb
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:24:59 2007 +0100

    cairo-path - check for failure during _cairo_path_fixed_interpret
    
    Catch an error return from _cairo_path_fixed_interpret() and return
    it. Similary check for an error code in cairo_status() before returning
    success.

 src/cairo-path.c |   55 +++++++++++++++++++++++++++++++----------------------
 1 files changed, 32 insertions(+), 23 deletions(-)

commit 814830f63b72f69198e92564c53f2683e5bda269
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:22:56 2007 +0100

    cairo-path-fill - trivial missing unused result
    
    Actually assign the result that is tested on the next line...

 src/cairo-path-fill.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 7ab1f62c60141d5c0e989d55f4a49537a6b52c4d
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:21:49 2007 +0100

    cairo-paginated-surface - fix up the trivial unused result
    
    Check for status returns and propagate, cleaning up as necessary.

 src/cairo-paginated-surface.c |   22 ++++++++++++++++------
 1 files changed, 16 insertions(+), 6 deletions(-)

commit 78c0d62ba7c650a6dc8137e6d1375e21f9477c2b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:20:42 2007 +0100

    cairo-meta-surface - propagate trivial status return
    
    _cairo_path_fixed_init_copy() could fail so propagate it's status.

 src/cairo-meta-surface.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 75cc5e04d5b854a1eefe116c2be4a3c2bb21d6ac
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:19:49 2007 +0100

    cairo-image-surface - propagate error returns from pixman.
    
    pixman does occasionally return an error - in such circumstances we
    should propagate it.

 src/cairo-image-surface.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

commit dee9a53029bd3e42c60a855edfb54591bf1782b5
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:18:30 2007 +0100

    cairo-gstate - fix the trivial unchecked returns
    
    Check for an error return and propagate.

 src/cairo-gstate.c |   17 +++++++++++++----
 1 files changed, 13 insertions(+), 4 deletions(-)

commit de264af2c659b32c8bc71060da85037ac7e1d44f
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:17:26 2007 +0100

    cairo-ft-font - handle trivial failures
    
    Catch the status return, cleanup and propagate the error.

 src/cairo-ft-font.c |   82 +++++++++++++++++++++++++++++++++-----------------
 1 files changed, 54 insertions(+), 28 deletions(-)

commit 14c8dfb0b9bcc26a02057e5636d8bf35c3b4ef29
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Apr 9 15:03:34 2007 +0100

    cairo-clip - handle trivial pixman failures
    
    Detect the simple cases when pixman returns an error, ie an OOM
    condition, and propagate the error status.

 src/cairo-clip.c |   18 ++++++++++++------
 1 files changed, 12 insertions(+), 6 deletions(-)

commit 274c20c27a094c05afa62579cacb5749013abd60
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 21:14:09 2007 +0100

    cairo-boilerplate - handle failure to set user data
    
    After failing to set the user data on a surface, clean up and return NULL.

 boilerplate/cairo-boilerplate.c |   10 +++++++++-
 1 files changed, 9 insertions(+), 1 deletions(-)

commit 46eab95698e101e41407778eda22089b508a8984
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Apr 8 20:50:08 2007 +0100

    Add attribute(warn_unused_result)
    
    This adds a compiler check that the function result is used by the caller
    and enables it by default for all cairo_private functions and for public
    API that returns a cairo_status_t.
    
    It has been discussed that to extend the warnings to all functions, a
    new function type could been introduced to cover static functions:
    cairo_static. This has not been done at the present time in order to
    minimise the churn and focus on the more common errors.
    
    In order to reduce the warning spew generated by gcc for invalid use of
    this attribute, -Wno-attributes is added to CFLAGS. This has the
    unfortunate side-effect of masking future warnings for all attributes -
    be warned!

 configure.in         |   13 ++++++++++++-
 pixman/configure.in  |    3 ++-
 pixman/src/pixman.h  |    2 +-
 src/cairo.h          |   40 ++++++++++++++++++++--------------------
 src/cairoint.h       |    8 +++++---
 src/check-headers.sh |    2 +-
 6 files changed, 41 insertions(+), 27 deletions(-)

commit 9da86e4a386505288c3a933f30583abf7706c950
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 8 22:56:30 2007 -0400

    Add references to the skiplist paper

 BIBLIOGRAPHY                 |    8 ++++++++
 src/cairo-skiplist-private.h |    6 ++++++
 2 files changed, 14 insertions(+), 0 deletions(-)

commit ad0e13805c036941a03e49215b1bb525b4666033
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 8 22:50:51 2007 -0400

    [cairo-skiplist] Clarify MAX_LEVEL in comment, and adjust accordingly
    
    Reading the code, MAX_LEVEL is in fact what could have been named
    MAX_NUM_LEVELS.  That is, it is maximum possible level plus one.
    All code is correct: it uses MAX_LEVEL as array size and never produces
    a level of MAX_LEVEL.  The comment is fixed.

 src/cairo-skiplist.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit e8072e6e0ac86b2b0baefb54dcc551ee548164af
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 8 22:03:46 2007 -0400

    [test,perf] Make them rebuild boilerplate when src is changed

 perf/Makefile.am |    2 +-
 test/Makefile.am |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 6f9309221704a799ca36917c65abfc0941119b13
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 8 21:58:54 2007 -0400

    Rename pixman_region_uninit to pixman_region_fini

 pixman/src/fbcompose.c       |    2 +-
 pixman/src/fbpict.c          |    2 +-
 pixman/src/icimage.c         |    8 ++++----
 pixman/src/icrect.c          |    4 ++--
 pixman/src/ictrap.c          |    4 ++--
 pixman/src/pixman-remap.h    |    2 +-
 pixman/src/pixman.h          |    2 +-
 pixman/src/pixregion.c       |    2 +-
 src/cairo-clip.c             |   12 ++++++------
 src/cairo-glitz-surface.c    |    4 ++--
 src/cairo-surface-fallback.c |    6 +++---
 src/cairo-surface.c          |    4 ++--
 src/cairo-traps.c            |    2 +-
 13 files changed, 27 insertions(+), 27 deletions(-)

commit 4f8a04b1c93630c2556db5e3a0657076167e1ea3
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sun Apr 8 21:55:45 2007 -0400

    [pixman-image] Simply initialization given that there is no clip

 pixman/src/icimage.c |   32 +++++++++-----------------------
 1 files changed, 9 insertions(+), 23 deletions(-)

commit df9ea31df5857ee7aacd6ba002881233e9c4a9b4
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Thu Mar 15 14:42:13 2007 +0100

    [pixman-region] Separate pixman_region_init
    
    Most of the time pixman_region_init is called without any extents, and
    followed by a pixman_region_union_rect, used to used to initialize
    rectangular regions. pixman_region_union_rect is not that cheap, but
    the sequence is called quite often. So it should be worth introducing
    a specialized and fast function for this sequence.
    
    This introduces pixman_region_init_rect.  This new function makes
    _cairo_region_init_from_rectangle obsolete.
    
    Also removes the extent argument from pixman_region_init as it was
    called with NULL most of the time.  A pixman_region_init_with_extents
    is added for the general case.

 pixman/src/fbcompose.c       |    3 +--
 pixman/src/fbpict.c          |    3 +--
 pixman/src/icimage.c         |   25 +++++++++++--------------
 pixman/src/icrect.c          |   10 +++++-----
 pixman/src/ictrap.c          |    6 ++----
 pixman/src/pixman-remap.h    |    2 ++
 pixman/src/pixman.h          |    7 ++++++-
 pixman/src/pixregion.c       |   37 +++++++++++++++++++++----------------
 src/cairo-clip.c             |   18 ++++++++++--------
 src/cairo-glitz-surface.c    |    2 +-
 src/cairo-region.c           |   25 -------------------------
 src/cairo-surface-fallback.c |    7 +++----
 src/cairo-surface.c          |   16 ++++++----------
 src/cairo-traps.c            |    2 +-
 src/cairoint.h               |    4 ----
 15 files changed, 70 insertions(+), 97 deletions(-)

commit 9436959a838412b5336279c7d5c35bf4e586f984
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 01:37:28 2007 +0100

    Update function map

 pixman/src/pixman-remap.h |    5 ++---
 1 files changed, 2 insertions(+), 3 deletions(-)

commit 99f4bfada807aa7062051bb81fd29d4d3a87fbd1
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 01:35:40 2007 +0100

    Remove abdoned pixman_region_{create,destroy}

 pixman/src/pixman.h    |    6 ------
 pixman/src/pixregion.c |   25 -------------------------
 2 files changed, 0 insertions(+), 31 deletions(-)

commit 4532c023e0810c2e8d0d5928074bcae8865c5e14
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 01:31:53 2007 +0100

    Make clientClip region static, remove abdoned CT_PIXMAP code paths

 pixman/src/icimage.c |  208 ++------------------------------------------------
 pixman/src/icimage.h |    2 +-
 pixman/src/icint.h   |    2 +-
 3 files changed, 9 insertions(+), 203 deletions(-)

commit 65f269f3a4148a6cf3b2158ea893bb8452c3ad5e
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 01:24:11 2007 +0100

    Avoid pixman_region_create in pixman_composite{,General}

 pixman/src/fbcompose.c |   32 ++++++++--------------
 pixman/src/fbpict.c    |   32 ++++++++--------------
 pixman/src/icimage.c   |   68 +++++++++++++++++-------------------------------
 3 files changed, 48 insertions(+), 84 deletions(-)

commit 82cc451148eec1703d001f2b814d5b3712d31727
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 01:21:18 2007 +0100

    Make clip regions of pixman_image_t static

 pixman/src/fbcompose.c |   38 ++++++++--------
 pixman/src/icimage.c   |  121 +++++++++++++++++++++++++++---------------------
 pixman/src/icimage.h   |    8 ++--
 pixman/src/icrect.c    |    7 ++-
 4 files changed, 96 insertions(+), 78 deletions(-)

commit 041371533746d4aae3245a74459c0b0d1a4628fb
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 00:59:36 2007 +0100

    Avoid pixman_region_create in pixman_color_rects

 pixman/src/icrect.c |   32 ++++++++++++++++----------------
 1 files changed, 16 insertions(+), 16 deletions(-)

commit 5a6ca4794bfd96026937cd8736a8bcb723b2b2ff
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 00:55:46 2007 +0100

    Replace pixman_region_create_simple by pixman_region_init

 pixman/src/ictrap.c    |   14 +++++++-------
 pixman/src/pixman.h    |    3 ---
 pixman/src/pixregion.c |   13 +------------
 3 files changed, 8 insertions(+), 22 deletions(-)

commit f9057f27520842159f73dbfd6de49cb8feee1c39
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 00:48:43 2007 +0100

    Avoid pixman_create_region in glitz-surface

 src/cairo-glitz-surface.c |   49 ++++++++++++++++++++++-----------------------
 1 files changed, 24 insertions(+), 25 deletions(-)

commit 82cbb6886cf621fd6b10be5e04ce11ff05127fc6
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 00:46:34 2007 +0100

    Remove redundant _cairo_clip_fini function

 src/cairo-clip-private.h |    3 ---
 src/cairo-clip.c         |   17 -----------------
 src/cairo-gstate.c       |    4 ++--
 src/cairo-meta-surface.c |    2 +-
 4 files changed, 3 insertions(+), 23 deletions(-)

commit 5ae309c4561418fb057a8049f047ffcb03f3b698
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 00:40:44 2007 +0100

    Avoid pixman_region_create in _cairo_traps_extract_region

 src/cairo-traps.c |   18 +++++++++---------
 src/cairoint.h    |    6 +++---
 2 files changed, 12 insertions(+), 12 deletions(-)

commit 241482b5505427d221f4aaa970e7500a78fb2da1
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 00:28:49 2007 +0100

    Avoid malloc in _cairo_region_create_from_rectangle

 src/cairo-clip.c             |   42 +++----
 src/cairo-region.c           |   34 +++---
 src/cairo-surface-fallback.c |  250 ++++++++++++++++++++++--------------------
 src/cairo-surface.c          |   52 +++++----
 src/cairoint.h               |    5 +-
 5 files changed, 199 insertions(+), 184 deletions(-)

commit efc9775149c4c87645c58235c7626cc4f72e69c3
Author: Mathias Hasselmann <mathias@pergamaunz.(none)>
Date:   Tue Mar 13 23:58:14 2007 +0100

    Make sure clip->region is always initialized

 src/cairo-clip.c |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

commit 0e7df34e07d7816b29c1ac1f67608b87c5e0efc2
Author: Mathias Hasselmann <mathias@pergamaunz.(none)>
Date:   Tue Mar 13 23:38:20 2007 +0100

    Make region of cairo_clip_t static

 src/cairo-clip-private.h |    3 +-
 src/cairo-clip.c         |   87 ++++++++++++++++++++++++----------------------
 src/cairo-surface.c      |    4 +-
 3 files changed, 49 insertions(+), 45 deletions(-)

commit ced7b4a4ab4b5a8d639bfca0dd5db38f1ae4825d
Author: Mathias Hasselmann <mathias@pergamaunz.(none)>
Date:   Tue Mar 13 22:34:23 2007 +0100

    Make pixman_region_{init,uninit} public

 pixman/src/pixman.h    |    5 +++++
 pixman/src/pixregion.c |   18 ++++++------------
 2 files changed, 11 insertions(+), 12 deletions(-)

commit 4d9065fcebbaf857d8d5fe49bcbb33f270c0bf26
Author: Mathias Hasselmann <mathias@pergamaunz.(none)>
Date:   Tue Mar 13 21:51:46 2007 +0100

    Move struct pixman_region16 to pixman.h

 pixman/src/pixman.h       |    7 ++++++-
 pixman/src/pixregionint.h |    7 +------
 2 files changed, 7 insertions(+), 7 deletions(-)

commit dce3e5e6b556b817bf95182122adbf6f816b71e9
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Apr 6 17:20:49 2007 -0400

    [TODO] Add 4945 Cairo doesn't support 8-bit pseudocolor visuals

 ROADMAP |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 8bb0e5939c0694e88ea9ede4137d7306a067bd17
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Mar 28 20:27:29 2007 +0100

    _get_bitmap_surface - check for calloc failure

 src/cairo-ft-font.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

commit b95577a931645b3013d5acaa5b1bd2d892c3932f
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Mar 28 17:58:31 2007 +0100

    Protect boilerplate_xlib_synchronize from alloc failure.
    
    Don't call XDestroyImage on a NULL image.

 boilerplate/cairo-boilerplate.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit 2a74fd5c7ff21f27013f709dc626be8087cb6a10
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Mar 28 15:50:12 2007 +0100

    Propagate one error return through pdf.

 src/cairo-pdf-surface.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit a2a8f2ce7a0a9bcef7a4a29624725a77c2abe95a
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Apr 5 20:03:51 2007 -0400

    [ROADMAP] Move David Turner's cairo-ft rewrite to 1.6.

 ROADMAP |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 94460a9790ece7a436d6681ab41d7b2365f0775f
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Apr 5 16:35:03 2007 -0700

    ROADMAP/TODO: Update with 1.4.4 and 1.6 items from recent meeting

 ROADMAP |  164 ++++++++++++++++++++++++++-----------------
 TODO    |  236 ++++++++++++++++++++++----------------------------------------
 2 files changed, 183 insertions(+), 217 deletions(-)

commit d801aa59f84d95568e36d02a0ecf3544b9914187
Author: Robert O'Callahan <roc@ocallahan.org>
Date:   Fri Apr 6 00:00:33 2007 +0100

    [quartz] fix floating point precision issue (#10531)
    
    This ensures that error due to double-to-float conversion
    does not accumulate; the position of any glyph will be off by
    at most one double-to-float conversion error.

 src/cairo-quartz-surface.c |   14 ++++++++------
 1 files changed, 8 insertions(+), 6 deletions(-)

commit 106f8590457a7ebb5335d67f16277e8d5a6b04a8
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Apr 4 15:59:50 2007 -0700

    Move misplaced CLEANUP_FONT label to avoid crash.
    
    Previously, a failure in _cairo_win32_scaled_font_init_glyph_path leading
    to the CLEANUP_FONT label would set the path into the glyph, then destroy
    the path, and return an error status, (which in turn would cause a double
    free when the glyph was destroyed).
    
    The double-free apparently leads to a crash in some cases, as described
    here:
    
    	 SVG/Cairo related crash when opening specific webpage
    	https://bugzilla.mozilla.org/show_bug.cgi?id=376498
    
    This should eliminate the double-free, but does not address the original
    error case, (attempting to get a path from a bitmap font?).

 src/cairo-win32-font.c |    4 +---
 1 files changed, 1 insertions(+), 3 deletions(-)

commit 5c24711ee65cdb8ac0fdb7419e6466e2b7cb7d9e
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 4 10:13:13 2007 +0100

    Restore gcov functionality
    
    Add -lgcov to the shared library else the test programs fail to link.
    Add a couple of lcov convenience targets to generate the coverage reports.

 Makefile.am             |   13 ++++++++++++-
 boilerplate/Makefile.am |    2 +-
 configure.in            |   14 ++++++++++++--
 pixman/src/Makefile.am  |    5 ++++-
 src/Makefile.am         |    2 +-
 test/Makefile.am        |    5 +++--
 6 files changed, 33 insertions(+), 8 deletions(-)

commit 59e5189818321c8a62ad107548facbcfce9e517a
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 20:46:14 2007 -0400

    [Makefile.am] Distribute BIBLIOGRAPHY
    Also include all automatically distributed CAPITAL files in there,
    to remove any doubts.

 Makefile.am |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

commit a1287e483ce8efcf3f1eca97bdaaccac2393a1bf
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 20:30:30 2007 -0400

    [pixman/src/check-config.sh] Test that all source files #include <config.h>
    as their first include.

 pixman/src/Makefile.am     |    3 +++
 pixman/src/check-config.sh |   17 +++++++++++++++++
 src/check-cairoint.sh      |    2 +-
 3 files changed, 21 insertions(+), 1 deletions(-)

commit 8fbf50d31da9e13f1e55c7ee19586b7c394684ba
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 20:25:30 2007 -0400

    [src] Make sure all source files #include "cairoint.h" as their first include
    
    This is necessary to avoid many portability problems as cairoint.h includes
    config.h.  Without a test, we will regress again, hence add it.
    
    The inclusion idiom for cairo now is:
    
    	#include "cairoint.h"
    
    	#include "cairo-something.h"
    	#include "cairo-anotherthing-private.h"
    
    	#include <some-library.h>
    	#include <other-library/other-file.h>
    
    Moreover, some standard headers files are included from cairoint.h and need
    not be included again.

 src/cairo-arc.c              |    2 ++
 src/cairo-atsui-font.c       |    5 ++---
 src/cairo-beos-surface.cpp   |    7 ++++---
 src/cairo-directfb-surface.c |   10 +++-------
 src/cairo-freelist.c         |    5 +++--
 src/cairo-ft-font.c          |    4 +++-
 src/cairo-gstate.c           |    2 --
 src/cairo-matrix.c           |    1 -
 src/cairo-os2-surface.c      |   11 ++++++-----
 src/cairo-output-stream.c    |    7 ++++---
 src/cairo-path-fixed.c       |    1 -
 src/cairo-path.c             |    2 ++
 src/cairo-png.c              |    3 ++-
 src/cairo-polygon.c          |    1 -
 src/cairo-quartz-surface.c   |    4 ++--
 src/cairo-region.c           |    2 +-
 src/cairo-skiplist.c         |    6 +-----
 src/cairo-surface-fallback.c |    2 ++
 src/cairo-surface.c          |    3 +--
 src/cairo-truetype-subset.c  |    2 +-
 src/cairo-unicode.c          |    4 +---
 src/cairo-win32-font.c       |    3 +--
 src/cairo-win32-surface.c    |   10 +++++-----
 src/cairo-xlib-screen.c      |    4 ++--
 src/cairoint.h               |    1 +
 src/check-cairoint.sh        |    2 +-
 src/test-fallback-surface.c  |    4 ++--
 src/test-meta-surface.c      |    4 ++--
 src/test-paginated-surface.c |    4 ++--
 29 files changed, 56 insertions(+), 60 deletions(-)

commit ffc7d06da0f97390025a510b9532e4a64e9230f4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 20:22:44 2007 -0400

    [src/check-cairoint.h] Test to check that all source files #include "cairoint.h"
    
    as their first include.

 src/Makefile.am       |    2 +-
 src/check-cairoint.sh |   17 +++++++++++++++++
 2 files changed, 18 insertions(+), 1 deletions(-)

commit 3646839060de7ab51c805bf5614fc3d1ea8b7fc3
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Wed Apr 4 01:16:30 2007 +0100

    [boilerplate] split quartz out to avoid symbol clash.
    
    Quartz and Xlib both define Picture and Cursor, and clashed in
    cairo-boilerplate.c. Splitting quartz out allows a single mac
    build with --enable-quartz --enable-atsui.

 boilerplate/Makefile.am                 |    1 +
 boilerplate/cairo-boilerplate-private.h |   45 +++++++++++++++++++++
 boilerplate/cairo-boilerplate.c         |   44 ++-------------------
 boilerplate/cairo-quartz-boilerplate.c  |   64 +++++++++++++++++++++++++++++++
 4 files changed, 115 insertions(+), 39 deletions(-)

commit 174ebc43fe84854876d642e67fc3a442d280b59e
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 20:01:32 2007 -0400

    [pixman] Make sure all source files include config.h
    as their first include.

 pixman/src/fbcompose.c   |    2 ++
 pixman/src/fbpict.c      |    1 +
 pixman/src/fbtrap.c      |    4 ++++
 pixman/src/icblt.c       |    4 ++++
 pixman/src/icbltone.c    |    4 ++++
 pixman/src/iccolor.c     |    4 ++++
 pixman/src/icformat.c    |    4 ++++
 pixman/src/icpixels.c    |    4 ++++
 pixman/src/icrect.c      |    4 ++++
 pixman/src/icstipple.c   |    4 ++++
 pixman/src/ictransform.c |    4 ++++
 pixman/src/ictrap.c      |    4 ++++
 pixman/src/ictri.c       |    4 ++++
 pixman/src/icutil.c      |    4 ++++
 pixman/src/renderedge.c  |    4 ++++
 15 files changed, 55 insertions(+), 0 deletions(-)

commit 208c32b245d7f50e1e9d71695269128b28a675fc
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 19:56:29 2007 -0400

    [cairoint.h] Remove inline definition for MS compilers
    
    Such things should go to config.h.  For one thing, cairoint.h is not
    included in pixman.

 src/cairoint.h |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

commit 313a6f732112ca88fa4d590a604ce8219065655c
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 19:53:28 2007 -0400

    [pixman] Cleanup inline mess (#10150)
    
    Simply use "inline" instead of "INLINE" or "__inline__" and let
    configure figure out what to use.

 pixman/src/fbcompose.c |    8 ++++----
 pixman/src/fbedge.c    |    8 ++++++--
 pixman/src/fbmmx.c     |   45 +++++++++++++++++++++++----------------------
 pixman/src/fbpict.h    |    6 ------
 pixman/src/icimage.c   |    8 ++++++--
 pixman/src/icint.h     |   12 +-----------
 pixman/src/pixregion.c |   14 ++++++--------
 7 files changed, 46 insertions(+), 55 deletions(-)

commit 88dc0c5f19475888c19db437661b290f3a8902f8
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 19:26:18 2007 -0400

    Make sure all nil objects start with _cairo_
    
    Previously, the convention was that static ones started with cairo_, but
    renamed to start with _cairo_ when they were needed from other files and
    became cairo_private instead of static...
    
    This is error prune indeed, and two symbols were already violating.  Now
    all nil objects start with _cairo_.

 src/cairo-base85-stream.c         |    2 +-
 src/cairo-clip-private.h          |    2 +-
 src/cairo-deflate-stream.c        |    4 ++--
 src/cairo-font-options.c          |   22 +++++++++++-----------
 src/cairo-output-stream-private.h |    2 +-
 src/cairo-output-stream.c         |   20 ++++++++++----------
 src/cairo-pattern.c               |   14 +++++++-------
 src/cairo-ps-surface.c            |    4 ++--
 src/cairo.c                       |    8 ++++----
 src/cairoint.h                    |    2 +-
 10 files changed, 40 insertions(+), 40 deletions(-)

commit 114be945db6c02aeb60cf1123b43680bd12cccdb
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 16:47:39 2007 -0400

    [test] Add svg2pdf

 test/Makefile.am |    6 ++++
 test/svg2pdf.c   |   85 ++++++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 91 insertions(+), 0 deletions(-)

commit b121468f14a6a05a823e06cf7c51caaa1e342556
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 16:27:50 2007 -0400

    [configure.in] Bump version up to 1.4.3, oops!
    Supposed to be done after 1.4.2 was out, but apparently didn't happen.

 configure.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 9710c48df31c66d8931a75b6578c7c861d497baa
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 16:26:48 2007 -0400

    [doc] Update Headers.mk

 doc/public/Headers.mk |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit 040c68cb2ca6c893d9ba11291c21b1cf84fec980
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 16:23:35 2007 -0400

    [test] Make pdf2svg build (and distributed)

 test/Makefile.am |    9 ++++++++-
 1 files changed, 8 insertions(+), 1 deletions(-)

commit 17f5706d1730662bce0cd49f60cb150773fac051
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 16:04:04 2007 -0400

    [pdiff] Make stdint.h inclusion portable (#10441)
    by copying magic bits from cairo-wideint-private.h.

 test/pdiff/pdiff.c |   37 ++++++++++++++++++++++++++++++++++++-
 1 files changed, 36 insertions(+), 1 deletions(-)

commit c2b1908f9b0d8c59abf79c3462471d1c3960b153
Author: Benjamin Berg <benjamin@sipsolutions.net>
Date:   Tue Apr 3 15:46:51 2007 -0400

    Fix typo in cairo_arc_negative() docs (#10497)

 src/cairo.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 814295f5fad43ec1d8b18fac045e3c0d27ec7c29
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Apr 3 15:37:40 2007 -0400

    [autogen.sh] Add --enable-test-surfaces to configure flags
    
    Also remove --enable-maintainer-mode since we removed AM_MAINTAINER_MODE
    from configure.in in b0d05f7421c457120b9d86a83c4935c67b217fab.

 autogen.sh |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)

commit 38c9909e2948f089bbec89e2d43b0e6f930c1ab1
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Apr 3 15:34:30 2007 -0400

    [autogen.sh] Borrow version comparison from GNOME autogen.sh (#9566)
    
    Our previous version check code was thinking that 1.10 is older than 1.7

 autogen.sh |  186 +++++++++++++++++++++++++++++++-----------------------------
 1 files changed, 97 insertions(+), 89 deletions(-)

commit 00cc44373705665824d53c8ebde5df397b834e41
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Mar 26 21:44:33 2007 +0100

    [test/degenerate-path] remove quartz reference image
    
    The reference image is no longer the correct size, so isn't
    providing a comparison at all. In the absence of a better
    replacement, removing it at least gives us diffs.

 test/Makefile.am                          |    1 -
 test/degenerate-path-quartz-rgb24-ref.png |  Bin 188 -> 0 bytes
 2 files changed, 0 insertions(+), 1 deletions(-)

commit 256f3e09a8a0d152a33df00604bf2245604b72bc
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Mar 26 10:33:32 2007 +0100

    Destroy the current pattern before replacing with cairo_set_source().
    
    Frequently cairo_set_source_rgb[a]() is used to replace the current
    solid-pattern source with a new one of a different colour. The current
    pattern is very likely to be unshared and unmodified and so it is likely
    just to be immediately freed [or rather simply moved to recently freed
    cache]. However as the last active pattern it is likely to cache-warm and
    suitable to satisfy the forthcoming allocation. So by setting the current
    pattern to 'none' we can move the pattern to the freed list before we
    create the new pattern and hopefully immediately reuse it.

 src/cairo-pattern.c |   10 ++++++++++
 src/cairo.c         |    9 +++++++++
 src/cairoint.h      |    1 +
 3 files changed, 20 insertions(+), 0 deletions(-)

commit 38442d4948e0a93f06cd86e6841729bc3f25ed3b
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Mon Mar 26 10:12:46 2007 +0100

    Back out the solid-pattern-cache from 9b53bc7c6585db7ae647bb992fb9817d7bd75b38.
    
    Unfortunately one cannot cache live patterns and return a fresh reference
    instead of creating new ones as patterns can be modified by the user and
    so cannot be transparently shared between different users. However,
    solid colour allocation is still a frequent operation, so we maintain a
    small cache of recently freed patterns to reduce the malloc pressure.

 src/cairo-pattern.c |  100 ++++++++++++++++++++++++--------------------------
 1 files changed, 48 insertions(+), 52 deletions(-)

commit c8e37af4b06fffe1aa1a1c3d2cd6481cc2cf8938
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Mar 25 23:31:40 2007 +0100

    [quartz] fix order of fields in matrix conversion
    
    There was a typo flipping the xy and yx fields when a
    cairo matrix was converted to a quartz matrix.

 src/cairo-quartz-surface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit d2cdd5eba801fc5f696d1095f237ae53c54b4e2a
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sat Mar 24 13:25:03 2007 +0000

    [atsui] fix scaling  of glyph surfaces (#9568)
    
    Atsui glyph surface were clipped incorrectly when the text is scaled,
    visible in the text-pattern test.

 src/cairo-atsui-font.c |   10 ++++++++--
 1 files changed, 8 insertions(+), 2 deletions(-)

commit 2efaf3a7a47a281ca02009d371cd7a06a8a4f282
Merge: abac4d2... 25ddc08...
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Sat Mar 24 00:29:04 2007 +0100

    Merge branch 'master' of git+ssh://hasselmm@git.freedesktop.org/git/cairo

commit abac4d251dd02151dced296afa9d6e1b383868ee
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Fri Mar 23 23:36:15 2007 +0100

    [cairo-perf] Use full 64 bit of the clock cycle counters to avoid overflows

 perf/cairo-perf-posix.c |   22 ++++++++++++++--------
 1 files changed, 14 insertions(+), 8 deletions(-)

commit 25ddc0800490ca0222668e389412f92ccfdab91c
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Mar 23 23:19:30 2007 +1030

    PS: Remove unused variable

 src/cairo-ps-surface.c |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit e9a26966484171f94df41bd3abc83aae22682caa
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Fri Mar 23 23:08:46 2007 +1030

    PDF: Use the TJ operator to show glyphs

 src/cairo-pdf-surface.c                 |  125 ++++++++++++++++++++++++++-----
 src/cairo-ps-surface.c                  |   11 ++-
 src/cairo-scaled-font-subsets-private.h |   25 ++++++-
 src/cairo-scaled-font-subsets.c         |   83 ++++++++++++++++-----
 src/cairo-svg-surface.c                 |    7 +-
 5 files changed, 201 insertions(+), 50 deletions(-)

commit 820341b4c503fbd5ca3b8f6c3e5ff6eca5562b98
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 21 15:44:18 2007 -0400

    [test/nil-surface] Test that cairo_get_target() returns non-NULL

 test/nil-surface.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

commit ef8515b4a6b468e589639e794a959cb37d592359
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 21 15:29:18 2007 -0400

    cairo_push/pop_group(), bail out if cairo_t is in error status
    
    Fixes the new test added to test/nil-surface to not crash

 src/cairo.c |    9 ++++++---
 1 files changed, 6 insertions(+), 3 deletions(-)

commit 52341f7e855c93fc8e58895c3a318c43c3d58474
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 21 15:21:05 2007 -0400

    [test/nil-surface] Test cairo_create(NULL).  Crashing in cairo_push_group!

 test/nil-surface.c |   19 +++++++++++++++++++
 1 files changed, 19 insertions(+), 0 deletions(-)

commit 9cea8a4bb26f7de2ac56e318c72e7d048b8b6c0f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 21 15:03:02 2007 -0400

    [cairo.c] Don't access gstate members directly

 src/cairo-gstate.c |   18 ++++++++++++++++++
 src/cairo.c        |   23 +++++++++++------------
 src/cairoint.h     |    3 +++
 3 files changed, 32 insertions(+), 12 deletions(-)

commit 39ae64ff0391c40077b63d214727ca0c25e03e37
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 21 14:56:34 2007 -0400

    [cairo-path] Don't access gstate members directly

 src/cairo-path.c |    7 ++++---
 1 files changed, 4 insertions(+), 3 deletions(-)

commit bd275c19782700f2cfc6905f348e4d4b3f15d311
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 21 12:34:37 2007 -0400

    [cairo-pattern] Make sure cached solid patterns are not put in error status

 src/cairo-pattern.c |   19 +++++++++++++++----
 1 files changed, 15 insertions(+), 4 deletions(-)

commit e76d3cfa4f06ba813528a018fa77ba4d210a44e3
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 21 12:33:31 2007 -0400

    [cairo-gstate] Make sure gstate->next is initialized

 src/cairo-gstate.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 1469ea22ba659ba7afa6892e9b6b2a3f26d0dddb
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 21 11:22:33 2007 -0400

    [cairo-gstate] Move save/restore logic into gstate instead of cairo_t
    by adding _cairo_gstate_save/restore().  This is in preparation for
    adding copy-on-write behavior to gstate.

 src/cairo-gstate.c |   53 ++++++++++++++++++++++++++++++++++++++++++++++++++-
 src/cairo.c        |   32 +++++++++---------------------
 src/cairoint.h     |    8 +++---
 3 files changed, 65 insertions(+), 28 deletions(-)

commit 5f83a1b542a1932a59299a45f36dff22268dca14
Author: Jeff Smith <whydoubt@yahoo.com>
Date:   Wed Mar 21 10:41:03 2007 -0400

    [cairo-output-stream] Remove use of strtol

 src/cairo-output-stream.c |    8 +++-----
 1 files changed, 3 insertions(+), 5 deletions(-)

commit bba7169805cec96b442d15241b0fdf8c38d0cd0e
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 20 22:55:02 2007 -0400

    Fix file permissions again
    
    Where do these a+x attributes coming from every once in a while?

 0 files changed, 0 insertions(+), 0 deletions(-)

commit ad51ee5aa0d1fc03c4ebe7f0454949995420a710
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 20 18:59:19 2007 -0400

    Define and use ARRAY_LEN

 src/cairo-arc.c             |    2 +-
 src/cairo-atsui-font.c      |    6 ++----
 src/cairo-bentley-ottmann.c |    2 +-
 src/cairo-cff-subset.c      |    8 +++-----
 src/cairo-hash.c            |    2 +-
 src/cairo-pattern.c         |    2 +-
 src/cairo-polygon.c         |    2 +-
 src/cairo-spline.c          |    2 +-
 src/cairo-surface.c         |    2 +-
 src/cairo-svg-surface.c     |    2 +-
 src/cairo-traps.c           |    2 +-
 src/cairo-truetype-subset.c |    8 +++-----
 src/cairoint.h              |    3 +++
 13 files changed, 20 insertions(+), 23 deletions(-)

commit 1de12714a9623e66309279eb9edaf6053fd92c56
Author: Chris Wilson <chris at chris-wilson.co.uk>
Date:   Wed Mar 14 01:31:58 2007 +0000

    [cairo-surface] Use a stack buffer for small numbers of rectangles

 src/cairo-surface.c |   13 +++++++++----
 1 files changed, 9 insertions(+), 4 deletions(-)

commit 9b53bc7c6585db7ae647bb992fb9817d7bd75b38
Author: Chris Wilson <chris at chris-wilson.co.uk>
Date:   Tue Mar 13 22:51:12 2007 +0000

    Cache solid patterns
    
    We use a small cache of size 16 for patterns created from solid colors,
    e.g. cairo_set_source_rgb(). This helps with toolkits that draw many
    widgets using the same colour scheme.
    
    The cache uses a static index variable, which itself acts like a cache
    of size 1, remembering the most recently used colour. So repeated
    lookups for the same colour hit immediately. If that fails, the cache
    is searched linearly, and if that fails too, a new pattern is created
    and a random member of the cache is evicted.

 src/cairo-color.c                 |    7 +++
 src/cairo-debug.c                 |    2 +
 src/cairo-mutex-list.h            |    2 +
 src/cairo-pattern.c               |   63 +++++++++++++++++++++++++++-
 src/cairoint.h                    |    7 +++
 test/Makefile.am                  |    1 +
 test/solid-pattern-cache-stress.c |   83 +++++++++++++++++++++++++++++++++++++
 7 files changed, 163 insertions(+), 2 deletions(-)

commit 39679b1b21b07b0fbc05ee21745f384a123ba8da
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 20 18:01:41 2007 -0400

    [cairo-path-fixed] Fix "comparison between signed and unsigned" warnings

 src/cairo-path-fixed.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit c939421e16fcf098f8d6196e86705173be8e40fd
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 20 08:54:01 2007 -0400

    Oops.  Remove cairo-mutex-private.h include from test surfaces
    as that file is included from cairoint.h now.

 src/test-fallback-surface.c  |    1 -
 src/test-meta-surface.c      |    1 -
 src/test-paginated-surface.c |    1 -
 3 files changed, 0 insertions(+), 3 deletions(-)

commit 0d3e886b182b55b147f2ba1a298c2f5ec8a53d87
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 20 08:49:28 2007 -0400

    Include cairo-mutex-private.h in test backends

 src/test-fallback-surface.c  |    1 +
 src/test-meta-surface.c      |    2 ++
 src/test-paginated-surface.c |    1 +
 3 files changed, 4 insertions(+), 0 deletions(-)

commit 0263f18f843175e478bd3a14e24445e31e7b0952
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 20 08:47:45 2007 -0400

    [configure.in] Define PIXMAN_CFLAGS, to pass -fno-strict-aliasing to pixman

 configure.in           |   10 +++++++---
 pixman/src/Makefile.am |    4 +---
 2 files changed, 8 insertions(+), 6 deletions(-)

commit 94c367f7d7637fc74ed6d1fbe13d73662c08246b
Merge: c4bd7cf... d3177a6...
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Tue Mar 20 13:33:50 2007 +0100

    Merge branch 'master' of git+ssh://hasselmm@git.freedesktop.org/git/cairo

commit c4bd7cf6f85770552c0b0284db219f27ffa702f2
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Tue Mar 20 13:32:33 2007 +0100

    Move declaration of cairo_mutex_t to cairo-mutex-private.h

 src/cairo-font.c              |    1 -
 src/cairo-ft-font.c           |    1 -
 src/cairo-mutex-private.h     |   53 ++++++++++++++++++++++++++++++++++-------
 src/cairo-mutex.c             |    6 +++-
 src/cairo-paginated-surface.c |    1 -
 src/cairo-pattern.c           |    1 -
 src/cairo-scaled-font.c       |    1 -
 src/cairo-surface.c           |    1 -
 src/cairo-xlib-screen.c       |    1 -
 src/cairoint.h                |   37 +---------------------------
 10 files changed, 49 insertions(+), 54 deletions(-)

commit 9c52a9e7d8a70d21ecdd4fa241fa2594361dd5df
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Tue Mar 20 13:05:48 2007 +0100

    Remove _global_image_glyph_cache_mutex which is not used anymore.

 src/cairo-mutex-list.h |    4 ----
 1 files changed, 0 insertions(+), 4 deletions(-)

commit d3177a68752ac2c8d20b1a8a3616298f04f31078
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 20 07:59:47 2007 -0400

    [cairo-mutex] Rename _xlib_screen_mutex to _cairo_xlib_screen_mutex

 src/cairo-mutex-list.h  |    2 +-
 src/cairo-xlib-screen.c |   20 ++++++++++----------
 2 files changed, 11 insertions(+), 11 deletions(-)

commit be52178443ffd19fc7848dfc78c477883ccb943b
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Tue Mar 20 10:11:14 2007 +0100

    Initialize mutexes at central location.
    
    All mutex declarations have been moved to cairo-mutex-list.h.
    This should avoid breaking of less frequently tested backends,
    when mutexes are introduced or when existing mutexes are renamed.
    
    Instead of initializing mutexes on library startup, mutexes are
    lazily initialized within the few entry points of now by calling
    CAIRO_MUTEX_INITIALIZE(). Currently only the OS/2 backend takes
    care about releasing global mutexes. Therefore there is no counter
    part of that macro for finalizing all global mutexes yet - but
    as cairo-backend-os2.c shows such a function would be quite
    easy to implement.

 src/Makefile.am               |    1 +
 src/cairo-font.c              |    7 +-
 src/cairo-ft-font.c           |    3 +-
 src/cairo-mutex-list.h        |   52 +++++++++++++++++
 src/cairo-mutex-private.h     |  123 +++++++++++++++++++++++++++++++++++++++++
 src/cairo-mutex.c             |   51 +++++++++++++++++
 src/cairo-os2-surface.c       |   45 +--------------
 src/cairo-paginated-surface.c |    1 +
 src/cairo-pattern.c           |    3 +
 src/cairo-scaled-font.c       |    3 +-
 src/cairo-surface.c           |    5 +-
 src/cairo-win32-font.c        |   10 ---
 src/cairo-win32-private.h     |    3 -
 src/cairo-win32-surface.c     |   65 ---------------------
 src/cairo-xlib-screen.c       |    3 +-
 src/cairoint.h                |   71 +++++-------------------
 16 files changed, 257 insertions(+), 189 deletions(-)

commit aba2b299db163d8a5b9d0a0214cd8a485fb87162
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Mar 19 23:50:13 2007 -0700

    boilerplate: Add EXTRA_LTLIBRARIES to CLEANFILES to allow make distcleancheck to pass.

 boilerplate/Makefile.am |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

commit 2483542b74ac71851cc766de3468d0df833cdec2
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Mar 19 23:37:28 2007 -0700

    Add skew-extreme-ref.png to the tar file for the release.

 test/Makefile.am |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit b91ff39214675faea5d3627ecf86a24aeb8b178f
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Mar 19 23:24:26 2007 -0700

    Increment cairo version to 1.4.2 (and libtool versioning to 13:1:11)

 configure.in |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 04b3de48f5269cae483b4af425402679a35e7d33
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Mar 19 23:22:39 2007 -0700

    NEWS: Add notes for cairo 1.4.2

 NEWS |  130 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 files changed, 130 insertions(+), 0 deletions(-)

commit 1401f20eb91f34d992612162db0c9e04bd666114
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Mar 19 22:39:40 2007 -0700

    Temporarily remove extend-reflect from the list of tests.
    
    This test is known to sometimes cause an X server to enter a near-
    infinite loop. That's a reall unkind thing to inflict upon our
    users who are being nice enough to test cairo. Let's disable
    this test for the 1.4.2 release.

 test/Makefile.am |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit 725a4de42dfaf0d9d98447c9fbefed99fbf99ac1
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Mar 19 16:50:55 2007 -0700

    Propagate a nil surface out of _cairo_surface_create_similar_scratch
    
    We detect an error in the surface before calling into private surface-modifying
    functions, (such as _cairo_surface_set_font_options), that don't have the
    nil-surface protection of public functions.
    
    This should fix the problem reported (again) in this bug report:
    
    	cairo crashes in cairo_create_simular if nil surface returned by other->backend->create_similar
    	https://bugs.freedesktop.org/show_bug.cgi?id=9844
    
    Though I haven't succeeded in replicating the bug yet, (perhaps a system
    difference in allowing writes to read-only memory or not, or something
    like that).

 src/cairo-surface.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

commit eb472a9d9cbaea754907a261b459693b9c27ac79
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Mar 19 13:13:41 2007 -0700

    xlib: Prefer surface->format over surface->visual for identifying masks
    
    The original test for 'if (surface->visual)' dates back to a very old
    assumption that if the xlib surface was created with an XRenderFormat
    that the surface->visual field would be set to NULL. This assumption
    was broken years ago with the following commit:
    
    	0c05b23b3165ec6908c28f56b3446cf43dff44a2
    
    This fixes the crash reported here:
    
    	BadMatch when running gnome-terminal with the murrine-0.51 gtk engine
    	https://bugs.freedesktop.org/show_bug.cgi?id=10250

 src/cairo-xlib-surface.c |   27 +++++++++++++++------------
 1 files changed, 15 insertions(+), 12 deletions(-)

commit d27c42cc3fcd4376fc69aa68d997e6077c3eca90
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Mar 19 17:42:06 2007 -0400

    [boilerplate] Don't build in make all

 boilerplate/Makefile.am |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 12feb1f98627637bf83ba70f739bb5b2699085aa
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Mar 19 18:22:44 2007 +0000

    [quartz] apply ctm to text (#9568)
    
    Applies the ctm to text output on the quartz surface. This corrects
    the text-pattern test, and also corrects the size of text when the
    ctm includes a scale.

 src/cairo-quartz-surface.c |    9 ++++++++-
 1 files changed, 8 insertions(+), 1 deletions(-)

commit 986b0ff83813b68a19490fe8629bfdaeed68cbe2
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Mon Mar 19 18:21:27 2007 +0000

    [atsui] make text_to_glyphs return positions in user units. (#9568)
    
    text_to_glyphs was returning positions in device units; correct this
    to use user units.

 src/cairo-atsui-font.c |   14 +++++++++++++-
 1 files changed, 13 insertions(+), 1 deletions(-)

commit 06a44839270354c7f74aa66352fb4234095dee4e
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Mar 18 20:20:11 2007 +0000

    [atsui] store sizes in the atsui font
    
    The ATSUStyle that we store in the font contains references to
    the size and font matrix; we need to store them in the font so that
    they are not released before the style.

 src/cairo-atsui-font.c |   16 +++++++++-------
 1 files changed, 9 insertions(+), 7 deletions(-)

commit 240479d10d3263719b0c8a4426fda088899551a2
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Mar 18 20:20:10 2007 +0000

    [atsui] refactor CreateSizedCopyOfStyle
    
    This is just to make it easier to use with passed-in matrices,
    which I'll make use of in a subsequent patch.

 src/cairo-atsui-font.c |   36 ++++++++++++++++++++----------------
 1 files changed, 20 insertions(+), 16 deletions(-)

commit 43577e26b4c2285499ebfddba6cfa62cbbb15feb
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Sun Mar 18 20:20:10 2007 +0000

    [atsui] remove the unused old_show_glyphs function.
    
    _cairo_atsui_old_show_glyphs was a relic of the old quartz
    surface and is no longer required.

 src/cairo-atsui-font.c |  180 ++++--------------------------------------------
 1 files changed, 15 insertions(+), 165 deletions(-)

commit 5aaf584bf44d762af5e486f21a037eb0cc6e1197
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Mar 16 17:45:31 2007 -0700

    XCB: Fix parameter-order confusion with xcb_create_pixmap
    
    This fixes mask-based clipping with the XCB backend, (which also makes
    the xcb backend pass all tests that the xlib backend passes).

 src/cairo-xcb-surface.c |    7 +++----
 1 files changed, 3 insertions(+), 4 deletions(-)

commit 6f96a5dd9954418b252ec45752dcf2c3b289fed4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Mar 16 18:21:36 2007 -0400

    [win32] Really return unhinted font metrics if metrics hinting is off

 src/cairo-win32-font.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 47e71eef5f903fa1a96d82a79a75d89c52032913
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Mar 16 17:56:53 2007 -0400

    [win32] Fix font descent computation

 src/cairo-win32-font.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit dd4601b0d03bba021b11dcf96e09584f40d1621f
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Fri Mar 16 20:43:29 2007 +0100

    [cairo-perf] Emit warning, if cairo-perf is not CPU bound
    
    	cairo-perf and the X server should be bound to CPUs (either the same
    	or separate) on SMP systems. Not doing so causes random results when
    	the X server is moved to or from cairo-perf's CPU during the
    	benchmarks.

 configure.in      |   11 +++++++++++
 perf/cairo-perf.c |   52 ++++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 63 insertions(+), 0 deletions(-)

commit d02aa5b23eb6243b21697de203db0a5f1b49def9
Author: Gilles Dauphin <dauphin@enst.fr>
Date:   Fri Mar 16 10:35:23 2007 -0700

    Don't use unsupported visibily attribute hidden on Solaris
    
    Thanks to Thomas Klausner for passing the report along.
    This fixes the following bug report:
    
    	hidden attribute does not work with Solaris ld
    	https://bugs.freedesktop.org/show_bug.cgi?id=10227
    
    And as Behdad points out, an even better fix would be to
    move checks for supported visibility attribute to configure.

 pixman/src/pixman.h |    2 +-
 src/cairoint.h      |    4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

commit 8236282c5d58320173b17659e488384e710d0ea7
Author: Thomas Klausner <wiz@danbala.tuwien.ac.at>
Date:   Fri Mar 16 10:04:56 2007 -0700

    Use "find !" rather than "find -not" for better portability
    
    The man page for GNU find says:
           -not expr
                  Same as ! expr, but not POSIX compliant.
    
    And actually, on e.g. NetBSD, "-not" is not supported.
    
    This resolved the following bug:
    
    	https://bugs.freedesktop.org/show_bug.cgi?id=10226

 RELEASING            |    2 +-
 src/check-headers.sh |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

commit 332c38b6c34bde4829607e534f39522f8001acf7
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Mar 15 23:25:06 2007 -0700

    Avoid pulling in -lz for the ps backend.
    
    Quite some time ago we switched from using deflate-based compression to LZW
    for the ps backend, (which allows it to target PostScript Level 2 instead of
    PostScript Level 3). Now, we finally drop the fact that the ps backend was
    still requiring zlib in order to build.

 configure.in |    6 +-----
 1 files changed, 1 insertions(+), 5 deletions(-)

commit 2242550b489472d4d9b6505fd3db89541e101425
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Mar 15 23:17:19 2007 -0700

    Make compilation of cairo-deflate-stream.c conditional on compilation of PDF backend.
    
    Otherwise we risk pulling in an otherwise-unneeded dependency on zlib.
    
    This fixes the bug reported here:
    
    	Without PDF surface backend we don't need cairo-deflate-stream
    	https://bugs.freedesktop.org/show_bug.cgi?id=10202

 src/Makefile.am |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

commit 1234064fa4aa20d0875473709d2fa74600af485b
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Mar 15 22:38:42 2007 -0700

    Allow NULL pointers for functions that accept pointers for multiple return values.
    
    When a single function accepts pointers for multiple return values,
    the convention is that it's legal for the user to pass NULL for
    those pointers in case the user is only interested in some subset
    of the values.
    
    This was already properly implemented for functions such as
    cairo_pattern_get_rgba, etc.
    
    Here we fix four functions to follow the same convention:
    
    	cairo_stroke_extents
    	cairo_fill_extents
    	cairo_clip_extents
    	cairo_surface_get_device_offset

 src/cairo-gstate.c  |   44 +++++++++++++++++++++++++++++++++-----------
 src/cairo-surface.c |    6 ++++--
 2 files changed, 37 insertions(+), 13 deletions(-)

commit 133183d858aa632da3cec2a789dcc1e1203d778b
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Mar 15 22:08:55 2007 -0700

    Fix cairo_stroke_extents and cairo_in_stroke to not crash with line width of 0.0
    
    This fixes the line-width-zero test case and the bug reported here:
    
    	Crash in cairo_stroke_extents whe line width is 0 and line cap is ROUND
    	(_cairo_pen_find_active_cw_vertex_index)
    	https://bugs.freedesktop.org/show_bug.cgi?id=10231

 src/cairo-gstate.c |   10 ++++++++++
 1 files changed, 10 insertions(+), 0 deletions(-)

commit 23caa0f43ba199371ab178cf3e827e449ee5935f
Author: Carl Worth <cworth@cworth.org>
Date:   Thu Mar 15 21:58:20 2007 -0700

    Add line-width-zero test which currently crashes.
    
    The crash is described in this bug report:
    
    	Crash in cairo_stroke_extents whe line width is 0 and line cap is ROUND
    	(_cairo_pen_find_active_cw_vertex_index)
    	https://bugs.freedesktop.org/show_bug.cgi?id=10231

 test/.gitignore        |    1 +
 test/Makefile.am       |    1 +
 test/line-width-zero.c |   79 ++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 81 insertions(+), 0 deletions(-)

commit 562bd551bc5ca3f3858a66b9884a8525531153c8
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Thu Mar 15 12:47:41 2007 +0100

    [cairo-perf-diff] Update usage screen to mention --html.

 perf/cairo-perf-diff |   73 ++++++++++++++++++++++++++++---------------------
 1 files changed, 42 insertions(+), 31 deletions(-)

commit 6ff2439b33a9da9a517325bfd472e8cb1fdd4992
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Mar 14 16:33:01 2007 -0700

    Implement _cairo_traps_tessellate_triangle with _cairo_traps_tessellate_convex_quad
    
    The newly rewritten convex_quad code is actually simpler than the
    triangle code being replaced here. This also allows us to throw
    away the problematic _compute_x function which can't handle
    horizontal lines, (divide by zero). So the cairo world becomes a
    better place.

 src/cairo-traps.c |   89 +++++-----------------------------------------------
 1 files changed, 9 insertions(+), 80 deletions(-)

commit 53ae6ea957bac141c033f41276d93bab3a25009f
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Mar 14 16:30:48 2007 -0700

    Fix _cairo_traps_tessellate_convex_quad to handle a == b
    
    This case was found in an attempt to use the convex_quad function
    for tessellating triangles as well. Fortunately the fix is very
    easy.

 src/cairo-traps.c |   14 +++++++++++++-
 1 files changed, 13 insertions(+), 1 deletions(-)

commit 96d8f58daf279238d3a1dfcd4ed3710014e2aeea
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Mar 13 20:17:22 2007 +0000

    Clear the XRender data on display closure.
    
    Use the new hook functions to register a callback for xlib to clear
    the private glyph data when the display is closed. In order to do this
    we need to reset the glyph cache inside the generic scaled font as well.

 src/cairo-xlib-surface.c |   25 +++++++++++++++++++++++++
 1 files changed, 25 insertions(+), 0 deletions(-)

commit 52405533b1b191ff98ef3cbc20eaf55e97c8049c
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Mar 13 20:42:09 2007 +0000

    Privately export a function to reset the scaled font's glyph caches.

 src/cairo-scaled-font.c |    9 +++++++++
 src/cairoint.h          |    3 +++
 2 files changed, 12 insertions(+), 0 deletions(-)

commit ad7698feb5f818ba2657b01bbc04f7fb537c1297
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Tue Mar 13 20:11:49 2007 +0000

    Introduce hooks for _cairo_xlib_close_display()
    
    This patch adds a simple hook data type for a notifier style callback
    and introduces two functions to manipulate a list of callbacks for
    cleaning up on display closure.

 src/cairo-xlib-private.h |   15 +++++
 src/cairo-xlib-screen.c  |  153 ++++++++++++++++++++++++++++++++++++----------
 2 files changed, 136 insertions(+), 32 deletions(-)

commit 3d3173d176bc959682a35674c31d3155e8642c41
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Mar 14 16:56:45 2007 -0700

    Add svg-specific reference image for radial-gradient test.
    
    This isn't strictly needed, (pdiff allows the test to pass without the
    image), but it sure runs faster this way.

 test/radial-gradient-svg-ref.png |  Bin 0 -> 91039 bytes
 1 files changed, 0 insertions(+), 0 deletions(-)

commit 75201c12be74055d6209d48d1d698797665a70b4
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Mar 14 15:48:15 2007 -0700

    check-def.sh: Adjust test to exempt _cairo_test_* functions as well as _cairo_*_test_*
    
    This test started failing with the recent renaming of the following
    three functions, (before they had no cairo in their names so they
    were not getting picked up at all):
    
    _cairo_test_fallback_surface_create
    _cairo_test_meta_surface_create
    _cairo_test_paginated_surface_create_for_data
    
    With this change, the failure now goes away again.

 src/check-def.sh |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 5d23d0c90c31b233d5916c12eaf2a1dafc441243
Author: Carl Worth <cworth@cworth.org>
Date:   Wed Mar 14 15:23:01 2007 -0700

    Remove dead-code remnants of old tessellator

 src/cairo-traps.c |  372 -----------------------------------------------------
 1 files changed, 0 insertions(+), 372 deletions(-)

commit 1f3a5b4e1283cc0e55f7ea6baca6d0fe67fd14b1
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Mar 13 17:42:39 2007 -0700

    Fix bugs in _cairo_traps_tessellate_convex_quad
    
    The previous code was not handling all cases correctly, (yes,
    even something as simple as a quadrilateral can exhibit a
    remarkably large number of different cases when tessellation
    is attempted).
    
    This fix now introduces slope comparison which handles several
    cases that were mis-handled with the previous implementation which
    only used independent sorting of the X and Y values of the
    coordinates.
    
    This fixes the skew-extreme test case and the bug reported here:
    
    	Skew transforms were broken by the cairo update in December
    	https://bugzilla.mozilla.org/show_bug.cgi?id=373632

 src/cairo-traps.c |  101 +++++++++++++++++++++++++++++++----------------------
 1 files changed, 59 insertions(+), 42 deletions(-)

commit 0a6ae06c35d99e5e8397c58ee94291e7ee45eb4e
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Mar 13 17:39:48 2007 -0700

    Add new skew-extreme test case.
    
    This test currently fails, demonstrating the bug reported here:
    
    	Skew transforms were broken by the cairo update in December
    	https://bugzilla.mozilla.org/show_bug.cgi?id=373632

 test/.gitignore           |    1 +
 test/Makefile.am          |    1 +
 test/skew-extreme-ref.png |  Bin 0 -> 1012 bytes
 test/skew-extreme.c       |  126 +++++++++++++++++++++++++++++++++++++++++++++
 4 files changed, 128 insertions(+), 0 deletions(-)

commit 40b6d8842e1bcb5fbb3a7dffd0c05b7d3bf6cc6b
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Mar 13 13:07:42 2007 -0700

    Remove radial-gradient test from XFAIL list
    
    This test has not been failing since the fix in:
    
    	772edc9133d41dfd667ae5915dfa6ace0bcbfd0d
    
    So get rid of the '1 unexpected passes' complaint.

 test/Makefile.am       |    1 -
 test/radial-gradient.c |    3 +--
 2 files changed, 1 insertions(+), 3 deletions(-)

commit e803e2e69ba02a1db316c97eb9a8d386709380e2
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 14 17:23:57 2007 -0400

    [cairo-pattern] Add a cache of two color stops to cairo_gradient_pattern_t
    
    Most of gradients have only two color stops.  This avoids
    calling malloc() for those cases.

 src/cairo-pattern.c |   25 +++++++++++++++++++++----
 src/cairoint.h      |    1 +
 2 files changed, 22 insertions(+), 4 deletions(-)

commit 4514fdca1ba0f3922c2797744f4b0d42d37f8b42
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 20:49:52 2007 -0400

    [cairo-pattern] Grow color-stops array exponentially

 src/cairo-pattern.c |   61 ++++++++++++++++++++++++++++++++++++---------------
 src/cairoint.h      |    3 +-
 2 files changed, 45 insertions(+), 19 deletions(-)

commit e878f2259b2512f0411d698bf078fe91b7373246
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 11:42:41 2007 +0100

    Include pixman/src in cairo-perf hash

 perf/cairo-perf-diff |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

commit 1a3f5df5ff4a80bb199e296491e3a5c9887fd4f7
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 21:42:50 2007 +0100

    Add index.html to .gitignore

 perf/.gitignore |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit c40be43aef735deba7605fde14300b7810701011
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 21:41:40 2007 +0100

    Transform the output of cairo-perf-diff into HTML

 perf/Makefile.am     |    8 ++++-
 perf/cairo-perf-diff |   20 ++++++++---
 perf/make-html.py    |   89 ++++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 111 insertions(+), 6 deletions(-)

commit f1dd48475a34a038ebdb6426b04fc3728a0f0782
Author: Mathias Hasselmann <mathias.hasselmann@gmx.de>
Date:   Wed Mar 14 21:18:09 2007 +0100

    Improve CPU utilization when building cairo-perf

 perf/cairo-perf-diff |   11 +++++++++++
 1 files changed, 11 insertions(+), 0 deletions(-)

commit a7595c1295ba1a58b452b1df31d02776e5c17c0f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 17:21:19 2007 -0400

    [Makefile.am] Do not distribute cairo-features.h, Ouch!
    
    We were accidentally doing that by not marking it noinst.
    Moreover, no need to mark it as BUILD_SOURCES, since it's
    created by configure, not make.

 src/Makefile.am |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit f3c8d82d6d6a759364c4228d9b0badf846debcea
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 16:51:34 2007 -0400

    [test] If backends are limited and all untested, pass the test
    This is necessary to ensure that limiting backends using
    CAIRO_TEST_TARGET does not increase the number of tests failing,
    which is a desirable invariant.

 test/cairo-test.c |   44 +++++++++++++++++++++++++++++---------------
 1 files changed, 29 insertions(+), 15 deletions(-)

commit 30b5f1baa8cbd01ac0a3ff376e294775b600b4e4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 16:50:10 2007 -0400

    [test] In pattern-getters test, log what went wrong

 test/pattern-getters.c |   14 +++++++++++---
 1 files changed, 11 insertions(+), 3 deletions(-)

commit 9267cb042418250614db83bd3b2dcb0e7615af79
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 16:49:42 2007 -0400

    [cairo-pattern] Use _cairo_color_double_to_short() to fix color conversion

 src/cairo-pattern.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit 60502ba3481ea751df6f379e1c38850172826695
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 16:13:35 2007 -0400

    [cairo-color] Add cairo-private _cairo_color_double_to_short()

 src/cairo-color.c |   11 ++++++-----
 src/cairoint.h    |    3 +++
 2 files changed, 9 insertions(+), 5 deletions(-)

commit 956fdfbb62ac82da1e6fbd467c50e449ec621937
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 06:30:11 2007 -0400

    [cairo-pattern] Fix color conversion from short to double
    We should divide by 65535.0, not 65536.0.

 src/cairo-pattern.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit 20304908626f0af40aeda145b2967a40151728c5
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 06:20:21 2007 -0400

    [cairo-pattern] Add XXX note

 src/cairo-pattern.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

commit deed0f473400bc2e91dde8bad2537d499a5941ea
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 06:09:09 2007 -0400

    [polygon,spline,traps] Avoid free(NULL)

 src/cairo-polygon.c |    2 +-
 src/cairo-spline.c  |    2 +-
 src/cairo-traps.c   |    2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

commit b706bd9b38d505d2b09e932a8f362fac76ef64de
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 06:07:03 2007 -0400

    [cairo-polygon] Add a cache of eight edges to cairo_polygon_t
    
    Many, if not most, of polygons have very few edges.  This avoids
    calling malloc() for those cases.

 src/cairo-polygon.c |   30 +++++++++++++++++++++++-------
 src/cairoint.h      |    1 +
 2 files changed, 24 insertions(+), 7 deletions(-)

commit d8165d5424718404946c3a72d59396fc604d1bce
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 05:59:33 2007 -0400

    [cairo-spline] Fix typo in comment

 src/cairo-spline.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit cca7e3fec3a3ec68f812690aa7efafa7dc237849
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 05:56:38 2007 -0400

    [cairo_polygon_t] Change has_current_point from int to cairo_bool_t

 src/cairo-polygon.c |    8 ++++----
 src/cairoint.h      |    2 +-
 2 files changed, 5 insertions(+), 5 deletions(-)

commit 81e15a454b188aa8dd03eb599d0fb4af834695f1
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 05:55:45 2007 -0400

    [cairo_polygon_t] Remove unused member 'closed'

 src/cairoint.h |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

commit 2bf4ce389d05e07698e03374c3d05436f5d2b2e4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 05:53:13 2007 -0400

    [cairo_polygon_t] Reorder struct members for clarity

 src/cairoint.h |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit 3ce84390de8be69f369a4da80c3039b716ebb0e4
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 05:51:39 2007 -0400

    [cairo-polygon] Clean-up realloc algorithm for clarity

 src/cairo-polygon.c |   18 +++++++-----------
 1 files changed, 7 insertions(+), 11 deletions(-)

commit 6976ab1392e0fd07a081e6d6056510070e1d6df9
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Fri Mar 9 16:23:35 2007 -0500

    [cairo-slope] Make comparison stable if both vectors are zero

 src/cairo-slope.c |    8 +++++++-
 1 files changed, 7 insertions(+), 1 deletions(-)

commit 9eee167210b6cc562014652572872cf0a7ccb00e
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 22:34:44 2007 -0500

    [cairo-spline] Add a cache of eight points to cairo_spline_t
    
    Most of the splines need not more than eight points.  This avoids
    calling malloc() for those cases, and eight-points take only 64 bytes.

 src/cairo-spline.c |   28 +++++++++++++++++++++++-----
 src/cairoint.h     |    1 +
 2 files changed, 24 insertions(+), 5 deletions(-)

commit 1e64ecf0758a208b469ae0a87a747b3a70c70ceb
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 22:17:30 2007 -0500

    [cairo-spline] Clean-up realloc algorithm for clarity

 src/cairo-spline.c |   17 +++++++----------
 1 files changed, 7 insertions(+), 10 deletions(-)

commit cee687a33fb46b68d39bbfa64c44f0b28e10a9ee
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 22:19:49 2007 -0500

    [cairo_traps_t] Reorder struct members for clarity

 src/cairoint.h |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

commit 24aec99ffb9abce659146ea6ecbfb92856355855
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 20:32:36 2007 -0500

    [cairo-traps] Add a cache of one trapezoid to cairo_traps_t
    
    Seems like half the time, we just need one trap.  This avoids
    calling malloc() for those cases.

 src/cairo-traps.c |   30 +++++++++++++++++++++++-------
 src/cairoint.h    |    2 ++
 2 files changed, 25 insertions(+), 7 deletions(-)

commit 4737416c6e7829ec21230103a1b993d2bd08cc0e
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 20:05:13 2007 -0500

    [cairo-traps] Clean-up realloc algorithm for clarity

 src/cairo-traps.c |   21 +++++++++------------
 1 files changed, 9 insertions(+), 12 deletions(-)

commit a9d8cb3e8aceb5831dfb3920df1502bf3b9450a6
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 19:34:43 2007 -0500

    [cairo-traps] Use INT32_MIN/MAX instead of INT16_MIN/MAX << 16

 src/cairo-traps.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 5d28bf605fee84520e82818dd35cae8899ecc2ba
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 19:22:57 2007 -0500

    [test] Make pdiff if necessary

 test/Makefile.am |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

commit e765ac745e0438296d2c852fd8231bd8f1fff034
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 18:13:55 2007 -0500

    [skiplist] Prefix symbols with _cairo

 src/cairo-bentley-ottmann.c  |   24 ++++++++++++------------
 src/cairo-skiplist-private.h |   22 +++++++++++-----------
 src/cairo-skiplist.c         |   20 ++++++++++----------
 3 files changed, 33 insertions(+), 33 deletions(-)

commit cd78da36f663b99c67d50dcd692cd7b67677c82a
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 18:08:37 2007 -0500

    [test-surfaces] Prefix public symbols with _cairo

 boilerplate/cairo-boilerplate.c |    6 +++---
 src/test-fallback-surface.c     |    8 ++++----
 src/test-fallback-surface.h     |    2 +-
 src/test-meta-surface.c         |    2 +-
 src/test-meta-surface.h         |    2 +-
 src/test-paginated-surface.c    |    2 +-
 src/test-paginated-surface.h    |    2 +-
 7 files changed, 12 insertions(+), 12 deletions(-)

commit 8997b3a023b0edb8877675ce520fbb883d6fa188
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 17:54:00 2007 -0500

    [skiplist] Move static variable out of function
    
    Part of my secrect plan to make cairo compilable with:
    
    	#define static
    
    Useful for some weird debugging purposes.

 src/cairo-skiplist.c |   15 ++++++++-------
 1 files changed, 8 insertions(+), 7 deletions(-)

commit d40126f5aba481e4f4d9582cb5c37478f8ef37e7
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 17:47:33 2007 -0500

    [cairo_t] Embed a gstate into cairo_t
    
    So we don't have to malloc the first gstate.

 src/cairo-gstate.c  |   44 ++------------------------------------------
 src/cairo-private.h |    1 +
 src/cairo.c         |   32 ++++++++++++++------------------
 src/cairoint.h      |   10 +++++++---
 4 files changed, 24 insertions(+), 63 deletions(-)

commit 01f9ee39feb6ca48b9e07fdec62d8ab1b94ab75d
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 17:42:23 2007 -0500

    [cairo-clip] Make _cairo_clip_init tolerate NULL target
    
    (needed for upcoming patches.)

 src/cairo-clip.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

commit bc8987068d1849cf7c16c38132fcc3c8d3b4e12e
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 17:15:35 2007 -0500

    [cairo_t] Make path an array of size one
    
    This is more natural since cr->path can be used as if it was a pointer.
    This means, for example, if we move on to making it a pointer, most of
    the code using it does not need any change.  So we get some level of
    encapsulation of implementation details, if you prefer the terminology :).

 src/cairo-private.h |    2 +-
 src/cairo.c         |   52 +++++++++++++++++++++++++-------------------------
 2 files changed, 27 insertions(+), 27 deletions(-)

commit 74e6a24e98baf70284b65d5f4ed41bdf7449d72d
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 17:04:43 2007 -0500

    [Quartz] Don't include cairo-private.h

 src/cairo-quartz-surface.c |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

commit 6bc543a0ebe4076da31bad4d3ccca4d713948587
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 16:58:18 2007 -0500

    [cairo_t] Move gstate pointer before cairo_path_fixed_t for better cache behavior

 src/cairo-private.h |    4 ++--
 src/cairo.c         |    4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

commit 85aff353ca38e607599282bc955e467df82fa01b
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 16:52:09 2007 -0500

    [cairo-path-fixed] Fine-tune size of buffer
    
    such that cairo_path_fixed_t fits in 512 bytes.

 src/cairo-path-fixed-private.h |   10 ++++++----
 src/cairo.c                    |    4 ++--
 2 files changed, 8 insertions(+), 6 deletions(-)

commit 1bd073a1a2951bbb09fdab6637baae0172a223f0
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 16:23:49 2007 -0500

    [cairo-path-fixed] Merge op and arg bufs
    
    This means, we have to malloc only one buffer, not two.  Worst case
    is that one always draws curves, which fills the arg (point) buffer
    six times faster than op buffer.  But that's not a big deal since
    each op takes 1 byte, while each point takes 8 bytes.  So op space
    is cheap to spare, so to speak (about 10% memory waste at worst).

 src/cairo-path-fill.c          |   51 ++++----
 src/cairo-path-fixed-private.h |   22 +--
 src/cairo-path-fixed.c         |  313 ++++++++++++++--------------------------
 src/cairo.c                    |    3 +-
 4 files changed, 141 insertions(+), 248 deletions(-)

commit 5750d669af24fe1d2707326b9d74dfbb18adf636
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Thu Mar 8 14:30:10 2007 -0500

    [cairo-path-fixed] Avoid malloc for small paths
    
    We do this by including an initial op and arg buf in cairo_path_fixed_t,
    so for small paths we don't have to alloc those buffers.
    
    The way this is done is a bit unusual.  Specifically, using an array of
    length one instead of a normal member:
    
    -    cairo_path_op_buf_t *op_buf_head;
    +    cairo_path_op_buf_t  op_buf_head[1];
    
    Has the advantage that read-only use of the buffers does not need any
    change as arrays act like pointers syntactically.  All manipulation code
    however needs to be updates, which the patch supposed does.  Still, there
    seems to be bugs remaining as cairo-perf quits with a Bad X Request error
    with this patch.

 src/cairo-path-fixed-private.h |    4 +-
 src/cairo-path-fixed.c         |   66 +++++++++++++++++++++++-----------------
 src/cairo.c                    |    4 +-
 3 files changed, 42 insertions(+), 32 deletions(-)

commit 994dd1a134484d7a1ee246906f21f02d916014a8
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 04:56:54 2007 -0400

    [boilerplate] Prefer top_builddir to top_srcdir
    
    This may fix some build problems the Ubuntu guys are experiencing
    with out-of-tree builds.

 boilerplate/Makefile.am |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 2894ed19a3acd955a5d0e2f5a231a6f1eee8ac06
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 13 04:55:18 2007 -0400

    [directfb,os2] #error if the backend is not compiled in, like others do

 src/cairo-directfb.h |    3 +++
 src/cairo-os2.h      |    2 ++
 2 files changed, 5 insertions(+), 0 deletions(-)

commit 073d06d4661feb16b15ece5282a5134e3f05d8e7
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Tue Mar 13 18:45:38 2007 +1030

    Fix incorrect file permission in previous commit

 0 files changed, 0 insertions(+), 0 deletions(-)

commit a944f42b3d58825e8def292001e3738651b7584a
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Tue Mar 13 18:35:59 2007 +1030

    Fix buffer overflow warning

 src/cairo-truetype-subset.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 0f78eb8ccf60c60a4b66441958a7498dc9f7fa47
Author: Carl Worth <cworth@cworth.org>
Date:   Mon Mar 12 16:24:58 2007 -0700

    perf/README: Add notes on using cairo-perf-diff

 perf/README |  105 ++++++++++++++++++++++++++++++++++++++++++++++++++++-------
 1 files changed, 93 insertions(+), 12 deletions(-)

commit 14cab8b020f429d346561d8ab70b154b2e3f0668
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Mar 11 21:55:19 2007 +0000

    Correct an off-by-one in the reflection of the convolution index.
    
    Currently the convolution code uses the formula 2*(N-1)-n to reflect the index
    n when n is greater than or equal to N.
    This is wrong as n=N -> 2*(N-1)-N = N-2 instead of N-1.
    
    Furthermore when the image is small, e.g. at the highest levels of the
    pyramid, this causes the code to index before the start of the array and
    causes valgrind to issue a warning.

 test/pdiff/lpyramid.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit 789aada06b52e068662f0ac0f7a424c51bcba510
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Sun Mar 11 20:55:26 2007 +0000

    Avoid the struct copy when source and destination are the same.
    
    On some architectures, gcc will emit a memcpy for structure copies which will
    produce a valgrind warning when the source and destination pointers are the
    same. Workaround this issue by explicitly checking the source and destination
    for inequality before doing the structure assignment.

 src/cairo-surface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

commit ef284a2d6bbeae8711226f1f1f2cf4936f6937eb
Author: Carl Worth <cworth@cworth.org>
Date:   Fri Mar 9 13:36:03 2007 -0800

    Fix a LOCK vs. UNLOCK typo, (yes, I'm that stupid).
    
    Thanks to M.Drochner@fz-juelich.de for noticing the bug.
    
    This fixes bug #10235:
    
    	locking bug in cairo_ft_scaled_font_unlock_face()
    	http://bugs.freedesktop.org/show_bug.cgi?id=10235

 src/cairo-ft-font.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 772edc9133d41dfd667ae5915dfa6ace0bcbfd0d
Author: Emmanuel Pacaud <emmanuel.pacaud@free.fr>
Date:   Thu Mar 8 21:32:59 2007 +0100

    SVG: fix a radial gradient failure when using CAIRO_EXTEND_REFLECT.
    
    Assume from the beginning we're using a circle with a radius equal to
    2 * ( r1 - r0 ) when emulating CAIRO_EXTEND_REFLECT.

 src/cairo-svg-surface.c |   14 +++++++-------
 1 files changed, 7 insertions(+), 7 deletions(-)

commit c07867c545d7ab7c4a104944768f8a5b69ef9596
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 7 15:55:02 2007 -0500

    [glitz] Mark some constant static structures as const

 src/cairo-glitz-surface.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

commit 88632575bfae348a63e3e6228d5ceaa64715ae5f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 7 15:54:20 2007 -0500

    [PS/PDF/SVG] Rename internal symbols to have _cairo_*_surface prefix

 src/cairo-pdf-surface.c |   74 +++++++++++++-------------
 src/cairo-ps-surface.c  |   52 +++++++++---------
 src/cairo-svg-surface.c |  136 +++++++++++++++++++++++-----------------------
 3 files changed, 131 insertions(+), 131 deletions(-)

commit 2cc1c73705d70f834b43996f70080860ac66e57d
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 7 15:53:27 2007 -0500

    [cairoint] Move endian-conversion routines into cairoint.h

 src/cairo-cff-subset.c      |   28 ----------------------------
 src/cairo-truetype-subset.c |   37 -------------------------------------
 src/cairoint.h              |   35 +++++++++++++++++++++++++++++++++++
 3 files changed, 35 insertions(+), 65 deletions(-)

commit 62e864e73cd1136b3c0e889dca43a1c0cc648b21
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 7 15:51:35 2007 -0500

    [Type1] Add cairo-type1-private.h that Type1 fallback and subset code share

 doc/public/Headers.mk      |    1 +
 src/Makefile.am            |    1 +
 src/cairo-type1-fallback.c |   14 ++++--------
 src/cairo-type1-private.h  |   45 ++++++++++++++++++++++++++++++++++++++++++++
 src/cairo-type1-subset.c   |   18 ++++++----------
 5 files changed, 59 insertions(+), 20 deletions(-)

commit ef9799d596600aea334707d2ff00fcca82280d83
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Wed Mar 7 15:49:51 2007 -0500

    [cosmetic] Remove static var from testing code in bentley-ottman.

 src/cairo-bentley-ottmann.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 92d331a23407c79d83bf0b2a7d003ba3525641d4
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Mar 7 13:31:54 2007 +0000

    Fix up the trivial leaks found by valgrind.

 perf/cairo-perf.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

commit 7d972086d6ea6a6bfa47b5fb47f7a21be61e10e8
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Mar 7 12:19:44 2007 +0000

    Add valgrind/callgrind targets to Makefile.

 perf/Makefile.am |   20 ++++++++++++++++++++
 1 files changed, 20 insertions(+), 0 deletions(-)

commit 734d32ed7a50284fcc8984af67734bb306735691
Author: Emmanuel Pacaud <emmanuel.pacaud@lapp.in2p3.fr>
Date:   Tue Mar 6 15:49:53 2007 -0800

    SVG: Fix CAIRO_EXTEND_REFLECT for radial gradients.
    
    This patch also handles cases where r0 > r1, (one circle must still
    be wholly contained within the other as that's all SVG supports).
    
    This patch should also prevent a crash when r0 == r1.

 src/cairo-svg-surface.c |  337 ++++++++++++++++++++++++++++++++++++++---------
 1 files changed, 277 insertions(+), 60 deletions(-)

commit 32536a7b794c38ff1944b8af5e56e8962e76c311
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Tue Mar 6 23:45:23 2007 +0000

    [atsui] clean up warnings
    
    Just tidying up  warnings left behind by previous fixes.

 src/cairo-atsui-font.c |   13 ++++++-------
 1 files changed, 6 insertions(+), 7 deletions(-)

commit 9032bf4e2d3bffe84d11a771ba4072cdd8926b77
Author: Brian Ewins <Brian.Ewins@gmail.com>
Date:   Tue Mar 6 23:24:33 2007 +0000

    [quartz] rename remaining nquartz symbols to quartz.
    
    Renaming any nquartz symbols and files left to quartz.

 doc/public/Makefile.am     |    1 -
 src/Makefile.am            |    2 -
 src/cairo-quartz-private.h |    6 +-
 src/cairo-quartz-surface.c |  238 ++++++++++++++++++++++----------------------
 4 files changed, 122 insertions(+), 125 deletions(-)

commit b0d05f7421c457120b9d86a83c4935c67b217fab
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 6 14:26:51 2007 -0500

    [configure.in] Remove AM_MAINTAINER_MODE
    
    Maintainer-mode is known broken behavior and discouraged.  It has
    created headaches before when you run configure and all in a sudden
    editing Makefile.am's does not trigger a Makefile update...

 configure.in |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

commit f7beb220df74fef60c102fb5cc827fb2d3962296
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Tue Mar 6 10:33:09 2007 -0500

    Remove extra word in docs

 src/cairo.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

commit 81b98c93b68839d20d3033170eeb5026257d52b8
Author: Adrian Johnson <ajohnson@redneon.com>
Date:   Tue Mar 6 23:11:38 2007 +1030

    PDF: Set page group color space to DeviceRGB
    
    See http://lists.freedesktop.org/archives/cairo/2006-November/008551.html

 src/cairo-pdf-surface.c |    9 ++++++---
 1 files changed, 6 insertions(+), 3 deletions(-)

commit 8f0ff52cf74fe4b18c46f9a62689b991645295d0
Author: Carl Worth <cworth@cworth.org>
Date:   Tue Mar 6 01:39:37 2007 -0800

    Increment version to 1.4.1 after making the 1.4.0 release

 configure.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)
