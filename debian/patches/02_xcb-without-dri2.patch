--- a/src/cairo-xcb-surface.c.old	2010-02-23 14:31:36.425441688 +0100
+++ b/src/cairo-xcb-surface.c	2010-02-23 14:31:45.373469900 +0100
@@ -43,7 +43,9 @@
 #include "cairo-xcb.h"
 #include "cairo-xcb-private.h"
 
+#if CAIRO_HAS_DRM_SURFACE && CAIRO_HAS_XCB_DRM_FUNCTIONS
 #include <xcb/dri2.h>
+#endif
 
 #define AllPlanes ((unsigned) -1)
 #define CAIRO_ASSUME_PIXMAP 20
